# 推荐系统文档

## 功能概述

推荐系统旨在通过向用户展示他们可能感兴趣的其他商品，来增加用户的浏览深度和平台的商品曝光率。在当前阶段，我们实现了一个基于内容的简单推荐功能，主要应用在商品详情页，为用户推荐与当前商品相似的物品。

### 核心功能
- **相关商品推荐**：在用户浏览某个商品的详情页时，页面底部会展示一个“猜你喜欢”或“相关推荐”的板块。
- **基于内容的推荐**：推荐的商品主要是根据当前商品的**分类**来匹配的。系统会查找与当前商品属于同一分类下的其他在售商品。
- **多样性与随机性**：为了避免每次推荐的商品都完全一样，系统在推荐时会加入一定的随机性，并排除用户正在浏览的当前商品。

## 推荐逻辑

本推荐系统目前采用的是一种基础的**基于内容（Content-Based）**的推荐策略。

1.  **获取锚点信息**：当用户访问一个商品详情页时，该商品（我们称之为“锚点商品”）的 `categoryId`（分类ID）被获取。
2.  **查找相似商品**：系统会查询 `product` 表，寻找满足以下所有条件的商品：
    -   与锚点商品具有相同的 `categoryId`。
    -   商品状态为 `AVAILABLE`（在售）。
    -   商品ID **不等于** 锚点商品的ID。
3.  **随机化与限制数量**：
    -   从查询结果中随机选取一部分商品（例如，随机排序后取前5个）。
    -   返回一个数量有限的推荐商品列表（如4-8个）。

这种方法的优点是简单、易于实现且无需大量的用户行为数据。缺点是推荐的相关度有限，无法发掘用户的潜在兴趣。

## 后端API接口

#### 1. 获取推荐商品
`GET /api/products/{productId}/recommendations`
- **Request Path**: `{productId}` 是当前正在浏览的商品ID。
- **Query Params**: `limit=5` (可选，用于指定需要的推荐商品数量)。
- **Response**: 返回一个推荐商品的信息列表，格式与普通商品列表项一致。

## 前端视图与组件

- **RecommendationSection.vue**: 推荐板块的专属组件。
  - 该组件通常在 `ProductDetail.vue` 页面中被引入和使用。
  - 组件接收一个 `productId` 作为 prop。
  - 在组件的 `mounted` 或 `onMounted` 生命周期钩子中，它会调用 `GET /api/products/{productId}/recommendations` 接口来获取推荐数据。
  - 获取到数据后，以卡片宫格的形式将推荐商品渲染出来。
  - 每个推荐商品卡片都是一个链接，点击后可以跳转到对应商品的详情页。

- **ProductDetail.vue**:
  - 在页面的主要内容下方，引入并渲染 `<RecommendationSection :product-id="currentProductId" />`。

## 使用流程

1.  用户进入一个商品详情页 (`/product/123`)。
2.  `ProductDetail.vue` 组件被加载，同时渲染其子组件 `RecommendationSection.vue`，并将当前商品ID `123` 传递给它。
3.  `RecommendationSection.vue` 组件在其生命周期钩子中，使用接收到的 `productId` (123) 调用 `GET /api/products/123/recommendations` 接口。
4.  后端 `ProductController.java` 接收到请求，调用 `ProductService.java` 中的推荐逻辑。
5.  `ProductService.java` 根据商品 `123` 的分类，从数据库中查询出同分类下的其他5个随机在售商品。
6.  后端将这5个商品的列表返回给前端。
7.  `RecommendationSection.vue` 组件接收到数据后，使用 `v-for` 指令遍历列表，将商品一个个渲染成推荐卡片。

## 未来可扩展方向

当前的推荐系统非常基础，未来可以从以下几个方面进行升级和扩展，以提供更智能、更个性化的推荐：

1.  **协同过滤 (Collaborative Filtering)**:
    -   **基于用户的协同过滤 (User-Based CF)**：找到与当前用户兴趣相似的其他用户（例如，都购买或收藏过同样几件商品），然后将那些用户喜欢但当前用户还未接触过的商品推荐给他。
    -   **基于物品的协同过滤 (Item-Based CF)**：计算商品之间的相似度。如果很多用户都同时喜欢商品A和商品B，那么A和B的相似度就很高。当一个用户喜欢A时，就可以向他推荐B。

2.  **混合推荐 (Hybrid Recommendation)**:
    -   将基于内容的推荐与协同过滤结合起来。例如，在用户行为数据不足（冷启动问题）时，主要依赖内容推荐；当数据充足时，更多地依赖协同过滤。

3.  **引入更多维度的特征**:
    -   除了商品分类，还可以考虑**价格区间**、**发布校区**、**商品标签**、**卖家信用等级**等更多维度来计算相似度。

4.  **实时行为反馈**:
    -   根据用户的实时行为（如点击、浏览、收藏、加入购物车）动态调整推荐结果。例如，用户刚刚收藏了一本编程书籍，可以立即在首页推荐更多相关的技术书籍。

5.  **离线计算与在线服务**:
    -   对于复杂的推荐算法，可以定期（如每天晚上）进行离线计算，生成用户推荐列表或物品相似度矩阵，并存入Redis或类似的高速缓存中。在线服务直接从缓存读取推荐结果，保证响应速度。
