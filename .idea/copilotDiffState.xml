<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/Dockerfile">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Dockerfile" />
              <option name="originalContent" value="# Runtime-only Dockerfile: copy prebuilt jar and run with wait-for-deps&#10;&#10;# Accept JDK version as a build argument (default 17)&#10;ARG JDK_VERSION=17&#10;&#10;# Runtime stage&#10;FROM openjdk:${JDK_VERSION}-jdk-slim&#10;ARG JDK_VERSION&#10;WORKDIR /app&#10;&#10;# Install curl, netcat and font libraries for captcha generation&#10;RUN apt-get update &amp;&amp; \&#10;    apt-get install -y curl netcat-openbsd fontconfig libfreetype6 &amp;&amp; \&#10;    rm -rf /var/lib/apt/lists/*&#10;&#10;# Copy the built jar from local target directory&#10;COPY target/c2c-platform-0.0.1-SNAPSHOT.jar app.jar&#10;&#10;# Copy wait script&#10;COPY wait-for-deps.sh /wait-for-deps.sh&#10;RUN chmod +x /wait-for-deps.sh&#10;&#10;EXPOSE 8080&#10;ENTRYPOINT [&quot;/wait-for-deps.sh&quot;]&#10;" />
              <option name="updatedContent" value="# Runtime-only Dockerfile: copy prebuilt jar and run with wait-for-deps&#10;&#10;# Accept JDK version as a build argument (default 17)&#10;ARG JDK_VERSION=17&#10;&#10;# Runtime stage&#10;FROM openjdk:${JDK_VERSION}-jdk-slim&#10;ARG JDK_VERSION&#10;WORKDIR /app&#10;&#10;# Install curl, netcat and font libraries for captcha generation&#10;RUN apt-get update &amp;&amp; \&#10;    apt-get install -y curl netcat-openbsd fontconfig libfreetype6 &amp;&amp; \&#10;    rm -rf /var/lib/apt/lists/*&#10;&#10;# Copy the built jar from local target directory&#10;COPY target/c2c-platform-0.0.1-SNAPSHOT.jar app.jar&#10;&#10;# Copy wait script&#10;COPY wait-for-deps.sh /wait-for-deps.sh&#10;RUN chmod +x /wait-for-deps.sh&#10;&#10;EXPOSE 8080&#10;ENTRYPOINT [&quot;/wait-for-deps.sh&quot;]" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/build-with-jdk23.sh">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/build-with-jdk23.sh" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="#!/usr/bin/env bash&#10;# Helper: run the Maven build using a local JDK 23 if available&#10;set -euo pipefail&#10;&#10;# Try macOS java_home to locate JDK 23&#10;if command -v /usr/libexec/java_home &gt;/dev/null 2&gt;&amp;1; then&#10;  JDK23=$(/usr/libexec/java_home -v 23 2&gt;/dev/null || true)&#10;else&#10;  JDK23=&quot;&quot;&#10;fi&#10;&#10;if [ -z &quot;${JDK23}&quot; ]; then&#10;  echo &quot;JDK 23 not found on this machine.&quot;&#10;  echo &quot;Options to proceed:&quot;&#10;  echo &quot;  1) Install JDK 23 (Homebrew, SDKMAN, or from Temurin/Adoptium).&quot;&#10;  echo &quot;     Example (Homebrew, if formula available): brew install openjdk@23&quot;&#10;  echo &quot;  2) Use a Maven+JDK23 Docker image (Temurin build):&quot;&#10;  echo &quot;     docker run --rm -v \&quot;$(pwd)\&quot;:/workspace -w /workspace maven:3.9.11-eclipse-temurin-23 mvn -U -DskipTests package&quot;&#10;  echo &quot;     # If that tag is unavailable on your registry mirror, you can use OpenJDK 23 and install maven inline:&quot;&#10;  echo &quot;     docker run --rm -v \&quot;$(pwd)\&quot;:/workspace -w /workspace openjdk:23-jdk-slim bash -lc 'apt-get update &amp;&amp; apt-get install -y maven &amp;&amp; mvn -U -DskipTests package'&quot;&#10;  echo &quot;  3) Configure Maven toolchains by copying 'toolchains-sample.xml' to '~/.m2/toolchains.xml' and editing &lt;jdkHome&gt; to point to your JDK 23 installation.&quot;&#10;  echo&#10;  echo &quot;If you have JDK 23 installed, re-run this script after installing it or update the TOOLCHAIN file.&quot;&#10;  exit 1&#10;fi&#10;&#10;export JAVA_HOME=&quot;$JDK23&quot;&#10;export PATH=&quot;$JAVA_HOME/bin:$PATH&quot;&#10;&#10;echo &quot;Using JAVA_HOME=$JAVA_HOME&quot;&#10;java -version&#10;mvn -U -DskipTests -Djava-23 -Pjava-23 package" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/create-test-users.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/create-test-users.sql" />
              <option name="updatedContent" value="-- 快速创建测试用户脚本&#10;-- 用途：方便测试多用户同时在线的场景&#10;&#10;USE trade;&#10;&#10;-- 创建测试用户（密码都是 test123）&#10;-- BCrypt hash for 'test123'&#10;INSERT INTO `users` (`username`, `display_name`, `password_hash`, `email`, `avatar_url`)&#10;VALUES &#10;    ('buyer1', '买家小王', '$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5tdcZN9zqBU5W', 'buyer1@test.com', 'https://i.pravatar.cc/150?u=buyer1'),&#10;    ('buyer2', '买家小李', '$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5tdcZN9zqBU5W', 'buyer2@test.com', 'https://i.pravatar.cc/150?u=buyer2'),&#10;    ('seller1', '卖家老张', '$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5tdcZN9zqBU5W', 'seller1@test.com', 'https://i.pravatar.cc/150?u=seller1'),&#10;    ('seller2', '卖家老刘', '$2a$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5tdcZN9zqBU5W', 'seller2@test.com', 'https://i.pravatar.cc/150?u=seller2')&#10;ON DUPLICATE KEY UPDATE username=VALUES(username);&#10;&#10;-- 获取新创建用户的ID&#10;SET @buyer1_id = (SELECT id FROM users WHERE username = 'buyer1');&#10;SET @buyer2_id = (SELECT id FROM users WHERE username = 'buyer2');&#10;SET @seller1_id = (SELECT id FROM users WHERE username = 'seller1');&#10;SET @seller2_id = (SELECT id FROM users WHERE username = 'seller2');&#10;&#10;-- 分配用户角色&#10;INSERT INTO `user_roles` (`user_id`, `role_id`) &#10;VALUES &#10;    (@buyer1_id, 1),&#10;    (@buyer2_id, 1),&#10;    (@seller1_id, 1),&#10;    (@seller2_id, 1)&#10;ON DUPLICATE KEY UPDATE user_id=VALUES(user_id);&#10;&#10;-- 为卖家创建一些测试商品&#10;INSERT INTO `pms_product` (`user_id`, `name`, `description`, `price`, `stock`, `condition_level`, `location`, `category`, `status`)&#10;VALUES &#10;    (@seller1_id, '《Java编程思想》', '经典Java书籍，九成新', 45.00, 1, 9, '北京市海淀区', 'programming', 1),&#10;    (@seller1_id, '《算法导论》', '算法经典教材，八成新', 60.00, 1, 8, '北京市朝阳区', 'programming', 1),&#10;    (@seller2_id, '《深入理解计算机系统》', 'CSAPP，九成新', 55.00, 1, 9, '上海市浦东新区', 'programming', 1),&#10;    (@seller2_id, '《设计模式》', 'GoF设计模式，八成新', 40.00, 1, 8, '上海市徐汇区', 'programming', 1);&#10;&#10;SELECT '测试用户创建完成！' AS status;&#10;SELECT '==== 测试账号信息 ====' AS info;&#10;SELECT '买家账号1: buyer1 / test123' AS account1;&#10;SELECT '买家账号2: buyer2 / test123' AS account2;&#10;SELECT '卖家账号1: seller1 / test123' AS account3;&#10;SELECT '卖家账号2: seller2 / test123' AS account4;&#10;SELECT '管理员账号: admin / admin123' AS admin;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/router/index.js">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/router/index.js" />
              <option name="originalContent" value="import { createRouter, createWebHistory } from 'vue-router';&#10;import { useAuthStore } from '@/store/auth';&#10;&#10;import HomeView from '../views/HomeView.vue';&#10;import LoginView from '../views/LoginView.vue';&#10;import RegisterView from '../views/RegisterView.vue';&#10;import ProductCreate from '../views/ProductCreate.vue';&#10;import ProductDetail from '../views/ProductDetail.vue';&#10;&#10;// ===== 定义路由规则 =====&#10;const routes = [&#10;    {&#10;        path: '/',&#10;        name: 'home',&#10;        component: HomeView,&#10;        meta: { requiresAuth: true }, // 需要登录才能访问&#10;    },&#10;    {&#10;        path: '/login',&#10;        name: 'login',&#10;        component: LoginView,&#10;        meta: { requiresAuth: false }, // 登录页不需要权限&#10;    },&#10;    {&#10;        path: '/register',&#10;        name: 'register',&#10;        component: RegisterView,&#10;        meta: { requiresAuth: false },&#10;    },&#10;    {&#10;        path: '/products/create',&#10;        name: 'product-create',&#10;        component: ProductCreate,&#10;        meta: { requiresAuth: true },&#10;    },&#10;    {&#10;        path: '/products/:id',&#10;        name: 'product-detail',&#10;        component: ProductDetail,&#10;    },&#10;    {&#10;        path: '/:pathMatch(.*)*',&#10;        redirect: '/', // 未匹配的路径全部重定向到首页&#10;    },&#10;];&#10;&#10;// ===== 创建路由实例 =====&#10;const router = createRouter({&#10;    history: createWebHistory(process.env.BASE_URL),&#10;    routes,&#10;});&#10;&#10;// ===== 全局路由守卫 =====&#10;router.beforeEach((to, from, next) =&gt; {&#10;    const authStore = useAuthStore();&#10;&#10;    // 如果目标路由需要认证但用户未登录 → 跳转到登录页&#10;    if (to.meta.requiresAuth &amp;&amp; !authStore.isLoggedIn) {&#10;        next('/login');&#10;    }&#10;    // 如果用户已登录还去 login/register → 跳转到首页&#10;    else if ((to.path === '/login' || to.path === '/register') &amp;&amp; authStore.isLoggedIn) {&#10;        next('/');&#10;    }&#10;    // 否则正常进入&#10;    else {&#10;        next();&#10;    }&#10;});&#10;&#10;export default router;" />
              <option name="updatedContent" value="import { createRouter, createWebHistory } from 'vue-router';&#10;import { useAuthStore } from '@/store/auth';&#10;&#10;import HomeView from '../views/HomeView.vue';&#10;import LoginView from '../views/LoginView.vue';&#10;import RegisterView from '../views/RegisterView.vue';&#10;import ProductCreate from '../views/ProductCreate.vue';&#10;import ProductDetail from '../views/ProductDetail.vue';&#10;import AdminUsers from '../views/AdminUsers.vue';&#10;&#10;// ===== 定义路由规则 =====&#10;const routes = [&#10;    {&#10;        path: '/',&#10;        name: 'home',&#10;        component: HomeView,&#10;        meta: { requiresAuth: true }, // 需要登录才能访问&#10;    },&#10;    {&#10;        path: '/login',&#10;        name: 'login',&#10;        component: LoginView,&#10;        meta: { requiresAuth: false }, // 登录页不需要权限&#10;    },&#10;    {&#10;        path: '/register',&#10;        name: 'register',&#10;        component: RegisterView,&#10;        meta: { requiresAuth: false },&#10;    },&#10;    {&#10;        path: '/products/create',&#10;        name: 'product-create',&#10;        component: ProductCreate,&#10;        meta: { requiresAuth: true },&#10;    },&#10;    {&#10;        path: '/products/:id',&#10;        name: 'product-detail',&#10;        component: ProductDetail,&#10;    },&#10;    {&#10;        path: '/admin/users',&#10;        name: 'admin-users',&#10;        component: AdminUsers,&#10;        meta: { requiresAuth: true, requiresAdmin: true },&#10;    },&#10;    {&#10;        path: '/:pathMatch(.*)*',&#10;        redirect: '/', // 未匹配的路径全部重定向到首页&#10;    },&#10;];&#10;&#10;// ===== 创建路由实例 =====&#10;const router = createRouter({&#10;    history: createWebHistory(process.env.BASE_URL),&#10;    routes,&#10;});&#10;&#10;// ===== 全局路由守卫 =====&#10;router.beforeEach((to, from, next) =&gt; {&#10;    const authStore = useAuthStore();&#10;&#10;    // 需要登录&#10;    if (to.meta.requiresAuth &amp;&amp; !authStore.isLoggedIn) {&#10;        return next('/login');&#10;    }&#10;&#10;    // 已登录时禁止访问登录/注册&#10;    if ((to.path === '/login' || to.path === '/register') &amp;&amp; authStore.isLoggedIn) {&#10;        return next('/');&#10;    }&#10;&#10;    // 需要管理员权限&#10;    if (to.meta.requiresAdmin) {&#10;        const role = authStore.user?.role;&#10;        if (role !== 'ROLE_ADMIN') {&#10;            return next('/');&#10;        }&#10;    }&#10;&#10;    return next();&#10;});&#10;&#10;export default router;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/AdminUsers.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/AdminUsers.vue" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;admin-users&quot;&gt;&#10;    &lt;h1&gt;管理员中心 - 用户列表&lt;/h1&gt;&#10;    &lt;div v-if=&quot;loading&quot;&gt;加载中...&lt;/div&gt;&#10;    &lt;div v-else-if=&quot;error&quot; class=&quot;error&quot;&gt;{{ error }}&lt;/div&gt;&#10;    &lt;table v-else class=&quot;users-table&quot;&gt;&#10;      &lt;thead&gt;&#10;        &lt;tr&gt;&#10;          &lt;th&gt;ID&lt;/th&gt;&#10;          &lt;th&gt;用户名&lt;/th&gt;&#10;          &lt;th&gt;邮箱&lt;/th&gt;&#10;          &lt;th&gt;角色&lt;/th&gt;&#10;        &lt;/tr&gt;&#10;      &lt;/thead&gt;&#10;      &lt;tbody&gt;&#10;        &lt;tr v-for=&quot;u in users&quot; :key=&quot;u.id&quot;&gt;&#10;          &lt;td&gt;{{ u.id }}&lt;/td&gt;&#10;          &lt;td&gt;{{ u.username }}&lt;/td&gt;&#10;          &lt;td&gt;{{ u.email }}&lt;/td&gt;&#10;          &lt;td&gt;&#10;            &lt;span v-if=&quot;u.roles &amp;&amp; u.roles.length&quot;&gt;{{ u.roles.map(r =&gt; r.name).join(', ') }}&lt;/span&gt;&#10;            &lt;span v-else&gt;—&lt;/span&gt;&#10;          &lt;/td&gt;&#10;        &lt;/tr&gt;&#10;      &lt;/tbody&gt;&#10;    &lt;/table&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { onMounted, ref } from 'vue';&#10;import axios from 'axios';&#10;&#10;const users = ref([]);&#10;const loading = ref(false);&#10;const error = ref('');&#10;&#10;const fetchUsers = async () =&gt; {&#10;  loading.value = true;&#10;  error.value = '';&#10;  try {&#10;    const { data } = await axios.get('/api/admin/users');&#10;    users.value = data;&#10;  } catch (e) {&#10;    error.value = '加载用户失败';&#10;    console.error(e);&#10;  } finally {&#10;    loading.value = false;&#10;  }&#10;};&#10;&#10;onMounted(fetchUsers);&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.admin-users {&#10;  padding: 20px;&#10;}&#10;.users-table {&#10;  width: 100%;&#10;  border-collapse: collapse;&#10;}&#10;.users-table th, .users-table td {&#10;  border: 1px solid #ddd;&#10;  padding: 8px;&#10;}&#10;.error {&#10;  color: #d33;&#10;}&#10;&lt;/style&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/CartView.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/CartView.vue" />
              <option name="originalContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;cart-page&quot;&gt;&#10;    &lt;div class=&quot;page-header&quot;&gt;&#10;      &lt;h1&gt; 购物车&lt;/h1&gt;&#10;      &lt;p class=&quot;subtitle&quot;&gt;共 {{ cartItems.length }} 件商品&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-if=&quot;loading&quot; class=&quot;loading-container&quot;&gt;&#10;      &lt;div class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;&#10;      &lt;p&gt;加载中...&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-else-if=&quot;cartItems.length === 0&quot; class=&quot;empty-container&quot;&gt;&#10;      &lt;div class=&quot;empty-icon&quot;&gt;&lt;/div&gt;&#10;      &lt;p&gt;购物车还是空的&lt;/p&gt;&#10;      &lt;router-link to=&quot;/&quot; class=&quot;btn btn-primary&quot;&gt;去逛逛&lt;/router-link&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-else class=&quot;cart-content&quot;&gt;&#10;      &lt;div class=&quot;cart-items&quot;&gt;&#10;        &lt;div v-for=&quot;item in cartItems&quot; :key=&quot;item.cartItemId&quot; class=&quot;cart-item&quot;&gt;&#10;          &lt;div class=&quot;item-checkbox&quot;&gt;&#10;            &lt;input&#10;              type=&quot;checkbox&quot;&#10;              :id=&quot;'item-' + item.cartItemId&quot;&#10;              v-model=&quot;item.selected&quot;&#10;              @change=&quot;updateSelection&quot;&#10;              class=&quot;checkbox-input&quot;&#10;            /&gt;&#10;            &lt;label :for=&quot;'item-' + item.cartItemId&quot; class=&quot;checkbox-label&quot;&gt;&lt;/label&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-image&quot; @click=&quot;goToProduct(item.product.id)&quot;&gt;&#10;            &lt;img&#10;              v-if=&quot;getFirstImage(item.product)&quot;&#10;              :src=&quot;getFirstImage(item.product)&quot;&#10;              :alt=&quot;item.product.name&quot; /&gt;&#10;            &lt;div v-else class=&quot;no-image&quot;&gt;&lt;/div&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-info&quot;&gt;&#10;            &lt;h3 class=&quot;item-name&quot; @click=&quot;goToProduct(item.product.id)&quot;&gt;&#10;              {{ item.product.name }}&#10;            &lt;/h3&gt;&#10;            &lt;div class=&quot;item-meta&quot;&gt;&#10;              &lt;span&gt;成色: {{ item.product.conditionLevel }}/10&lt;/span&gt;&#10;              &lt;span v-if=&quot;item.product.stock&quot;&gt;库存: {{ item.product.stock }}件&lt;/span&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;item-price&quot;&gt;¥{{ item.product.price }}&lt;/div&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-quantity&quot;&gt;&#10;            &lt;button @click=&quot;decreaseQuantity(item)&quot; class=&quot;qty-btn&quot;&gt;-&lt;/button&gt;&#10;            &lt;input&#10;              type=&quot;number&quot;&#10;              v-model.number=&quot;item.quantity&quot;&#10;              @change=&quot;updateQuantity(item)&quot;&#10;              min=&quot;1&quot;&#10;              :max=&quot;item.product.stock&quot;&#10;              class=&quot;qty-input&quot; /&gt;&#10;            &lt;button @click=&quot;increaseQuantity(item)&quot; class=&quot;qty-btn&quot;&gt;+&lt;/button&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-subtotal&quot;&gt;&#10;            ¥{{ (item.product.price * item.quantity).toFixed(2) }}&#10;          &lt;/div&gt;&#10;          &lt;button @click=&quot;removeItem(item)&quot; class=&quot;btn-remove&quot;&gt;&#10;            ️ 删除&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;div class=&quot;cart-summary&quot;&gt;&#10;        &lt;h3&gt;订单摘要&lt;/h3&gt;&#10;        &lt;div class=&quot;select-all-row&quot;&gt;&#10;          &lt;input&#10;            type=&quot;checkbox&quot;&#10;            id=&quot;select-all&quot;&#10;            v-model=&quot;selectAll&quot;&#10;            @change=&quot;toggleSelectAll&quot;&#10;            class=&quot;checkbox-input&quot;&#10;          /&gt;&#10;          &lt;label for=&quot;select-all&quot; class=&quot;checkbox-label&quot;&gt;全选&lt;/label&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-row&quot;&gt;&#10;          &lt;span&gt;已选商品：&lt;/span&gt;&#10;          &lt;span&gt;{{ selectedQuantity }} 件&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-row total&quot;&gt;&#10;          &lt;span&gt;总计：&lt;/span&gt;&#10;          &lt;span class=&quot;total-price&quot;&gt;¥{{ selectedPrice.toFixed(2) }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;button&#10;          class=&quot;btn btn-checkout&quot;&#10;          @click=&quot;checkout&quot;&#10;          :disabled=&quot;selectedQuantity === 0&quot;&#10;        &gt;&#10;          结算 ({{ selectedQuantity }})&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted } from 'vue';&#10;import { useRouter } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const cartItems = ref([]);&#10;const loading = ref(true);&#10;const selectAll = ref(false);&#10;&#10;&#10;const selectedQuantity = computed(() =&gt; {&#10;  return cartItems.value&#10;    .filter(item =&gt; item.selected)&#10;    .reduce((sum, item) =&gt; sum + item.quantity, 0);&#10;});&#10;&#10;const selectedPrice = computed(() =&gt; {&#10;  return cartItems.value&#10;    .filter(item =&gt; item.selected)&#10;    .reduce((sum, item) =&gt; sum + (item.product.price * item.quantity), 0);&#10;});&#10;&#10;const fetchCartItems = async () =&gt; {&#10;  try {&#10;    loading.value = true;&#10;    const response = await axios.get('/api/cart/list');&#10;    cartItems.value = response.data.map(item =&gt; ({&#10;      ...item,&#10;      selected: false&#10;    }));&#10;  } catch (error) {&#10;    console.error('获取购物车失败:', error);&#10;    alert('获取购物车失败');&#10;  } finally {&#10;    loading.value = false;&#10;  }&#10;};&#10;&#10;const updateSelection = () =&gt; {&#10;  const allSelected = cartItems.value.every(item =&gt; item.selected);&#10;  selectAll.value = allSelected;&#10;};&#10;&#10;const toggleSelectAll = () =&gt; {&#10;  cartItems.value.forEach(item =&gt; {&#10;    item.selected = selectAll.value;&#10;  });&#10;};&#10;&#10;const updateQuantity = async (item) =&gt; {&#10;  try {&#10;    await axios.put('/api/cart/update', {&#10;      productId: item.product.id,&#10;      quantity: item.quantity&#10;    });&#10;  } catch (error) {&#10;    console.error('更新数量失败:', error);&#10;    alert('更新数量失败');&#10;    await fetchCartItems();&#10;  }&#10;};&#10;&#10;const increaseQuantity = async (item) =&gt; {&#10;  if (item.quantity &lt; item.product.stock) {&#10;    item.quantity++;&#10;    await updateQuantity(item);&#10;  } else {&#10;    alert('已达到库存上限');&#10;  }&#10;};&#10;&#10;const decreaseQuantity = async (item) =&gt; {&#10;  if (item.quantity &gt; 1) {&#10;    item.quantity--;&#10;    await updateQuantity(item);&#10;  }&#10;};&#10;&#10;const removeItem = async (item) =&gt; {&#10;  if (!confirm('确定要移除该商品吗？')) {&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.delete(`/api/cart/remove/${item.product.id}`);&#10;    cartItems.value = cartItems.value.filter(i =&gt; i.cartItemId !== item.cartItemId);&#10;    alert('已从购物车移除');&#10;  } catch (error) {&#10;    console.error('删除失败:', error);&#10;    alert('删除失败');&#10;  }&#10;};&#10;&#10;const goToProduct = (productId) =&gt; {&#10;  router.push(`/products/${productId}`);&#10;};&#10;&#10;const getFirstImage = (product) =&gt; {&#10;  if (product.media &amp;&amp; product.media.length &gt; 0) {&#10;    const firstMedia = product.media.find(m =&gt; m.mediaType === 1);&#10;    return firstMedia ? firstMedia.url : null;&#10;  }&#10;  return null;&#10;};&#10;&#10;const checkout = async () =&gt; {&#10;  const selectedItems = cartItems.value.filter(item =&gt; item.selected);&#10;&#10;  if (selectedItems.length === 0) {&#10;    alert('请选择要结算的商品');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    // 从购物车创建订单（只包含选中的商品）&#10;    const selectedProductIds = selectedItems.map(item =&gt; item.product.id);&#10;    const response = await axios.post('/api/orders', {&#10;      productIds: selectedProductIds&#10;    });&#10;    const order = response.data;&#10;&#10;    alert('订单创建成功');&#10;&#10;    // 跳转到支付页面（使用路径参数）&#10;    router.push(`/payment/${order.id}`);&#10;  } catch (error) {&#10;    console.error('结算失败:', error);&#10;    if (error.response?.data?.message) {&#10;      alert(error.response.data.message);&#10;    } else {&#10;      alert('结算失败，请重试');&#10;    }&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  fetchCartItems();&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.cart-page {&#10;  max-width: 1200px;&#10;  margin: 0 auto;&#10;  padding: 20px;&#10;}&#10;&#10;.page-header {&#10;  text-align: center;&#10;  margin-bottom: 40px;&#10;}&#10;&#10;.page-header h1 {&#10;  font-size: 32px;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.subtitle {&#10;  color: #666;&#10;  font-size: 16px;&#10;}&#10;&#10;.loading-container,&#10;.empty-container {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  min-height: 400px;&#10;}&#10;&#10;.loading-spinner {&#10;  width: 40px;&#10;  height: 40px;&#10;  border: 4px solid #f3f3f3;&#10;  border-top: 4px solid #007bff;&#10;  border-radius: 50%;&#10;  animation: spin 1s linear infinite;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;@keyframes spin {&#10;  0% { transform: rotate(0deg); }&#10;  100% { transform: rotate(360deg); }&#10;}&#10;&#10;.empty-icon {&#10;  font-size: 80px;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.empty-container p {&#10;  color: #666;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.cart-content {&#10;  display: flex;&#10;  gap: 30px;&#10;}&#10;&#10;.cart-items {&#10;  flex: 1;&#10;  display: flex;&#10;  flex-direction: column;&#10;  gap: 15px;&#10;}&#10;&#10;.cart-item {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 15px;&#10;  padding: 20px;&#10;  background: white;&#10;  border-radius: 8px;&#10;  box-shadow: 0 2px 4px rgba(0,0,0,0.1);&#10;}&#10;&#10;.item-checkbox {&#10;  display: flex;&#10;  align-items: center;&#10;}&#10;&#10;.checkbox-input {&#10;  width: 20px;&#10;  height: 20px;&#10;  cursor: pointer;&#10;  accent-color: #007bff;&#10;}&#10;&#10;.checkbox-label {&#10;  cursor: pointer;&#10;}&#10;&#10;.item-image {&#10;  width: 100px;&#10;  height: 100px;&#10;  cursor: pointer;&#10;  border-radius: 8px;&#10;  overflow: hidden;&#10;}&#10;&#10;.item-image img {&#10;  width: 100%;&#10;  height: 100%;&#10;  object-fit: cover;&#10;}&#10;&#10;.no-image {&#10;  width: 100%;&#10;  height: 100%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  background: #f0f0f0;&#10;  font-size: 32px;&#10;}&#10;&#10;.item-info {&#10;  flex: 1;&#10;}&#10;&#10;.item-name {&#10;  font-size: 16px;&#10;  margin-bottom: 8px;&#10;  cursor: pointer;&#10;  color: #333;&#10;}&#10;&#10;.item-name:hover {&#10;  color: #007bff;&#10;}&#10;&#10;.item-meta {&#10;  display: flex;&#10;  gap: 15px;&#10;  color: #666;&#10;  font-size: 14px;&#10;  margin-bottom: 8px;&#10;}&#10;&#10;.item-price {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;}&#10;&#10;.item-quantity {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;}&#10;&#10;.qty-btn {&#10;  width: 28px;&#10;  height: 28px;&#10;  border: 1px solid #d9d9d9;&#10;  background: white;&#10;  border-radius: 4px;&#10;  cursor: pointer;&#10;  font-size: 16px;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;.qty-btn:hover {&#10;  border-color: #007bff;&#10;  color: #007bff;&#10;}&#10;&#10;.qty-input {&#10;  width: 50px;&#10;  height: 28px;&#10;  text-align: center;&#10;  border: 1px solid #d9d9d9;&#10;  border-radius: 4px;&#10;}&#10;&#10;.item-subtotal {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;  min-width: 100px;&#10;  text-align: right;&#10;}&#10;&#10;.btn-remove {&#10;  padding: 8px 16px;&#10;  background: #fff;&#10;  border: 1px solid #d9d9d9;&#10;  border-radius: 4px;&#10;  cursor: pointer;&#10;}&#10;&#10;.btn-remove:hover {&#10;  color: #ff4d4f;&#10;  border-color: #ff4d4f;&#10;}&#10;&#10;.cart-summary {&#10;  width: 300px;&#10;  background: white;&#10;  padding: 20px;&#10;  border-radius: 8px;&#10;  box-shadow: 0 2px 4px rgba(0,0,0,0.1);&#10;  height: fit-content;&#10;  position: sticky;&#10;  top: 20px;&#10;}&#10;&#10;.cart-summary h3 {&#10;  margin-bottom: 20px;&#10;  font-size: 18px;&#10;}&#10;&#10;.select-all-row {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;  padding: 10px 0;&#10;  border-bottom: 1px solid #f0f0f0;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;.summary-row {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  margin-bottom: 15px;&#10;  color: #666;&#10;}&#10;&#10;.summary-row.total {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #333;&#10;  padding-top: 15px;&#10;  border-top: 1px solid #f0f0f0;&#10;}&#10;&#10;.total-price {&#10;  color: #ff4d4f;&#10;}&#10;&#10;.btn {&#10;  width: 100%;&#10;  padding: 12px;&#10;  border: none;&#10;  border-radius: 4px;&#10;  font-size: 16px;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-primary {&#10;  background: #007bff;&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover {&#10;  background: #0056b3;&#10;}&#10;&#10;.btn-checkout {&#10;  background: #ff4d4f;&#10;  color: white;&#10;  font-weight: bold;&#10;}&#10;&#10;.btn-checkout:hover:not(:disabled) {&#10;  background: #ff7875;&#10;}&#10;&#10;.btn-checkout:disabled {&#10;  background: #d9d9d9;&#10;  cursor: not-allowed;&#10;}&#10;&#10;@media (max-width: 768px) {&#10;  .cart-content {&#10;    flex-direction: column;&#10;  }&#10;&#10;  .cart-summary {&#10;    width: 100%;&#10;    position: static;&#10;  }&#10;&#10;  .cart-item {&#10;    flex-wrap: wrap;&#10;  }&#10;&#10;  .item-quantity {&#10;    margin-left: auto;&#10;  }&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;cart-page&quot;&gt;&#10;    &lt;div class=&quot;page-header&quot;&gt;&#10;      &lt;h1&gt; 购物车&lt;/h1&gt;&#10;      &lt;p class=&quot;subtitle&quot;&gt;共 {{ cartItems.length }} 件商品&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-if=&quot;loading&quot; class=&quot;loading-container&quot;&gt;&#10;      &lt;div class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;&#10;      &lt;p&gt;加载中...&lt;/p&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-else-if=&quot;cartItems.length === 0&quot; class=&quot;empty-container&quot;&gt;&#10;      &lt;div class=&quot;empty-icon&quot;&gt;&lt;/div&gt;&#10;      &lt;p&gt;购物车还是空的&lt;/p&gt;&#10;      &lt;router-link to=&quot;/&quot; class=&quot;btn btn-primary&quot;&gt;去逛逛&lt;/router-link&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;div v-else class=&quot;cart-content&quot;&gt;&#10;      &lt;div class=&quot;cart-items&quot;&gt;&#10;        &lt;div v-for=&quot;item in cartItems&quot; :key=&quot;item.cartItemId&quot; class=&quot;cart-item&quot;&gt;&#10;          &lt;div class=&quot;item-checkbox&quot;&gt;&#10;            &lt;input&#10;              type=&quot;checkbox&quot;&#10;              :id=&quot;'item-' + item.cartItemId&quot;&#10;              v-model=&quot;item.selected&quot;&#10;              @change=&quot;updateSelection&quot;&#10;              class=&quot;checkbox-input&quot;&#10;            /&gt;&#10;            &lt;label :for=&quot;'item-' + item.cartItemId&quot; class=&quot;checkbox-label&quot;&gt;&lt;/label&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-image&quot; @click=&quot;goToProduct(item.product.id)&quot;&gt;&#10;            &lt;img&#10;              v-if=&quot;getFirstImage(item.product)&quot;&#10;              :src=&quot;getFirstImage(item.product)&quot;&#10;              :alt=&quot;item.product.name&quot; /&gt;&#10;            &lt;div v-else class=&quot;no-image&quot;&gt;&lt;/div&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-info&quot;&gt;&#10;            &lt;h3 class=&quot;item-name&quot; @click=&quot;goToProduct(item.product.id)&quot;&gt;&#10;              {{ item.product.name }}&#10;            &lt;/h3&gt;&#10;            &lt;div class=&quot;item-meta&quot;&gt;&#10;              &lt;span&gt;成色: {{ item.product.conditionLevel }}/10&lt;/span&gt;&#10;              &lt;span v-if=&quot;item.product.stock&quot;&gt;库存: {{ item.product.stock }}件&lt;/span&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;item-price&quot;&gt;¥{{ item.product.price }}&lt;/div&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-quantity&quot;&gt;&#10;            &lt;button @click=&quot;decreaseQuantity(item)&quot; class=&quot;qty-btn&quot;&gt;-&lt;/button&gt;&#10;            &lt;input&#10;              type=&quot;number&quot;&#10;              v-model.number=&quot;item.quantity&quot;&#10;              @change=&quot;updateQuantity(item)&quot;&#10;              min=&quot;1&quot;&#10;              :max=&quot;item.product.stock&quot;&#10;              class=&quot;qty-input&quot; /&gt;&#10;            &lt;button @click=&quot;increaseQuantity(item)&quot; class=&quot;qty-btn&quot;&gt;+&lt;/button&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;item-subtotal&quot;&gt;&#10;            ¥{{ (item.product.price * item.quantity).toFixed(2) }}&#10;          &lt;/div&gt;&#10;          &lt;button @click=&quot;removeItem(item)&quot; class=&quot;btn-remove&quot;&gt;&#10;            ️ 删除&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;div class=&quot;cart-summary&quot;&gt;&#10;        &lt;h3&gt;订单摘要&lt;/h3&gt;&#10;        &lt;div class=&quot;select-all-row&quot;&gt;&#10;          &lt;input&#10;            type=&quot;checkbox&quot;&#10;            id=&quot;select-all&quot;&#10;            v-model=&quot;selectAll&quot;&#10;            @change=&quot;toggleSelectAll&quot;&#10;            class=&quot;checkbox-input&quot;&#10;          /&gt;&#10;          &lt;label for=&quot;select-all&quot; class=&quot;checkbox-label&quot;&gt;全选&lt;/label&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-row&quot;&gt;&#10;          &lt;span&gt;已选商品：&lt;/span&gt;&#10;          &lt;span&gt;{{ selectedQuantity }} 件&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-row total&quot;&gt;&#10;          &lt;span&gt;总计：&lt;/span&gt;&#10;          &lt;span class=&quot;total-price&quot;&gt;¥{{ selectedPrice.toFixed(2) }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;button&#10;          class=&quot;btn btn-checkout&quot;&#10;          @click=&quot;checkout&quot;&#10;          :disabled=&quot;selectedQuantity === 0&quot;&#10;        &gt;&#10;          结算 ({{ selectedQuantity }})&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted } from 'vue';&#10;import { useRouter } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const cartItems = ref([]);&#10;const loading = ref(true);&#10;const selectAll = ref(false);&#10;&#10;&#10;const selectedQuantity = computed(() =&gt; {&#10;  return cartItems.value&#10;    .filter(item =&gt; item.selected)&#10;    .reduce((sum, item) =&gt; sum + item.quantity, 0);&#10;});&#10;&#10;const selectedPrice = computed(() =&gt; {&#10;  return cartItems.value&#10;    .filter(item =&gt; item.selected)&#10;    .reduce((sum, item) =&gt; sum + (item.product.price * item.quantity), 0);&#10;});&#10;&#10;const fetchCartItems = async () =&gt; {&#10;  try {&#10;    loading.value = true;&#10;    const response = await axios.get('/api/cart/list');&#10;    cartItems.value = response.data.map(item =&gt; ({&#10;      ...item,&#10;      selected: false&#10;    }));&#10;  } catch (error) {&#10;    console.error('获取购物车失败:', error);&#10;    alert('获取购物车失败');&#10;  } finally {&#10;    loading.value = false;&#10;  }&#10;};&#10;&#10;const updateSelection = () =&gt; {&#10;  const allSelected = cartItems.value.every(item =&gt; item.selected);&#10;  selectAll.value = allSelected;&#10;};&#10;&#10;const toggleSelectAll = () =&gt; {&#10;  cartItems.value.forEach(item =&gt; {&#10;    item.selected = selectAll.value;&#10;  });&#10;};&#10;&#10;const updateQuantity = async (item) =&gt; {&#10;  try {&#10;    await axios.put('/api/cart/update', {&#10;      productId: item.product.id,&#10;      quantity: item.quantity&#10;    });&#10;  } catch (error) {&#10;    console.error('更新数量失败:', error);&#10;    alert('更新数量失败');&#10;    await fetchCartItems();&#10;  }&#10;};&#10;&#10;const increaseQuantity = async (item) =&gt; {&#10;  if (item.quantity &lt; item.product.stock) {&#10;    item.quantity++;&#10;    await updateQuantity(item);&#10;  } else {&#10;    alert('已达到库存上限');&#10;  }&#10;};&#10;&#10;const decreaseQuantity = async (item) =&gt; {&#10;  if (item.quantity &gt; 1) {&#10;    item.quantity--;&#10;    await updateQuantity(item);&#10;  }&#10;};&#10;&#10;const removeItem = async (item) =&gt; {&#10;  if (!confirm('确定要移除该商品吗？')) {&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.delete(`/api/cart/remove/${item.product.id}`);&#10;    cartItems.value = cartItems.value.filter(i =&gt; i.cartItemId !== item.cartItemId);&#10;    alert('已从购物车移除');&#10;  } catch (error) {&#10;    console.error('删除失败:', error);&#10;    alert('删除失败');&#10;  }&#10;};&#10;&#10;const goToProduct = (productId) =&gt; {&#10;  router.push(`/products/${productId}`);&#10;};&#10;&#10;const getFirstImage = (product) =&gt; {&#10;  if (product.media &amp;&amp; product.media.length &gt; 0) {&#10;    const firstMedia = product.media.find(m =&gt; m.mediaType === 1);&#10;    return firstMedia ? firstMedia.url : null;&#10;  }&#10;  return null;&#10;};&#10;&#10;const checkout = async () =&gt; {&#10;  const selectedItems = cartItems.value.filter(item =&gt; item.selected);&#10;&#10;  if (selectedItems.length === 0) {&#10;    alert('请选择要结算的商品');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    // 检查是否有未完成的订单&#10;    const checkResponse = await axios.get('/api/orders/check-pending');&#10;    if (checkResponse.data.hasPendingOrder) {&#10;      const orderId = checkResponse.data.orderId;&#10;      if (confirm('您有未完成的订单，是否前往支付？')) {&#10;        router.push(`/payment/${orderId}`);&#10;      }&#10;      return;&#10;    }&#10;&#10;    // 从购物车创建订单（只包含选中的商品）&#10;    const selectedProductIds = selectedItems.map(item =&gt; item.product.id);&#10;    const response = await axios.post('/api/orders', {&#10;      productIds: selectedProductIds&#10;    });&#10;    const order = response.data;&#10;&#10;    alert('订单创建成功');&#10;&#10;    // 跳转到支付页面（使用路径参数）&#10;    router.push(`/payment/${order.id}`);&#10;  } catch (error) {&#10;    console.error('结算失败:', error);&#10;    if (error.response?.data?.message) {&#10;      alert(error.response.data.message);&#10;    } else {&#10;      alert('结算失败，请重试');&#10;    }&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  fetchCartItems();&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.cart-page {&#10;  max-width: 1200px;&#10;  margin: 0 auto;&#10;  padding: 20px;&#10;}&#10;&#10;.page-header {&#10;  text-align: center;&#10;  margin-bottom: 40px;&#10;}&#10;&#10;.page-header h1 {&#10;  font-size: 32px;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.subtitle {&#10;  color: #666;&#10;  font-size: 16px;&#10;}&#10;&#10;.loading-container,&#10;.empty-container {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  min-height: 400px;&#10;}&#10;&#10;.loading-spinner {&#10;  width: 40px;&#10;  height: 40px;&#10;  border: 4px solid #f3f3f3;&#10;  border-top: 4px solid #007bff;&#10;  border-radius: 50%;&#10;  animation: spin 1s linear infinite;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;@keyframes spin {&#10;  0% { transform: rotate(0deg); }&#10;  100% { transform: rotate(360deg); }&#10;}&#10;&#10;.empty-icon {&#10;  font-size: 80px;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.empty-container p {&#10;  color: #666;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.cart-content {&#10;  display: flex;&#10;  gap: 30px;&#10;}&#10;&#10;.cart-items {&#10;  flex: 1;&#10;  display: flex;&#10;  flex-direction: column;&#10;  gap: 15px;&#10;}&#10;&#10;.cart-item {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 15px;&#10;  padding: 20px;&#10;  background: white;&#10;  border-radius: 8px;&#10;  box-shadow: 0 2px 4px rgba(0,0,0,0.1);&#10;}&#10;&#10;.item-checkbox {&#10;  display: flex;&#10;  align-items: center;&#10;}&#10;&#10;.checkbox-input {&#10;  width: 20px;&#10;  height: 20px;&#10;  cursor: pointer;&#10;  accent-color: #007bff;&#10;}&#10;&#10;.checkbox-label {&#10;  cursor: pointer;&#10;}&#10;&#10;.item-image {&#10;  width: 100px;&#10;  height: 100px;&#10;  cursor: pointer;&#10;  border-radius: 8px;&#10;  overflow: hidden;&#10;}&#10;&#10;.item-image img {&#10;  width: 100%;&#10;  height: 100%;&#10;  object-fit: cover;&#10;}&#10;&#10;.no-image {&#10;  width: 100%;&#10;  height: 100%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  background: #f0f0f0;&#10;  font-size: 32px;&#10;}&#10;&#10;.item-info {&#10;  flex: 1;&#10;}&#10;&#10;.item-name {&#10;  font-size: 16px;&#10;  margin-bottom: 8px;&#10;  cursor: pointer;&#10;  color: #333;&#10;}&#10;&#10;.item-name:hover {&#10;  color: #007bff;&#10;}&#10;&#10;.item-meta {&#10;  display: flex;&#10;  gap: 15px;&#10;  color: #666;&#10;  font-size: 14px;&#10;  margin-bottom: 8px;&#10;}&#10;&#10;.item-price {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;}&#10;&#10;.item-quantity {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;}&#10;&#10;.qty-btn {&#10;  width: 28px;&#10;  height: 28px;&#10;  border: 1px solid #d9d9d9;&#10;  background: white;&#10;  border-radius: 4px;&#10;  cursor: pointer;&#10;  font-size: 16px;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;.qty-btn:hover {&#10;  border-color: #007bff;&#10;  color: #007bff;&#10;}&#10;&#10;.qty-input {&#10;  width: 50px;&#10;  height: 28px;&#10;  text-align: center;&#10;  border: 1px solid #d9d9d9;&#10;  border-radius: 4px;&#10;}&#10;&#10;.item-subtotal {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;  min-width: 100px;&#10;  text-align: right;&#10;}&#10;&#10;.btn-remove {&#10;  padding: 8px 16px;&#10;  background: #fff;&#10;  border: 1px solid #d9d9d9;&#10;  border-radius: 4px;&#10;  cursor: pointer;&#10;}&#10;&#10;.btn-remove:hover {&#10;  color: #ff4d4f;&#10;  border-color: #ff4d4f;&#10;}&#10;&#10;.cart-summary {&#10;  width: 300px;&#10;  background: white;&#10;  padding: 20px;&#10;  border-radius: 8px;&#10;  box-shadow: 0 2px 4px rgba(0,0,0,0.1);&#10;  height: fit-content;&#10;  position: sticky;&#10;  top: 20px;&#10;}&#10;&#10;.cart-summary h3 {&#10;  margin-bottom: 20px;&#10;  font-size: 18px;&#10;}&#10;&#10;.select-all-row {&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;  padding: 10px 0;&#10;  border-bottom: 1px solid #f0f0f0;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;.summary-row {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  margin-bottom: 15px;&#10;  color: #666;&#10;}&#10;&#10;.summary-row.total {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;  color: #333;&#10;  padding-top: 15px;&#10;  border-top: 1px solid #f0f0f0;&#10;}&#10;&#10;.total-price {&#10;  color: #ff4d4f;&#10;}&#10;&#10;.btn {&#10;  width: 100%;&#10;  padding: 12px;&#10;  border: none;&#10;  border-radius: 4px;&#10;  font-size: 16px;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-primary {&#10;  background: #007bff;&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover {&#10;  background: #0056b3;&#10;}&#10;&#10;.btn-checkout {&#10;  background: #ff4d4f;&#10;  color: white;&#10;  font-weight: bold;&#10;}&#10;&#10;.btn-checkout:hover:not(:disabled) {&#10;  background: #ff7875;&#10;}&#10;&#10;.btn-checkout:disabled {&#10;  background: #d9d9d9;&#10;  cursor: not-allowed;&#10;}&#10;&#10;@media (max-width: 768px) {&#10;  .cart-content {&#10;    flex-direction: column;&#10;  }&#10;&#10;  .cart-summary {&#10;    width: 100%;&#10;    position: static;&#10;  }&#10;&#10;  .cart-item {&#10;    flex-wrap: wrap;&#10;  }&#10;&#10;  .item-quantity {&#10;    margin-left: auto;&#10;  }&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/HomeView.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/HomeView.vue" />
              <option name="originalContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;home&quot;&gt;&#10;    &lt;h1&gt;欢迎来到二手图书交易平台&lt;/h1&gt;&#10;    &lt;div v-if=&quot;isLoggedIn &amp;&amp; currentUser&quot;&gt;&#10;      &lt;p&gt;你好, {{ currentUser.username }}!&lt;/p&gt;&#10;      &lt;p&gt;你已成功登录。&lt;/p&gt;&#10;    &lt;/div&gt;&#10;    &lt;div v-else&gt;&#10;      &lt;p&gt;请先 &lt;router-link to=&quot;/login&quot;&gt;登录&lt;/router-link&gt; 或 &lt;router-link to=&quot;/register&quot;&gt;注册&lt;/router-link&gt;。&lt;/p&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { computed } from 'vue';&#10;import { useAuthStore } from '@/store/auth';&#10;&#10;const authStore = useAuthStore();&#10;&#10;const isLoggedIn = computed(() =&gt; authStore.isLoggedIn);&#10;const currentUser = computed(() =&gt; authStore.user);&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.home {&#10;  padding: 20px;&#10;  text-align: center;&#10;}&#10;&lt;/style&gt;" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;home&quot;&gt;&#10;    &lt;h1&gt;欢迎来到二手图书交易平台&lt;/h1&gt;&#10;    &lt;div v-if=&quot;isLoggedIn &amp;&amp; currentUser&quot;&gt;&#10;      &lt;p&gt;你好, {{ currentUser.username }}!&lt;/p&gt;&#10;      &lt;p&gt;你已成功登录。&lt;/p&gt;&#10;      &lt;p v-if=&quot;currentUser.role === 'ROLE_ADMIN'&quot;&gt;&#10;        &lt;router-link to=&quot;/admin/users&quot;&gt;进入管理员中心&lt;/router-link&gt;&#10;      &lt;/p&gt;&#10;    &lt;/div&gt;&#10;    &lt;div v-else&gt;&#10;      &lt;p&gt;请先 &lt;router-link to=&quot;/login&quot;&gt;登录&lt;/router-link&gt; 或 &lt;router-link to=&quot;/register&quot;&gt;注册&lt;/router-link&gt;。&lt;/p&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { computed } from 'vue';&#10;import { useAuthStore } from '@/store/auth';&#10;&#10;const authStore = useAuthStore();&#10;&#10;const isLoggedIn = computed(() =&gt; authStore.isLoggedIn);&#10;const currentUser = computed(() =&gt; authStore.user);&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.home {&#10;  padding: 20px;&#10;  text-align: center;&#10;}&#10;&lt;/style&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/PaymentPasswordSetup.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/PaymentPasswordSetup.vue" />
              <option name="originalContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;payment-password-setup&quot;&gt;&#10;    &lt;div class=&quot;setup-container&quot;&gt;&#10;      &lt;div class=&quot;setup-header&quot;&gt;&#10;        &lt;h2&gt;{{ isUpdate ? '修改支付密码' : '设置支付密码' }}&lt;/h2&gt;&#10;        &lt;p class=&quot;subtitle&quot;&gt;{{ isUpdate ? '为了您的账户安全，请验证原密码' : '设置6位数字支付密码，用于支付验证' }}&lt;/p&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;div class=&quot;setup-form&quot;&gt;&#10;        &lt;div class=&quot;form-group&quot; v-if=&quot;isUpdate&quot;&gt;&#10;          &lt;label&gt;原支付密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;oldPassword&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请输入原支付密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;          &lt;label&gt;{{ isUpdate ? '新' : '' }}支付密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;password&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请输入6位数字密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;          &lt;label&gt;确认密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;confirmPassword&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请再次输入密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;password-tips&quot;&gt;&#10;          &lt;p&gt; 温馨提示：&lt;/p&gt;&#10;          &lt;ul&gt;&#10;            &lt;li&gt;支付密码必须是6位数字&lt;/li&gt;&#10;            &lt;li&gt;请不要使用过于简单的密码（如123456）&lt;/li&gt;&#10;            &lt;li&gt;请妥善保管您的支付密码&lt;/li&gt;&#10;          &lt;/ul&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;button-group&quot;&gt;&#10;          &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;goBack&quot;&gt;取消&lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-primary&quot; @click=&quot;submitPassword&quot; :disabled=&quot;loading&quot;&gt;&#10;            {{ loading ? '处理中...' : '确认' }}&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, onMounted } from 'vue';&#10;import { useRouter } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const isUpdate = ref(false);&#10;const oldPassword = ref('');&#10;const password = ref('');&#10;const confirmPassword = ref('');&#10;const loading = ref(false);&#10;&#10;const checkPaymentPasswordStatus = async () =&gt; {&#10;  try {&#10;    const response = await axios.get('/api/users/payment-password/check');&#10;    isUpdate.value = response.data.hasPaymentPassword;&#10;  } catch (error) {&#10;    console.error('检查支付密码状态失败:', error);&#10;  }&#10;};&#10;&#10;const submitPassword = async () =&gt; {&#10;  // 验证输入&#10;  if (isUpdate.value &amp;&amp; !oldPassword.value) {&#10;    alert('请输入原支付密码');&#10;    return;&#10;  }&#10;&#10;  if (!password.value) {&#10;    alert('请输入支付密码');&#10;    return;&#10;  }&#10;&#10;  if (!/^\d{6}$/.test(password.value)) {&#10;    alert('支付密码必须是6位数字');&#10;    return;&#10;  }&#10;&#10;  if (password.value !== confirmPassword.value) {&#10;    alert('两次输入的密码不一致');&#10;    return;&#10;  }&#10;&#10;  // 简单密码检查&#10;  const weakPasswords = ['123456', '000000', '111111', '222222', '333333', '444444', '555555', '666666', '777777', '888888', '999999'];&#10;  if (weakPasswords.includes(password.value)) {&#10;    if (!confirm('您输入的密码过于简单，容易被破解。确定要使用吗？')) {&#10;      return;&#10;    }&#10;  }&#10;&#10;  loading.value = true;&#10;&#10;  try {&#10;    if (isUpdate.value) {&#10;      // 修改支付密码&#10;      await axios.put('/api/users/payment-password/update', {&#10;        oldPassword: oldPassword.value,&#10;        newPassword: password.value,&#10;        confirmPassword: confirmPassword.value&#10;      });&#10;      alert('支付密码修改成功');&#10;    } else {&#10;      // 设置支付密码&#10;      await axios.post('/api/users/payment-password/set', {&#10;        password: password.value,&#10;        confirmPassword: confirmPassword.value&#10;      });&#10;      alert('支付密码设置成功');&#10;    }&#10;    router.back();&#10;  } catch (error) {&#10;    console.error('操作失败:', error);&#10;    if (error.response?.data?.message) {&#10;      alert(error.response.data.message);&#10;    } else {&#10;      alert('操作失败，请重试');&#10;    }&#10;  } finally {&#10;    loading.value = false;&#10;  }&#10;};&#10;&#10;const goBack = () =&gt; {&#10;  router.back();&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  checkPaymentPasswordStatus();&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.payment-password-setup {&#10;  min-height: 100vh;&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  padding: 20px;&#10;}&#10;&#10;.setup-container {&#10;  background: white;&#10;  border-radius: 12px;&#10;  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);&#10;  max-width: 500px;&#10;  width: 100%;&#10;  padding: 40px;&#10;}&#10;&#10;.setup-header {&#10;  text-align: center;&#10;  margin-bottom: 30px;&#10;}&#10;&#10;.setup-header h2 {&#10;  font-size: 28px;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.subtitle {&#10;  color: #666;&#10;  font-size: 14px;&#10;}&#10;&#10;.setup-form {&#10;  margin-top: 30px;&#10;}&#10;&#10;.form-group {&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.form-group label {&#10;  display: block;&#10;  margin-bottom: 8px;&#10;  color: #333;&#10;  font-weight: 500;&#10;}&#10;&#10;.password-input {&#10;  width: 100%;&#10;  padding: 12px;&#10;  border: 2px solid #e0e0e0;&#10;  border-radius: 8px;&#10;  font-size: 16px;&#10;  transition: border-color 0.3s;&#10;  letter-spacing: 4px;&#10;}&#10;&#10;.password-input:focus {&#10;  outline: none;&#10;  border-color: #667eea;&#10;}&#10;&#10;.password-tips {&#10;  background: #f8f9fa;&#10;  border-radius: 8px;&#10;  padding: 15px;&#10;  margin: 20px 0;&#10;}&#10;&#10;.password-tips p {&#10;  font-weight: 500;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.password-tips ul {&#10;  list-style: none;&#10;  padding: 0;&#10;  margin: 0;&#10;}&#10;&#10;.password-tips li {&#10;  color: #666;&#10;  font-size: 14px;&#10;  margin-bottom: 5px;&#10;  padding-left: 20px;&#10;  position: relative;&#10;}&#10;&#10;.password-tips li:before {&#10;  content: '•';&#10;  position: absolute;&#10;  left: 0;&#10;  color: #667eea;&#10;}&#10;&#10;.button-group {&#10;  display: flex;&#10;  gap: 15px;&#10;  margin-top: 30px;&#10;}&#10;&#10;.btn {&#10;  flex: 1;&#10;  padding: 12px;&#10;  border: none;&#10;  border-radius: 8px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-cancel {&#10;  background: #f0f0f0;&#10;  color: #666;&#10;}&#10;&#10;.btn-cancel:hover {&#10;  background: #e0e0e0;&#10;}&#10;&#10;.btn-primary {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover:not(:disabled) {&#10;  transform: translateY(-2px);&#10;  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);&#10;}&#10;&#10;.btn-primary:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&#10;@media (max-width: 576px) {&#10;  .setup-container {&#10;    padding: 30px 20px;&#10;  }&#10;&#10;  .button-group {&#10;    flex-direction: column;&#10;  }&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;payment-password-setup&quot;&gt;&#10;    &lt;div class=&quot;setup-container&quot;&gt;&#10;      &lt;div class=&quot;setup-header&quot;&gt;&#10;        &lt;h2&gt;{{ isUpdate ? '修改支付密码' : '设置支付密码' }}&lt;/h2&gt;&#10;        &lt;p class=&quot;subtitle&quot;&gt;{{ isUpdate ? '为了您的账户安全，请验证原密码' : '设置6位数字支付密码，用于支付验证' }}&lt;/p&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;div class=&quot;setup-form&quot;&gt;&#10;        &lt;div class=&quot;form-group&quot; v-if=&quot;isUpdate&quot;&gt;&#10;          &lt;label&gt;原支付密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;oldPassword&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请输入原支付密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;          &lt;label&gt;{{ isUpdate ? '新' : '' }}支付密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;password&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请输入6位数字密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;form-group&quot;&gt;&#10;          &lt;label&gt;确认密码&lt;/label&gt;&#10;          &lt;input&#10;            type=&quot;password&quot;&#10;            v-model=&quot;confirmPassword&quot;&#10;            maxlength=&quot;6&quot;&#10;            placeholder=&quot;请再次输入密码&quot;&#10;            class=&quot;password-input&quot;&#10;          /&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;password-tips&quot;&gt;&#10;          &lt;p&gt; 温馨提示：&lt;/p&gt;&#10;          &lt;ul&gt;&#10;            &lt;li&gt;支付密码必须是6位数字&lt;/li&gt;&#10;            &lt;li&gt;请不要使用过于简单的密码（如123456）&lt;/li&gt;&#10;            &lt;li&gt;请妥善保管您的支付密码&lt;/li&gt;&#10;          &lt;/ul&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div class=&quot;button-group&quot;&gt;&#10;          &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;goBack&quot;&gt;取消&lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-primary&quot; @click=&quot;submitPassword&quot; :disabled=&quot;loading&quot;&gt;&#10;            {{ loading ? '处理中...' : '确认' }}&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, onMounted } from 'vue';&#10;import { useRouter } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const isUpdate = ref(false);&#10;const oldPassword = ref('');&#10;const password = ref('');&#10;const confirmPassword = ref('');&#10;const loading = ref(false);&#10;&#10;const checkPaymentPasswordStatus = async () =&gt; {&#10;  try {&#10;    const response = await axios.get('/api/users/payment-password/check');&#10;    isUpdate.value = response.data.hasPaymentPassword;&#10;  } catch (error) {&#10;    console.error('检查支付密码状态失败:', error);&#10;  }&#10;};&#10;&#10;const submitPassword = async () =&gt; {&#10;  // 验证输入&#10;  if (isUpdate.value &amp;&amp; !oldPassword.value) {&#10;    alert('请输入原支付密码');&#10;    return;&#10;  }&#10;&#10;  if (!password.value) {&#10;    alert('请输入支付密码');&#10;    return;&#10;  }&#10;&#10;  if (!/^\d{6}$/.test(password.value)) {&#10;    alert('支付密码必须是6位数字');&#10;    return;&#10;  }&#10;&#10;  if (password.value !== confirmPassword.value) {&#10;    alert('两次输入的密码不一致');&#10;    return;&#10;  }&#10;&#10;  // 简单密码检查&#10;  const weakPasswords = ['123456', '000000', '111111', '222222', '333333', '444444', '555555', '666666', '777777', '888888', '999999'];&#10;  if (weakPasswords.includes(password.value)) {&#10;    if (!confirm('您输入的密码过于简单，容易被破解。确定要使用吗？')) {&#10;      return;&#10;    }&#10;  }&#10;&#10;  loading.value = true;&#10;&#10;  try {&#10;    if (isUpdate.value) {&#10;      // 修改支付密码&#10;      await axios.put('/api/users/payment-password/update', {&#10;        oldPassword: oldPassword.value,&#10;        newPassword: password.value,&#10;        confirmPassword: confirmPassword.value&#10;      });&#10;      alert('支付密码修改成功');&#10;    } else {&#10;      // 设置支付密码&#10;      await axios.post('/api/users/payment-password/set', {&#10;        password: password.value,&#10;        confirmPassword: confirmPassword.value&#10;      });&#10;      alert('支付密码设置成功');&#10;    }&#10;    &#10;    // 清空输入&#10;    oldPassword.value = '';&#10;    password.value = '';&#10;    confirmPassword.value = '';&#10;    &#10;    // 重新检查状态&#10;    await checkPaymentPasswordStatus();&#10;    &#10;    // 延迟跳转，确保状态已更新&#10;    setTimeout(() =&gt; {&#10;      router.back();&#10;    }, 500);&#10;  } catch (error) {&#10;    console.error('操作失败:', error);&#10;    if (error.response?.data?.message) {&#10;      alert(error.response.data.message);&#10;    } else {&#10;      alert('操作失败，请重试');&#10;    }&#10;  } finally {&#10;    loading.value = false;&#10;  }&#10;};&#10;&#10;const goBack = () =&gt; {&#10;  router.back();&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  checkPaymentPasswordStatus();&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.payment-password-setup {&#10;  min-height: 100vh;&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  padding: 20px;&#10;}&#10;&#10;.setup-container {&#10;  background: white;&#10;  border-radius: 12px;&#10;  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);&#10;  max-width: 500px;&#10;  width: 100%;&#10;  padding: 40px;&#10;}&#10;&#10;.setup-header {&#10;  text-align: center;&#10;  margin-bottom: 30px;&#10;}&#10;&#10;.setup-header h2 {&#10;  font-size: 28px;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.subtitle {&#10;  color: #666;&#10;  font-size: 14px;&#10;}&#10;&#10;.setup-form {&#10;  margin-top: 30px;&#10;}&#10;&#10;.form-group {&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.form-group label {&#10;  display: block;&#10;  margin-bottom: 8px;&#10;  color: #333;&#10;  font-weight: 500;&#10;}&#10;&#10;.password-input {&#10;  width: 100%;&#10;  padding: 12px;&#10;  border: 2px solid #e0e0e0;&#10;  border-radius: 8px;&#10;  font-size: 16px;&#10;  transition: border-color 0.3s;&#10;  letter-spacing: 4px;&#10;}&#10;&#10;.password-input:focus {&#10;  outline: none;&#10;  border-color: #667eea;&#10;}&#10;&#10;.password-tips {&#10;  background: #f8f9fa;&#10;  border-radius: 8px;&#10;  padding: 15px;&#10;  margin: 20px 0;&#10;}&#10;&#10;.password-tips p {&#10;  font-weight: 500;&#10;  color: #333;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.password-tips ul {&#10;  list-style: none;&#10;  padding: 0;&#10;  margin: 0;&#10;}&#10;&#10;.password-tips li {&#10;  color: #666;&#10;  font-size: 14px;&#10;  margin-bottom: 5px;&#10;  padding-left: 20px;&#10;  position: relative;&#10;}&#10;&#10;.password-tips li:before {&#10;  content: '•';&#10;  position: absolute;&#10;  left: 0;&#10;  color: #667eea;&#10;}&#10;&#10;.button-group {&#10;  display: flex;&#10;  gap: 15px;&#10;  margin-top: 30px;&#10;}&#10;&#10;.btn {&#10;  flex: 1;&#10;  padding: 12px;&#10;  border: none;&#10;  border-radius: 8px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-cancel {&#10;  background: #f0f0f0;&#10;  color: #666;&#10;}&#10;&#10;.btn-cancel:hover {&#10;  background: #e0e0e0;&#10;}&#10;&#10;.btn-primary {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover:not(:disabled) {&#10;  transform: translateY(-2px);&#10;  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);&#10;}&#10;&#10;.btn-primary:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&#10;@media (max-width: 576px) {&#10;  .setup-container {&#10;    padding: 30px 20px;&#10;  }&#10;&#10;  .button-group {&#10;    flex-direction: column;&#10;  }&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/PaymentView.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/PaymentView.vue" />
              <option name="originalContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;payment-page&quot;&gt;&#10;    &lt;div class=&quot;payment-container&quot;&gt;&#10;      &lt;div class=&quot;payment-header&quot;&gt;&#10;        &lt;h1&gt; 收银台&lt;/h1&gt;&#10;        &lt;p class=&quot;order-info&quot;&gt;订单号: {{ orderId }}&lt;/p&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 订单信息 --&gt;&#10;      &lt;div class=&quot;order-summary&quot; v-if=&quot;order&quot;&gt;&#10;        &lt;h3&gt;订单摘要&lt;/h3&gt;&#10;&#10;        &lt;!-- 倒计时提示 --&gt;&#10;        &lt;div class=&quot;countdown-alert&quot; :class=&quot;{ warning: remainingMinutes &lt; 5 }&quot;&gt;&#10;          &lt;span class=&quot;countdown-icon&quot;&gt;⏰&lt;/span&gt;&#10;          &lt;span v-if=&quot;!isExpired&quot;&gt;请在 &lt;strong&gt;{{ countdownText }}&lt;/strong&gt; 内完成支付&lt;/span&gt;&#10;          &lt;span v-else class=&quot;expired-text&quot;&gt;订单已过期&lt;/span&gt;&#10;        &lt;/div&gt;&#10;&#10;&#10;        &lt;div class=&quot;summary-item&quot;&gt;&#10;          &lt;span&gt;商品总额&lt;/span&gt;&#10;          &lt;span class=&quot;amount&quot;&gt;¥{{ order.totalAmount }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-divider&quot;&gt;&lt;/div&gt;&#10;        &lt;div class=&quot;summary-item total&quot;&gt;&#10;          &lt;span&gt;应付金额&lt;/span&gt;&#10;          &lt;span class=&quot;total-amount&quot;&gt;¥{{ order.totalAmount }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付方式选择 --&gt;&#10;      &lt;div class=&quot;payment-methods&quot;&gt;&#10;        &lt;h3&gt;选择支付方式&lt;/h3&gt;&#10;        &lt;div class=&quot;methods-list&quot;&gt;&#10;          &lt;div&#10;            v-for=&quot;method in paymentMethods&quot;&#10;            :key=&quot;method.id&quot;&#10;            class=&quot;method-item&quot;&#10;            :class=&quot;{ active: selectedMethod === method.id }&quot;&#10;            @click=&quot;selectMethod(method.id)&quot;&#10;          &gt;&#10;            &lt;div class=&quot;method-icon&quot;&gt;{{ method.icon }}&lt;/div&gt;&#10;            &lt;div class=&quot;method-info&quot;&gt;&#10;              &lt;div class=&quot;method-name&quot;&gt;{{ method.name }}&lt;/div&gt;&#10;              &lt;div class=&quot;method-desc&quot;&gt;{{ method.description }}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;method-radio&quot;&gt;&#10;              &lt;div class=&quot;radio-dot&quot; v-if=&quot;selectedMethod === method.id&quot;&gt;&lt;/div&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付按钮 --&gt;&#10;      &lt;div class=&quot;payment-actions&quot;&gt;&#10;        &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;goBack&quot;&gt;取消支付&lt;/button&gt;&#10;        &lt;button&#10;          class=&quot;btn btn-pay&quot;&#10;          @click=&quot;confirmPayment&quot;&#10;          :disabled=&quot;!selectedMethod || processing&quot;&#10;        &gt;&#10;          &lt;span v-if=&quot;!processing&quot;&gt;立即支付 ¥{{ order?.totalAmount || 0 }}&lt;/span&gt;&#10;          &lt;span v-else&gt;处理中...&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付密码弹窗 --&gt;&#10;      &lt;div v-if=&quot;showPasswordDialog&quot; class=&quot;password-overlay&quot; @click=&quot;closePasswordDialog&quot;&gt;&#10;        &lt;div class=&quot;password-dialog&quot; @click.stop&gt;&#10;          &lt;div class=&quot;dialog-header&quot;&gt;&#10;            &lt;h3&gt;请输入支付密码&lt;/h3&gt;&#10;            &lt;button @click=&quot;closePasswordDialog&quot; class=&quot;close-btn&quot;&gt;×&lt;/button&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;dialog-body&quot;&gt;&#10;            &lt;div class=&quot;payment-info&quot;&gt;&#10;              &lt;div class=&quot;payment-method-icon&quot;&gt;{{ currentMethodIcon }}&lt;/div&gt;&#10;              &lt;div class=&quot;payment-amount&quot;&gt;¥{{ order?.totalAmount || 0 }}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;password-input-container&quot;&gt;&#10;              &lt;input&#10;                v-for=&quot;i in 6&quot;&#10;                :key=&quot;i&quot;&#10;                type=&quot;password&quot;&#10;                maxlength=&quot;1&quot;&#10;                class=&quot;password-digit&quot;&#10;                :ref=&quot;el =&gt; passwordInputs[i - 1] = el&quot;&#10;                v-model=&quot;passwordDigits[i - 1]&quot;&#10;                @input=&quot;handlePasswordInput(i - 1)&quot;&#10;                @keydown=&quot;handleKeyDown($event, i - 1)&quot;&#10;              /&gt;&#10;            &lt;/div&gt;&#10;            &lt;p class=&quot;password-tip&quot;&gt;为了您的资金安全，请输入6位支付密码&lt;/p&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;dialog-actions&quot;&gt;&#10;            &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;closePasswordDialog&quot;&gt;取消&lt;/button&gt;&#10;            &lt;button&#10;              class=&quot;btn btn-confirm&quot;&#10;              @click=&quot;submitPayment&quot;&#10;              :disabled=&quot;password.length !== 6 || processing&quot;&#10;            &gt;&#10;              确认支付&#10;            &lt;/button&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted, onUnmounted } from 'vue';&#10;import { useRouter, useRoute } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const route = useRoute();&#10;const orderId = ref(route.params.orderId || route.query.orderId);&#10;const order = ref(null);&#10;const selectedMethod = ref(null);&#10;const processing = ref(false);&#10;const showPasswordDialog = ref(false);&#10;const passwordDigits = ref(['', '', '', '', '', '']);&#10;const passwordInputs = ref([]);&#10;const remainingTime = ref(0);&#10;const isExpired = ref(false);&#10;let countdownTimer = null;&#10;&#10;const paymentMethods = [&#10;  {&#10;    id: 'alipay',&#10;    name: '支付宝',&#10;    icon: '',&#10;    description: '推荐使用支付宝快捷支付'&#10;  },&#10;  {&#10;    id: 'wechat',&#10;    name: '微信支付',&#10;    icon: '',&#10;    description: '使用微信安全支付'&#10;  },&#10;  {&#10;    id: 'bank',&#10;    name: '银行卡',&#10;    icon: '',&#10;    description: '储蓄卡、信用卡均可'&#10;  },&#10;  {&#10;    id: 'balance',&#10;    name: '余额支付',&#10;    icon: '',&#10;&#10;    description: '使用账户余额支付'&#10;  }&#10;];&#10;&#10;const password = computed(() =&gt; passwordDigits.value.join(''));&#10;&#10;const currentMethodIcon = computed(() =&gt; {&#10;  const method = paymentMethods.find(m =&gt; m.id === selectedMethod.value);&#10;  return method ? method.icon : '';&#10;});&#10;&#10;const fetchOrderDetails = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/orders/${orderId.value}`);&#10;    order.value = response.data;&#10;&#10;    // 检查订单状态&#10;    if (order.value.status === 'EXPIRED') {&#10;      alert('该订单已过期');&#10;      router.push('/order-history');&#10;      return;&#10;    }&#10;&#10;    if (order.value.status !== 'PENDING') {&#10;      alert('该订单不可支付');&#10;      router.push('/order-history');&#10;      return;&#10;    }&#10;&#10;    // 启动倒计时&#10;    startCountdown();&#10;  } catch (error) {&#10;    console.error('获取订单详情失败:', error);&#10;    alert('获取订单详情失败');&#10;    router.push('/order-history');&#10;  }&#10;};&#10;&#10;const selectMethod = (methodId) =&gt; {&#10;  selectedMethod.value = methodId;&#10;};&#10;&#10;const confirmPayment = async () =&gt; {&#10;  if (!selectedMethod.value) {&#10;    alert('请选择支付方式');&#10;    return;&#10;  }&#10;&#10;  // 检查用户是否已设置支付密码&#10;  try {&#10;    const response = await axios.get('/api/users/payment-password/check');&#10;    if (!response.data.hasPaymentPassword) {&#10;      if (confirm('您还未设置支付密码，是否现在设置？')) {&#10;        router.push('/payment-password/setup');&#10;      }&#10;      return;&#10;    }&#10;  } catch (error) {&#10;    console.error('检查支付密码失败:', error);&#10;    alert('检查支付密码状态失败，请重试');&#10;    return;&#10;  }&#10;&#10;  showPasswordDialog.value = true;&#10;  // 自动聚焦第一个输入框&#10;  setTimeout(() =&gt; {&#10;    if (passwordInputs.value[0]) {&#10;      passwordInputs.value[0].focus();&#10;    }&#10;  }, 100);&#10;};&#10;&#10;const closePasswordDialog = () =&gt; {&#10;  showPasswordDialog.value = false;&#10;  passwordDigits.value = ['', '', '', '', '', ''];&#10;};&#10;&#10;const handlePasswordInput = (index) =&gt; {&#10;  // 如果输入了数字，自动跳到下一个输入框&#10;  if (passwordDigits.value[index] &amp;&amp; index &lt; 5) {&#10;    passwordInputs.value[index + 1]?.focus();&#10;  }&#10;};&#10;&#10;const handleKeyDown = (event, index) =&gt; {&#10;  // 按退格键时跳到上一个输入框&#10;  if (event.key === 'Backspace' &amp;&amp; !passwordDigits.value[index] &amp;&amp; index &gt; 0) {&#10;    passwordInputs.value[index - 1]?.focus();&#10;  }&#10;};&#10;&#10;const remainingMinutes = computed(() =&gt; Math.floor(remainingTime.value / 60));&#10;&#10;const countdownText = computed(() =&gt; {&#10;  if (remainingTime.value &lt;= 0) return '0分0秒';&#10;  const minutes = Math.floor(remainingTime.value / 60);&#10;  const seconds = remainingTime.value % 60;&#10;  return `${minutes}分${seconds}秒`;&#10;});&#10;&#10;const startCountdown = () =&gt; {&#10;  if (!order.value || !order.value.expireTime) return;&#10;&#10;  const updateCountdown = () =&gt; {&#10;    const now = new Date().getTime();&#10;    const expireTime = new Date(order.value.expireTime).getTime();&#10;    const diff = Math.floor((expireTime - now) / 1000);&#10;&#10;    if (diff &lt;= 0) {&#10;      remainingTime.value = 0;&#10;      isExpired.value = true;&#10;      clearInterval(countdownTimer);&#10;&#10;      // 订单已过期，跳转到失败页面&#10;      alert('订单已过期，商品已恢复到购物车');&#10;      router.push({&#10;        path: '/payment-result',&#10;        query: {&#10;          orderId: orderId.value,&#10;          status: 'failed',&#10;          message: '订单支付超时已自动关闭'&#10;        }&#10;      });&#10;    } else {&#10;      remainingTime.value = diff;&#10;    }&#10;  };&#10;&#10;  updateCountdown();&#10;  countdownTimer = setInterval(updateCountdown, 1000);&#10;};&#10;&#10;const submitPayment = async () =&gt; {&#10;  if (password.value.length !== 6) {&#10;    alert('请输入完整的支付密码');&#10;    return;&#10;  }&#10;&#10;  processing.value = true;&#10;&#10;  try {&#10;    // 模拟支付处理延迟&#10;    await new Promise(resolve =&gt; setTimeout(resolve, 1500));&#10;&#10;    // 调用支付接口&#10;    await axios.post(`/api/orders/${orderId.value}/pay`, {&#10;      paymentMethod: selectedMethod.value,&#10;      password: password.value&#10;    });&#10;&#10;    // 支付成功，跳转到成功页面&#10;    router.push({&#10;      path: '/payment-result',&#10;      query: {&#10;        orderId: orderId.value,&#10;        status: 'success',&#10;        amount: order.value.totalAmount,&#10;        method: selectedMethod.value&#10;      }&#10;    });&#10;  } catch (error) {&#10;    console.error('支付失败:', error);&#10;    // 支付失败，跳转到失败页面&#10;    router.push({&#10;      path: '/payment-result',&#10;      query: {&#10;        orderId: orderId.value,&#10;        status: 'failed',&#10;        message: error.response?.data?.message || '支付失败，请重试'&#10;      }&#10;    });&#10;  } finally {&#10;    processing.value = false;&#10;    closePasswordDialog();&#10;  }&#10;};&#10;&#10;const goBack = () =&gt; {&#10;  if (confirm('确定要取消支付吗？')) {&#10;    router.push('/order-history');&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  if (!orderId.value) {&#10;    alert('订单信息错误');&#10;    router.push('/order-history');&#10;    return;&#10;  }&#10;  fetchOrderDetails();&#10;});&#10;&#10;onUnmounted(() =&gt; {&#10;  if (countdownTimer) {&#10;    clearInterval(countdownTimer);&#10;  }&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.payment-page {&#10;  min-height: 100vh;&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  padding: 40px 20px;&#10;}&#10;&#10;.payment-container {&#10;  max-width: 800px;&#10;  margin: 0 auto;&#10;}&#10;&#10;.payment-header {&#10;  text-align: center;&#10;  color: white;&#10;  margin-bottom: 30px;&#10;}&#10;&#10;.payment-header h1 {&#10;  font-size: 36px;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.order-info {&#10;  font-size: 14px;&#10;  opacity: 0.9;&#10;}&#10;&#10;.order-summary {&#10;  background: white;&#10;  border-radius: 16px;&#10;  padding: 24px;&#10;  margin-bottom: 20px;&#10;  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);&#10;}&#10;&#10;.order-summary h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 16px;&#10;  color: #333;&#10;}&#10;&#10;.countdown-alert {&#10;  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);&#10;  color: white;&#10;  padding: 12px 16px;&#10;  border-radius: 8px;&#10;  margin-bottom: 16px;&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;  font-size: 14px;&#10;}&#10;&#10;.countdown-alert.warning {&#10;  background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);&#10;  animation: pulse 1.5s ease-in-out infinite;&#10;}&#10;&#10;@keyframes pulse {&#10;  0%, 100% {&#10;    transform: scale(1);&#10;  }&#10;  50% {&#10;    transform: scale(1.02);&#10;  }&#10;}&#10;&#10;.countdown-icon {&#10;  font-size: 18px;&#10;}&#10;&#10;.expired-text {&#10;  font-weight: bold;&#10;}&#10;&#10;.summary-item {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  padding: 12px 0;&#10;  font-size: 15px;&#10;}&#10;&#10;.summary-item .amount {&#10;  color: #666;&#10;}&#10;&#10;.summary-item.total {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;}&#10;&#10;.summary-item.total .total-amount {&#10;  color: #ff4d4f;&#10;  font-size: 24px;&#10;}&#10;&#10;.summary-divider {&#10;  height: 1px;&#10;  background: #eee;&#10;  margin: 12px 0;&#10;}&#10;&#10;.payment-methods {&#10;  background: white;&#10;  border-radius: 16px;&#10;  padding: 24px;&#10;  margin-bottom: 20px;&#10;  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);&#10;}&#10;&#10;.payment-methods h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 16px;&#10;  color: #333;&#10;}&#10;&#10;.methods-list {&#10;  display: flex;&#10;  flex-direction: column;&#10;  gap: 12px;&#10;}&#10;&#10;.method-item {&#10;  display: flex;&#10;  align-items: center;&#10;  padding: 16px;&#10;  border: 2px solid #e8e8e8;&#10;  border-radius: 12px;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.method-item:hover {&#10;  border-color: #667eea;&#10;  background: #f8f9ff;&#10;}&#10;&#10;.method-item.active {&#10;  border-color: #667eea;&#10;  background: #f8f9ff;&#10;}&#10;&#10;.method-icon {&#10;  font-size: 32px;&#10;  margin-right: 16px;&#10;}&#10;&#10;.method-info {&#10;  flex: 1;&#10;}&#10;&#10;.method-name {&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  color: #333;&#10;  margin-bottom: 4px;&#10;}&#10;&#10;.method-desc {&#10;  font-size: 13px;&#10;  color: #999;&#10;}&#10;&#10;.method-radio {&#10;  width: 20px;&#10;  height: 20px;&#10;  border: 2px solid #ddd;&#10;  border-radius: 50%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.method-item.active .method-radio {&#10;  border-color: #667eea;&#10;}&#10;&#10;.radio-dot {&#10;  width: 10px;&#10;  height: 10px;&#10;  background: #667eea;&#10;  border-radius: 50%;&#10;}&#10;&#10;.payment-actions {&#10;  display: flex;&#10;  gap: 16px;&#10;}&#10;&#10;.btn {&#10;  flex: 1;&#10;  padding: 16px;&#10;  border: none;&#10;  border-radius: 12px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-cancel {&#10;  background: white;&#10;  color: #666;&#10;  border: 2px solid #e8e8e8;&#10;}&#10;&#10;.btn-cancel:hover {&#10;  background: #f5f5f5;&#10;}&#10;&#10;.btn-pay {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);&#10;}&#10;&#10;.btn-pay:hover:not(:disabled) {&#10;  transform: translateY(-2px);&#10;  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);&#10;}&#10;&#10;.btn-pay:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&#10;/* 支付密码弹窗 */&#10;.password-overlay {&#10;  position: fixed;&#10;  top: 0;&#10;  left: 0;&#10;  right: 0;&#10;  bottom: 0;&#10;  background: rgba(0, 0, 0, 0.5);&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  z-index: 1000;&#10;}&#10;&#10;.password-dialog {&#10;  background: white;&#10;  border-radius: 20px;&#10;  width: 90%;&#10;  max-width: 400px;&#10;  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);&#10;}&#10;&#10;.dialog-header {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  align-items: center;&#10;  padding: 24px;&#10;  border-bottom: 1px solid #eee;&#10;}&#10;&#10;.dialog-header h3 {&#10;  font-size: 18px;&#10;  color: #333;&#10;}&#10;&#10;.close-btn {&#10;  background: none;&#10;  border: none;&#10;  font-size: 28px;&#10;  color: #999;&#10;  cursor: pointer;&#10;  line-height: 1;&#10;  padding: 0;&#10;  width: 32px;&#10;  height: 32px;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  border-radius: 50%;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.close-btn:hover {&#10;  background: #f5f5f5;&#10;  color: #666;&#10;}&#10;&#10;.dialog-body {&#10;  padding: 32px 24px;&#10;}&#10;&#10;.payment-info {&#10;  text-align: center;&#10;  margin-bottom: 32px;&#10;}&#10;&#10;.payment-method-icon {&#10;  font-size: 48px;&#10;  margin-bottom: 12px;&#10;}&#10;&#10;.payment-amount {&#10;  font-size: 32px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;}&#10;&#10;.password-input-container {&#10;  display: flex;&#10;  justify-content: center;&#10;  gap: 12px;&#10;  margin-bottom: 16px;&#10;}&#10;&#10;.password-digit {&#10;  width: 48px;&#10;  height: 56px;&#10;  border: 2px solid #e8e8e8;&#10;  border-radius: 12px;&#10;  text-align: center;&#10;  font-size: 24px;&#10;  font-weight: bold;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.password-digit:focus {&#10;  outline: none;&#10;  border-color: #667eea;&#10;  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);&#10;}&#10;&#10;.password-tip {&#10;  text-align: center;&#10;  font-size: 13px;&#10;  color: #999;&#10;}&#10;&#10;.dialog-actions {&#10;  display: flex;&#10;  gap: 12px;&#10;  padding: 16px 24px;&#10;  border-top: 1px solid #eee;&#10;}&#10;&#10;.dialog-actions .btn {&#10;  flex: 1;&#10;  padding: 12px;&#10;}&#10;&#10;.btn-confirm {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;}&#10;&#10;.btn-confirm:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div class=&quot;payment-page&quot;&gt;&#10;    &lt;div class=&quot;payment-container&quot;&gt;&#10;      &lt;div class=&quot;payment-header&quot;&gt;&#10;        &lt;h1&gt; 收银台&lt;/h1&gt;&#10;        &lt;p class=&quot;order-info&quot;&gt;订单号: {{ orderId }}&lt;/p&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 订单信息 --&gt;&#10;      &lt;div class=&quot;order-summary&quot; v-if=&quot;order&quot;&gt;&#10;        &lt;h3&gt;订单摘要&lt;/h3&gt;&#10;&#10;        &lt;!-- 倒计时提示 --&gt;&#10;        &lt;div class=&quot;countdown-alert&quot; :class=&quot;{ warning: remainingMinutes &lt; 5 }&quot;&gt;&#10;          &lt;span class=&quot;countdown-icon&quot;&gt;⏰&lt;/span&gt;&#10;          &lt;span v-if=&quot;!isExpired&quot;&gt;请在 &lt;strong&gt;{{ countdownText }}&lt;/strong&gt; 内完成支付&lt;/span&gt;&#10;          &lt;span v-else class=&quot;expired-text&quot;&gt;订单已过期&lt;/span&gt;&#10;        &lt;/div&gt;&#10;&#10;&#10;        &lt;div class=&quot;summary-item&quot;&gt;&#10;          &lt;span&gt;商品总额&lt;/span&gt;&#10;          &lt;span class=&quot;amount&quot;&gt;¥{{ order.totalAmount }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;summary-divider&quot;&gt;&lt;/div&gt;&#10;        &lt;div class=&quot;summary-item total&quot;&gt;&#10;          &lt;span&gt;应付金额&lt;/span&gt;&#10;          &lt;span class=&quot;total-amount&quot;&gt;¥{{ order.totalAmount }}&lt;/span&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付方式选择 --&gt;&#10;      &lt;div class=&quot;payment-methods&quot;&gt;&#10;        &lt;h3&gt;选择支付方式&lt;/h3&gt;&#10;        &lt;div class=&quot;methods-list&quot;&gt;&#10;          &lt;div&#10;            v-for=&quot;method in paymentMethods&quot;&#10;            :key=&quot;method.id&quot;&#10;            class=&quot;method-item&quot;&#10;            :class=&quot;{ active: selectedMethod === method.id }&quot;&#10;            @click=&quot;selectMethod(method.id)&quot;&#10;          &gt;&#10;            &lt;div class=&quot;method-icon&quot;&gt;{{ method.icon }}&lt;/div&gt;&#10;            &lt;div class=&quot;method-info&quot;&gt;&#10;              &lt;div class=&quot;method-name&quot;&gt;{{ method.name }}&lt;/div&gt;&#10;              &lt;div class=&quot;method-desc&quot;&gt;{{ method.description }}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;method-radio&quot;&gt;&#10;              &lt;div class=&quot;radio-dot&quot; v-if=&quot;selectedMethod === method.id&quot;&gt;&lt;/div&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付按钮 --&gt;&#10;      &lt;div class=&quot;payment-actions&quot;&gt;&#10;        &lt;button class=&quot;btn btn-home&quot; @click=&quot;goHome&quot;&gt; 返回主页&lt;/button&gt;&#10;        &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;cancelOrder&quot;&gt;取消订单&lt;/button&gt;&#10;        &lt;button&#10;          class=&quot;btn btn-pay&quot;&#10;          @click=&quot;confirmPayment&quot;&#10;          :disabled=&quot;!selectedMethod || processing&quot;&#10;        &gt;&#10;          &lt;span v-if=&quot;!processing&quot;&gt;立即支付 ¥{{ order?.totalAmount || 0 }}&lt;/span&gt;&#10;          &lt;span v-else&gt;处理中...&lt;/span&gt;&#10;        &lt;/button&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 支付密码弹窗 --&gt;&#10;      &lt;div v-if=&quot;showPasswordDialog&quot; class=&quot;password-overlay&quot; @click=&quot;closePasswordDialog&quot;&gt;&#10;        &lt;div class=&quot;password-dialog&quot; @click.stop&gt;&#10;          &lt;div class=&quot;dialog-header&quot;&gt;&#10;            &lt;h3&gt;请输入支付密码&lt;/h3&gt;&#10;            &lt;button @click=&quot;closePasswordDialog&quot; class=&quot;close-btn&quot;&gt;×&lt;/button&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;dialog-body&quot;&gt;&#10;            &lt;div class=&quot;payment-info&quot;&gt;&#10;              &lt;div class=&quot;payment-method-icon&quot;&gt;{{ currentMethodIcon }}&lt;/div&gt;&#10;              &lt;div class=&quot;payment-amount&quot;&gt;¥{{ order?.totalAmount || 0 }}&lt;/div&gt;&#10;            &lt;/div&gt;&#10;            &lt;div class=&quot;password-input-container&quot;&gt;&#10;              &lt;input&#10;                v-for=&quot;i in 6&quot;&#10;                :key=&quot;i&quot;&#10;                type=&quot;password&quot;&#10;                maxlength=&quot;1&quot;&#10;                class=&quot;password-digit&quot;&#10;                :ref=&quot;el =&gt; passwordInputs[i - 1] = el&quot;&#10;                v-model=&quot;passwordDigits[i - 1]&quot;&#10;                @input=&quot;handlePasswordInput(i - 1)&quot;&#10;                @keydown=&quot;handleKeyDown($event, i - 1)&quot;&#10;              /&gt;&#10;            &lt;/div&gt;&#10;            &lt;p class=&quot;password-tip&quot;&gt;为了您的资金安全，请输入6位支付密码&lt;/p&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;dialog-actions&quot;&gt;&#10;            &lt;button class=&quot;btn btn-cancel&quot; @click=&quot;closePasswordDialog&quot;&gt;取消&lt;/button&gt;&#10;            &lt;button&#10;              class=&quot;btn btn-confirm&quot;&#10;              @click=&quot;submitPayment&quot;&#10;              :disabled=&quot;password.length !== 6 || processing&quot;&#10;            &gt;&#10;              确认支付&#10;            &lt;/button&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted, onUnmounted } from 'vue';&#10;import { useRouter, useRoute } from 'vue-router';&#10;import axios from 'axios';&#10;&#10;const router = useRouter();&#10;const route = useRoute();&#10;const orderId = ref(route.params.orderId || route.query.orderId);&#10;const order = ref(null);&#10;const selectedMethod = ref(null);&#10;const processing = ref(false);&#10;const showPasswordDialog = ref(false);&#10;const passwordDigits = ref(['', '', '', '', '', '']);&#10;const passwordInputs = ref([]);&#10;const remainingTime = ref(0);&#10;const isExpired = ref(false);&#10;let countdownTimer = null;&#10;&#10;const paymentMethods = [&#10;  {&#10;    id: 'alipay',&#10;    name: '支付宝',&#10;    icon: '',&#10;    description: '推荐使用支付宝快捷支付'&#10;  },&#10;  {&#10;    id: 'wechat',&#10;    name: '微信支付',&#10;    icon: '',&#10;    description: '使用微信安全支付'&#10;  },&#10;  {&#10;    id: 'bank',&#10;    name: '银行卡',&#10;    icon: '',&#10;    description: '储蓄卡、信用卡均可'&#10;  },&#10;  {&#10;    id: 'balance',&#10;    name: '余额支付',&#10;    icon: '',&#10;&#10;    description: '使用账户余额支付'&#10;  }&#10;];&#10;&#10;const password = computed(() =&gt; passwordDigits.value.join(''));&#10;&#10;const currentMethodIcon = computed(() =&gt; {&#10;  const method = paymentMethods.find(m =&gt; m.id === selectedMethod.value);&#10;  return method ? method.icon : '';&#10;});&#10;&#10;const fetchOrderDetails = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/orders/${orderId.value}`);&#10;    order.value = response.data;&#10;&#10;    // 检查订单状态&#10;    if (order.value.status === 'EXPIRED') {&#10;      alert('该订单已过期');&#10;      router.push('/order-history');&#10;      return;&#10;    }&#10;&#10;    if (order.value.status !== 'PENDING') {&#10;      alert('该订单不可支付');&#10;      router.push('/order-history');&#10;      return;&#10;    }&#10;&#10;    // 启动倒计时&#10;    startCountdown();&#10;  } catch (error) {&#10;    console.error('获取订单详情失败:', error);&#10;    alert('获取订单详情失败');&#10;    router.push('/order-history');&#10;  }&#10;};&#10;&#10;const selectMethod = (methodId) =&gt; {&#10;  selectedMethod.value = methodId;&#10;};&#10;&#10;const confirmPayment = async () =&gt; {&#10;  if (!selectedMethod.value) {&#10;    alert('请选择支付方式');&#10;    return;&#10;  }&#10;&#10;  // 检查用户是否已设置支付密码&#10;  try {&#10;    const response = await axios.get('/api/users/payment-password/check');&#10;    if (!response.data.hasPaymentPassword) {&#10;      if (confirm('您还未设置支付密码，是否现在设置？')) {&#10;        router.push('/payment-password/setup');&#10;      }&#10;      return;&#10;    }&#10;  } catch (error) {&#10;    console.error('检查支付密码失败:', error);&#10;    alert('检查支付密码状态失败，请重试');&#10;    return;&#10;  }&#10;&#10;  showPasswordDialog.value = true;&#10;  // 自动聚焦第一个输入框&#10;  setTimeout(() =&gt; {&#10;    if (passwordInputs.value[0]) {&#10;      passwordInputs.value[0].focus();&#10;    }&#10;  }, 100);&#10;};&#10;&#10;const closePasswordDialog = () =&gt; {&#10;  showPasswordDialog.value = false;&#10;  passwordDigits.value = ['', '', '', '', '', ''];&#10;};&#10;&#10;const handlePasswordInput = (index) =&gt; {&#10;  // 如果输入了数字，自动跳到下一个输入框&#10;  if (passwordDigits.value[index] &amp;&amp; index &lt; 5) {&#10;    passwordInputs.value[index + 1]?.focus();&#10;  }&#10;};&#10;&#10;const handleKeyDown = (event, index) =&gt; {&#10;  // 按退格键时跳到上一个输入框&#10;  if (event.key === 'Backspace' &amp;&amp; !passwordDigits.value[index] &amp;&amp; index &gt; 0) {&#10;    passwordInputs.value[index - 1]?.focus();&#10;  }&#10;};&#10;&#10;const remainingMinutes = computed(() =&gt; Math.floor(remainingTime.value / 60));&#10;&#10;const countdownText = computed(() =&gt; {&#10;  if (remainingTime.value &lt;= 0) return '0分0秒';&#10;  const minutes = Math.floor(remainingTime.value / 60);&#10;  const seconds = remainingTime.value % 60;&#10;  return `${minutes}分${seconds}秒`;&#10;});&#10;&#10;const startCountdown = () =&gt; {&#10;  if (!order.value || !order.value.expireTime) return;&#10;&#10;  const updateCountdown = () =&gt; {&#10;    const now = new Date().getTime();&#10;    const expireTime = new Date(order.value.expireTime).getTime();&#10;    const diff = Math.floor((expireTime - now) / 1000);&#10;&#10;    if (diff &lt;= 0) {&#10;      remainingTime.value = 0;&#10;      isExpired.value = true;&#10;      clearInterval(countdownTimer);&#10;&#10;      // 订单已过期，跳转到失败页面&#10;      alert('订单已过期，商品已恢复到购物车');&#10;      router.push({&#10;        path: '/payment-result',&#10;        query: {&#10;          orderId: orderId.value,&#10;          status: 'failed',&#10;          message: '订单支付超时已自动关闭'&#10;        }&#10;      });&#10;    } else {&#10;      remainingTime.value = diff;&#10;    }&#10;  };&#10;&#10;  updateCountdown();&#10;  countdownTimer = setInterval(updateCountdown, 1000);&#10;};&#10;&#10;const submitPayment = async () =&gt; {&#10;  if (password.value.length !== 6) {&#10;    alert('请输入完整的支付密码');&#10;    return;&#10;  }&#10;&#10;  processing.value = true;&#10;&#10;  try {&#10;    // 模拟支付处理延迟&#10;    await new Promise(resolve =&gt; setTimeout(resolve, 1500));&#10;&#10;    // 调用支付接口&#10;    await axios.post(`/api/orders/${orderId.value}/pay`, {&#10;      paymentMethod: selectedMethod.value,&#10;      password: password.value&#10;    });&#10;&#10;    // 支付成功，跳转到成功页面&#10;    router.push({&#10;      path: '/payment-result',&#10;      query: {&#10;        orderId: orderId.value,&#10;        status: 'success',&#10;        amount: order.value.totalAmount,&#10;        method: selectedMethod.value&#10;      }&#10;    });&#10;  } catch (error) {&#10;    console.error('支付失败:', error);&#10;    // 支付失败，跳转到失败页面&#10;    router.push({&#10;      path: '/payment-result',&#10;      query: {&#10;        orderId: orderId.value,&#10;        status: 'failed',&#10;        message: error.response?.data?.message || '支付失败，请重试'&#10;      }&#10;    });&#10;  } finally {&#10;    processing.value = false;&#10;    closePasswordDialog();&#10;  }&#10;};&#10;&#10;const goHome = () =&gt; {&#10;  router.push('/');&#10;};&#10;&#10;const cancelOrder = async () =&gt; {&#10;  if (!confirm('确定要取消订单吗？订单将被关闭，商品将恢复到购物车。')) {&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.post(`/api/orders/${orderId.value}/cancel`);&#10;    alert('订单已取消');&#10;    router.push('/');&#10;  } catch (error) {&#10;    console.error('取消订单失败:', error);&#10;    alert('取消订单失败');&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  if (!orderId.value) {&#10;    alert('订单信息错误');&#10;    router.push('/order-history');&#10;    return;&#10;  }&#10;  fetchOrderDetails();&#10;});&#10;&#10;onUnmounted(() =&gt; {&#10;  if (countdownTimer) {&#10;    clearInterval(countdownTimer);&#10;  }&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.payment-page {&#10;  min-height: 100vh;&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  padding: 40px 20px;&#10;}&#10;&#10;.payment-container {&#10;  max-width: 800px;&#10;  margin: 0 auto;&#10;}&#10;&#10;.payment-header {&#10;  text-align: center;&#10;  color: white;&#10;  margin-bottom: 30px;&#10;}&#10;&#10;.payment-header h1 {&#10;  font-size: 36px;&#10;  margin-bottom: 10px;&#10;}&#10;&#10;.order-info {&#10;  font-size: 14px;&#10;  opacity: 0.9;&#10;}&#10;&#10;.order-summary {&#10;  background: white;&#10;  border-radius: 16px;&#10;  padding: 24px;&#10;  margin-bottom: 20px;&#10;  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);&#10;}&#10;&#10;.order-summary h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 16px;&#10;  color: #333;&#10;}&#10;&#10;.countdown-alert {&#10;  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);&#10;  color: white;&#10;  padding: 12px 16px;&#10;  border-radius: 8px;&#10;  margin-bottom: 16px;&#10;  display: flex;&#10;  align-items: center;&#10;  gap: 8px;&#10;  font-size: 14px;&#10;}&#10;&#10;.countdown-alert.warning {&#10;  background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);&#10;  animation: pulse 1.5s ease-in-out infinite;&#10;}&#10;&#10;@keyframes pulse {&#10;  0%, 100% {&#10;    transform: scale(1);&#10;  }&#10;  50% {&#10;    transform: scale(1.02);&#10;  }&#10;}&#10;&#10;.countdown-icon {&#10;  font-size: 18px;&#10;}&#10;&#10;.expired-text {&#10;  font-weight: bold;&#10;}&#10;&#10;.summary-item {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  padding: 12px 0;&#10;  font-size: 15px;&#10;}&#10;&#10;.summary-item .amount {&#10;  color: #666;&#10;}&#10;&#10;.summary-item.total {&#10;  font-size: 18px;&#10;  font-weight: bold;&#10;}&#10;&#10;.summary-item.total .total-amount {&#10;  color: #ff4d4f;&#10;  font-size: 24px;&#10;}&#10;&#10;.summary-divider {&#10;  height: 1px;&#10;  background: #eee;&#10;  margin: 12px 0;&#10;}&#10;&#10;.payment-methods {&#10;  background: white;&#10;  border-radius: 16px;&#10;  padding: 24px;&#10;  margin-bottom: 20px;&#10;  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);&#10;}&#10;&#10;.payment-methods h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 16px;&#10;  color: #333;&#10;}&#10;&#10;.methods-list {&#10;  display: flex;&#10;  flex-direction: column;&#10;  gap: 12px;&#10;}&#10;&#10;.method-item {&#10;  display: flex;&#10;  align-items: center;&#10;  padding: 16px;&#10;  border: 2px solid #e8e8e8;&#10;  border-radius: 12px;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.method-item:hover {&#10;  border-color: #667eea;&#10;  background: #f8f9ff;&#10;}&#10;&#10;.method-item.active {&#10;  border-color: #667eea;&#10;  background: #f8f9ff;&#10;}&#10;&#10;.method-icon {&#10;  font-size: 32px;&#10;  margin-right: 16px;&#10;}&#10;&#10;.method-info {&#10;  flex: 1;&#10;}&#10;&#10;.method-name {&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  color: #333;&#10;  margin-bottom: 4px;&#10;}&#10;&#10;.method-desc {&#10;  font-size: 13px;&#10;  color: #999;&#10;}&#10;&#10;.method-radio {&#10;  width: 20px;&#10;  height: 20px;&#10;  border: 2px solid #ddd;&#10;  border-radius: 50%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.method-item.active .method-radio {&#10;  border-color: #667eea;&#10;}&#10;&#10;.radio-dot {&#10;  width: 10px;&#10;  height: 10px;&#10;  background: #667eea;&#10;  border-radius: 50%;&#10;}&#10;&#10;.payment-actions {&#10;  display: flex;&#10;  gap: 16px;&#10;}&#10;&#10;.btn {&#10;  flex: 1;&#10;  padding: 16px;&#10;  border: none;&#10;  border-radius: 12px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.btn-cancel {&#10;  background: white;&#10;  color: #666;&#10;  border: 2px solid #e8e8e8;&#10;}&#10;&#10;.btn-cancel:hover {&#10;  background: #f5f5f5;&#10;}&#10;&#10;.btn-pay {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);&#10;}&#10;&#10;.btn-pay:hover:not(:disabled) {&#10;  transform: translateY(-2px);&#10;  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);&#10;}&#10;&#10;.btn-pay:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&#10;/* 支付密码弹窗 */&#10;.password-overlay {&#10;  position: fixed;&#10;  top: 0;&#10;  left: 0;&#10;  right: 0;&#10;  bottom: 0;&#10;  background: rgba(0, 0, 0, 0.5);&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  z-index: 1000;&#10;}&#10;&#10;.password-dialog {&#10;  background: white;&#10;  border-radius: 20px;&#10;  width: 90%;&#10;  max-width: 400px;&#10;  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);&#10;}&#10;&#10;.dialog-header {&#10;  display: flex;&#10;  justify-content: space-between;&#10;  align-items: center;&#10;  padding: 24px;&#10;  border-bottom: 1px solid #eee;&#10;}&#10;&#10;.dialog-header h3 {&#10;  font-size: 18px;&#10;  color: #333;&#10;}&#10;&#10;.close-btn {&#10;  background: none;&#10;  border: none;&#10;  font-size: 28px;&#10;  color: #999;&#10;  cursor: pointer;&#10;  line-height: 1;&#10;  padding: 0;&#10;  width: 32px;&#10;  height: 32px;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;  border-radius: 50%;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.close-btn:hover {&#10;  background: #f5f5f5;&#10;  color: #666;&#10;}&#10;&#10;.dialog-body {&#10;  padding: 32px 24px;&#10;}&#10;&#10;.payment-info {&#10;  text-align: center;&#10;  margin-bottom: 32px;&#10;}&#10;&#10;.payment-method-icon {&#10;  font-size: 48px;&#10;  margin-bottom: 12px;&#10;}&#10;&#10;.payment-amount {&#10;  font-size: 32px;&#10;  font-weight: bold;&#10;  color: #ff4d4f;&#10;}&#10;&#10;.password-input-container {&#10;  display: flex;&#10;  justify-content: center;&#10;  gap: 12px;&#10;  margin-bottom: 16px;&#10;}&#10;&#10;.password-digit {&#10;  width: 48px;&#10;  height: 56px;&#10;  border: 2px solid #e8e8e8;&#10;  border-radius: 12px;&#10;  text-align: center;&#10;  font-size: 24px;&#10;  font-weight: bold;&#10;  transition: all 0.3s;&#10;}&#10;&#10;.password-digit:focus {&#10;  outline: none;&#10;  border-color: #667eea;&#10;  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);&#10;}&#10;&#10;.password-tip {&#10;  text-align: center;&#10;  font-size: 13px;&#10;  color: #999;&#10;}&#10;&#10;.dialog-actions {&#10;  display: flex;&#10;  gap: 12px;&#10;  padding: 16px 24px;&#10;  border-top: 1px solid #eee;&#10;}&#10;&#10;.dialog-actions .btn {&#10;  flex: 1;&#10;  padding: 12px;&#10;}&#10;&#10;.btn-confirm {&#10;  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;  color: white;&#10;}&#10;&#10;.btn-confirm:disabled {&#10;  opacity: 0.6;&#10;  cursor: not-allowed;&#10;}&#10;&lt;/style&gt;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/frontend/src/views/ProductDetail.vue">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/frontend/src/views/ProductDetail.vue" />
              <option name="originalContent" value="&lt;template&gt;&#10;  &lt;div v-if=&quot;product&quot; class=&quot;product-detail-container&quot;&gt;&#10;    &lt;div class=&quot;product-header&quot;&gt;&#10;      &lt;div class=&quot;media-carousel-container&quot;&gt;&#10;        &lt;!-- 主展示区域 --&gt;&#10;        &lt;div class=&quot;main-media-display&quot;&gt;&#10;          &lt;div v-if=&quot;product.media &amp;&amp; product.media.length &gt; 0&quot; class=&quot;carousel-wrapper&quot;&gt;&#10;            &lt;!-- 左右切换按钮 --&gt;&#10;            &lt;button&#10;              v-if=&quot;product.media.length &gt; 1&quot;&#10;              @click=&quot;previousMedia&quot;&#10;              class=&quot;nav-button nav-button-left&quot;&#10;              :disabled=&quot;currentMediaIndex === 0&quot;&gt;&#10;              &amp;#8249;&#10;            &lt;/button&gt;&#10;            &lt;button&#10;              v-if=&quot;product.media.length &gt; 1&quot;&#10;              @click=&quot;nextMedia&quot;&#10;              class=&quot;nav-button nav-button-right&quot;&#10;              :disabled=&quot;currentMediaIndex === product.media.length - 1&quot;&gt;&#10;              &amp;#8250;&#10;            &lt;/button&gt;&#10;&#10;            &lt;!-- 当前媒体展示 --&gt;&#10;            &lt;div class=&quot;current-media&quot;&gt;&#10;              &lt;img&#10;                v-if=&quot;currentMedia &amp;&amp; currentMedia.mediaType === 1&quot;&#10;                :src=&quot;currentMedia.url&quot;&#10;                :alt=&quot;product.name&quot;&#10;                class=&quot;main-image&quot; /&gt;&#10;              &lt;video&#10;                v-if=&quot;currentMedia &amp;&amp; currentMedia.mediaType === 2&quot;&#10;                :src=&quot;currentMedia.url&quot;&#10;                controls&#10;                class=&quot;main-video&quot;&gt;&#10;                您的浏览器不支持视频播放&#10;              &lt;/video&gt;&#10;            &lt;/div&gt;&#10;&#10;            &lt;!-- 媒体计数器 --&gt;&#10;            &lt;div v-if=&quot;product.media.length &gt; 1&quot; class=&quot;media-counter&quot;&gt;&#10;              {{ currentMediaIndex + 1 }} / {{ product.media.length }}&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;&#10;          &lt;!-- 无媒体时的占位符 --&gt;&#10;          &lt;div v-else class=&quot;no-media-placeholder&quot;&gt;&#10;            &lt;div class=&quot;placeholder-icon&quot;&gt;&lt;/div&gt;&#10;            &lt;p&gt;暂无图片&lt;/p&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- 缩略图导航 --&gt;&#10;        &lt;div v-if=&quot;product.media &amp;&amp; product.media.length &gt; 1&quot; class=&quot;thumbnail-nav&quot;&gt;&#10;          &lt;div class=&quot;thumbnail-list&quot;&gt;&#10;            &lt;div&#10;              v-for=&quot;(media, index) in product.media&quot;&#10;              :key=&quot;media.id&quot;&#10;              @click=&quot;selectMedia(index)&quot;&#10;              :class=&quot;['thumbnail-item', { active: index === currentMediaIndex }]&quot;&gt;&#10;              &lt;img&#10;                v-if=&quot;media.mediaType === 1&quot;&#10;                :src=&quot;media.url&quot;&#10;                :alt=&quot;`缩略图 ${index + 1}`&quot;&#10;                class=&quot;thumbnail-image&quot; /&gt;&#10;              &lt;div v-if=&quot;media.mediaType === 2&quot; class=&quot;thumbnail-video&quot;&gt;&#10;                &lt;video :src=&quot;media.url&quot; class=&quot;thumbnail-video-preview&quot;&gt;&lt;/video&gt;&#10;                &lt;div class=&quot;video-play-icon&quot;&gt;▶&lt;/div&gt;&#10;              &lt;/div&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 商品信息 --&gt;&#10;      &lt;div class=&quot;product-info&quot;&gt;&#10;        &lt;h1 class=&quot;product-title&quot;&gt;{{ product.name }}&lt;/h1&gt;&#10;        &lt;div class=&quot;product-price&quot;&gt;¥{{ product.price }}&lt;/div&gt;&#10;        &lt;div class=&quot;product-meta&quot;&gt;&#10;          &lt;div class=&quot;meta-item&quot; v-if=&quot;product.category&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;分类：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ getCategoryLabel(product.category) }}&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;成色：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ product.conditionLevel }}/10&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&lt;span class=&quot;meta-label&quot;&gt;库存：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot; :class=&quot;{ 'low-stock': product.stock &lt; 5 }&quot;&gt;&#10;              剩余{{ product.stock }}件&#10;            &lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;位置：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ product.location || '未设置' }}&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;状态：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value status-available&quot;&gt;在售&lt;/span&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;product-description&quot;&gt;&#10;          &lt;h3&gt;商品描述&lt;/h3&gt;&#10;          &lt;p&gt;{{ product.description || '暂无描述' }}&lt;/p&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- 操作按钮 --&gt;&#10;        &lt;div class=&quot;action-buttons&quot;&gt;&#10;          &lt;button class=&quot;btn btn-home&quot; @click=&quot;goHome&quot;&gt; 返回主页&lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-primary btn-chat&quot;&#10;            @click=&quot;contactSeller&quot;&#10;            v-if=&quot;!isOwnProduct&quot;&gt;&#10;             联系卖家&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-warning btn-report&quot;&#10;            @click=&quot;openReportModal&quot;&#10;            v-if=&quot;!isOwnProduct&quot;&gt;&#10;             举报&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-secondary btn-favorite&quot;&#10;            @click=&quot;toggleFavorite&quot;&#10;            :class=&quot;{ 'is-favorite': isFavorite }&quot;&gt;&#10;            {{ isFavorite ? '❤️ 已收藏' : ' 收藏' }}&#10;          &lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-success btn-cart&quot; @click=&quot;addToCart&quot; v-if=&quot;!isOwnProduct&quot;&gt;&#10;             加入购物车&#10;          &lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-primary btn-buy&quot; @click=&quot;buyNow&quot; v-if=&quot;!isOwnProduct&quot;&gt;&#10;             立即购买&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            v-if=&quot;authStore.user?.role === 'ROLE_ADMIN'&quot;&#10;            class=&quot;btn btn-danger btn-delete&quot;&#10;            @click=&quot;deleteProduct&quot;&gt;&#10;            ️ 删除商品&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- 相似商品推荐 --&gt;&#10;    &lt;RecommendationSection&#10;      v-if=&quot;similarProducts.length &gt; 0&quot;&#10;      title=&quot; 看了又看&quot;&#10;      subtitle=&quot;其他用户也浏览过这些商品&quot;&#10;      :products=&quot;similarProducts&quot;&#10;    /&gt;&#10;&#10;    &lt;ReportModal&#10;      v-if=&quot;showReportModal&quot;&#10;      :product-id=&quot;product.id&quot;&#10;      @close=&quot;showReportModal = false&quot;&#10;    /&gt;&#10;  &lt;/div&gt;&#10;  &lt;div v-else class=&quot;loading-container&quot;&gt;&#10;    &lt;div class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;&#10;    &lt;p&gt;加载中...&lt;/p&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted, onUnmounted } from 'vue';&#10;import { useRoute, useRouter } from 'vue-router';&#10;import { getCategoryLabel } from '@/utils/categoryData';&#10;import { useAuthStore } from '@/store/auth';&#10;import productService from '@/api/productService';&#10;import axios from 'axios';&#10;import { toast } from '@/services/toast';&#10;import RecommendationSection from '@/components/RecommendationSection.vue';&#10;&#10;import ReportModal from '@/components/ReportModal.vue';&#10;&#10;const route = useRoute();&#10;const router = useRouter();&#10;const authStore = useAuthStore();&#10;const product = ref(null);&#10;const currentMediaIndex = ref(0);&#10;const similarProducts = ref([]);&#10;const isFavorite = ref(false);&#10;const showReportModal = ref(false);&#10;&#10;const openReportModal = () =&gt; {&#10;  showReportModal.value = true;&#10;};&#10;&#10;// Check if current user owns this product&#10;const isOwnProduct = computed(() =&gt; {&#10;  if (!authStore.user || !product.value) return false;&#10;  return authStore.user.id === product.value.userId;&#10;});&#10;&#10;const currentMedia = computed(() =&gt; {&#10;  if (!product.value?.media || product.value.media.length === 0) return null;&#10;  return product.value.media[currentMediaIndex.value];&#10;});&#10;&#10;// 切换到下一个媒体&#10;const nextMedia = () =&gt; {&#10;  if (product.value?.media &amp;&amp; currentMediaIndex.value &lt; product.value.media.length - 1) {&#10;    currentMediaIndex.value++;&#10;  }&#10;};&#10;&#10;// 切换到上一个媒体&#10;const previousMedia = () =&gt; {&#10;  if (currentMediaIndex.value &gt; 0) {&#10;    currentMediaIndex.value--;&#10;  }&#10;};&#10;&#10;// 选择特定媒体&#10;const selectMedia = (index) =&gt; {&#10;  currentMediaIndex.value = index;&#10;};&#10;&#10;// 键盘导航支持&#10;const handleKeydown = (event) =&gt; {&#10;  if (event.key === 'ArrowLeft') {&#10;    previousMedia();&#10;  } else if (event.key === 'ArrowRight') {&#10;    nextMedia();&#10;  }&#10;};&#10;&#10;const fetchProduct = async () =&gt; {&#10;  try {&#10;    const response = await productService.getProductById(route.params.id);&#10;    product.value = response.data;&#10;    currentMediaIndex.value = 0; // 重置媒体索引&#10;&#10;    // 检查是否已收藏&#10;    await checkFavoriteStatus();&#10;  } catch (error) {&#10;    console.error('获取商品详情失败:', error);&#10;  }&#10;};&#10;&#10;// 检查收藏状态&#10;const checkFavoriteStatus = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/favorites/check/${route.params.id}`);&#10;    isFavorite.value = response.data.isFavorite;&#10;  } catch (error) {&#10;    console.error('检查收藏状态失败:', error);&#10;  }&#10;};&#10;&#10;// 联系卖家&#10;const contactSeller = () =&gt; {&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能联系自己', 'warning');&#10;    return;&#10;  }&#10;&#10;  // 触发全局事件来打开聊天气泡&#10;  window.dispatchEvent(new CustomEvent('open-chat', {&#10;    detail: {&#10;      username: product.value.username,&#10;      displayName: product.value.displayName || product.value.username,&#10;      userId: product.value.userId,&#10;      avatarUrl: product.value.avatarUrl || null&#10;    }&#10;  }));&#10;};&#10;&#10;// 切换收藏状态&#10;const toggleFavorite = async () =&gt; {&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能收藏自己的商品', 'warning');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    if (isFavorite.value) {&#10;      // 取消收藏&#10;      await axios.delete(`/api/favorites/remove/${route.params.id}`);&#10;      isFavorite.value = false;&#10;      toast('已取消收藏', 'info');&#10;    } else {&#10;      // 添加收藏&#10;      await axios.post(`/api/favorites/add/${route.params.id}`);&#10;      isFavorite.value = true;&#10;      toast('收藏成功', 'success');&#10;    }&#10;  } catch (error) {&#10;    console.error('收藏操作失败:', error);&#10;    toast('操作失败，请重试', 'error');&#10;  }&#10;&#10;};&#10;&#10;// 加入购物车&#10;const addToCart = async () =&gt; {&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能将自己的商品加入购物车', 'warning');&#10;    return;&#10;  }&#10;&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.post('/api/cart/add', {&#10;      productId: route.params.id,&#10;      quantity: 1&#10;    });&#10;    toast('已加入购物车', 'success');&#10;  } catch (error) {&#10;    console.error('加入购物车失败:', error);&#10;    toast('加入购物车失败，请重试', 'error');&#10;  }&#10;};&#10;&#10;// 立即购买&#10;const buyNow = async () =&gt; {&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能购买自己的商品', 'warning');&#10;    return;&#10;  }&#10;&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查库存&#10;  if (!product.value || product.value.stock &lt; 1) {&#10;    toast('商品库存不足', 'warning');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    // 创建订单（直接购买单个商品）&#10;    const response = await axios.post('/api/orders/buy-now', {&#10;      productId: route.params.id,&#10;      quantity: 1&#10;    });&#10;&#10;    const order = response.data;&#10;    toast('订单创建成功', 'success');&#10;&#10;    // 跳转到支付页面（使用路径参数）&#10;    router.push(`/payment/${order.id}`);&#10;  } catch (error) {&#10;    console.error('创建订单失败:', error);&#10;    if (error.response?.data?.message) {&#10;      toast(error.response.data.message, 'error');&#10;    } else {&#10;      toast('创建订单失败，请重试', 'error');&#10;    }&#10;  }&#10;};&#10;&#10;// 删除商品&#10;const deleteProduct = async () =&gt; {&#10;  if (!confirm('确定要删除这个商品吗？此操作不可恢复。')) {&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.delete(`/api/products/${route.params.id}`);&#10;    toast('商品删除成功', 'success');&#10;    router.push({ name: 'home' }); // 删除后返回主页&#10;  } catch (error) {&#10;    console.error('删除商品失败:', error);&#10;    toast('删除商品失败，请重试', 'error');&#10;  }&#10;};&#10;&#10;// 返回主页&#10;const goHome = () =&gt; {&#10;  router.push({ name: 'home' });&#10;};&#10;&#10;// Track product view for recommendation system&#10;const trackProductView = async () =&gt; {&#10;  try {&#10;    // Send view tracking request (non-blocking, don't wait for response)&#10;    axios.post('/api/history/view', {&#10;      productId: route.params.id&#10;    }).catch(err =&gt; {&#10;      // Silent fail - tracking shouldn't affect user experience&#10;      console.debug('View tracking failed:', err);&#10;    });&#10;  } catch (error) {&#10;    // Silent fail&#10;  }&#10;};&#10;&#10;// Fetch similar products based on collaborative filtering&#10;const fetchSimilarProducts = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/recommendations/products/${route.params.id}/similar`, {&#10;      params: { limit: 8 }&#10;    });&#10;    similarProducts.value = response.data;&#10;  } catch (error) {&#10;    console.debug('Failed to fetch similar products:', error);&#10;    // Silent fail - recommendations are optional&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  fetchProduct();&#10;  // Track product view for recommendation system&#10;  trackProductView();&#10;  // Fetch similar products&#10;  fetchSimilarProducts();&#10;  // 添加键盘事件监听&#10;  window.addEventListener('keydown', handleKeydown);&#10;});&#10;&#10;&#10;// 清理事件监听器&#10;onUnmounted(() =&gt; {&#10;  window.removeEventListener('keydown', handleKeydown);&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.product-detail-container {&#10;  max-width: 1200px;&#10;  margin: 0 auto;&#10;  padding: 20px;&#10;  background: #fff;&#10;}&#10;&#10;.product-header {&#10;  display: flex;&#10;  gap: 40px;&#10;  margin-bottom: 40px;&#10;}&#10;&#10;/* 媒体轮播容器 */&#10;.media-carousel-container {&#10;  flex: 1;&#10;  max-width: 600px;&#10;}&#10;&#10;.main-media-display {&#10;  position: relative;&#10;  background: #f8f9fa;&#10;  border-radius: 8px;&#10;  overflow: hidden;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;.carousel-wrapper {&#10;  position: relative;&#10;  width: 100%;&#10;  height: 400px;&#10;}&#10;&#10;.current-media {&#10;  width: 100%;&#10;  height: 100%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;.main-image,&#10;.main-video {&#10;  max-width: 100%;&#10;  max-height: 100%;&#10;  object-fit: contain;&#10;}&#10;&#10;/* 导航按钮 */&#10;.nav-button {&#10;  position: absolute;&#10;  top: 50%;&#10;  transform: translateY(-50%);&#10;  background: rgba(0, 0, 0, 0.6);&#10;  color: white;&#10;  border: none;&#10;  width: 50px;&#10;  height: 50px;&#10;  border-radius: 50%;&#10;  font-size: 24px;&#10;  cursor: pointer;&#10;  z-index: 2;&#10;  transition: all 0.3s ease;&#10;}&#10;&#10;.nav-button:hover:not(:disabled) {&#10;  background: rgba(0, 0, 0, 0.8);&#10;  transform: translateY(-50%) scale(1.1);&#10;}&#10;&#10;.nav-button:disabled {&#10;  opacity: 0.3;&#10;  cursor: not-allowed;&#10;}&#10;&#10;.nav-button-left {&#10;  left: 15px;&#10;}&#10;&#10;.nav-button-right {&#10;  right: 15px;&#10;}&#10;&#10;/* 媒体计数器 */&#10;.media-counter {&#10;  position: absolute;&#10;  bottom: 15px;&#10;  right: 15px;&#10;  background: rgba(0, 0, 0, 0.7);&#10;  color: white;&#10;  padding: 5px 12px;&#10;  border-radius: 15px;&#10;  font-size: 14px;&#10;}&#10;&#10;/* 无媒体占位符 */&#10;.no-media-placeholder {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  height: 400px;&#10;  color: #6c757d;&#10;}&#10;&#10;.placeholder-icon {&#10;  font-size: 48px;&#10;  margin-bottom: 10px;&#10;  opacity: 0.5;&#10;}&#10;&#10;/* 缩略图导航 */&#10;.thumbnail-nav {&#10;  overflow-x: auto;&#10;  padding: 10px 0;&#10;}&#10;&#10;.thumbnail-list {&#10;  display: flex;&#10;  gap: 10px;&#10;  min-width: min-content;&#10;}&#10;&#10;.thumbnail-item {&#10;  width: 80px;&#10;  height: 80px;&#10;  border: 2px solid transparent;&#10;  border-radius: 6px;&#10;  overflow: hidden;&#10;  cursor: pointer;&#10;  transition: all 0.3s ease;&#10;  position: relative;&#10;}&#10;&#10;.thumbnail-item:hover {&#10;  border-color: #007bff;&#10;  transform: scale(1.05);&#10;}&#10;&#10;.thumbnail-item.active {&#10;  border-color: #007bff;&#10;  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);&#10;}&#10;&#10;.thumbnail-image,&#10;.thumbnail-video-preview {&#10;  width: 100%;&#10;  height: 100%;&#10;  object-fit: cover;&#10;}&#10;&#10;.thumbnail-video {&#10;  position: relative;&#10;  width: 100%;&#10;  height: 100%;&#10;}&#10;&#10;.video-play-icon {&#10;  position: absolute;&#10;  top: 50%;&#10;  left: 50%;&#10;  transform: translate(-50%, -50%);&#10;  color: white;&#10;  font-size: 16px;&#10;  background: rgba(0, 0, 0, 0.6);&#10;  width: 24px;&#10;  height: 24px;&#10;  border-radius: 50%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;/* 商品信息部分 */&#10;.product-info {&#10;  flex: 1;&#10;  min-width: 400px;&#10;}&#10;&#10;.product-title {&#10;  font-size: 28px;&#10;  font-weight: 600;&#10;  color: #212529;&#10;  margin-bottom: 15px;&#10;  line-height: 1.3;&#10;}&#10;&#10;.product-price {&#10;  font-size: 32px;&#10;  font-weight: bold;&#10;  color: #e74c3c;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.product-meta {&#10;  margin-bottom: 25px;&#10;}&#10;&#10;.meta-item {&#10;  display: flex;&#10;  margin-bottom: 8px;&#10;  flex-wrap: wrap;&#10;}&#10;&#10;.meta-label {&#10;  font-weight: 500;&#10;  color: #6c757d;&#10;  min-width: 60px;&#10;}&#10;.meta-value {&#10;  color: #212529;&#10;}&#10;&#10;.status-available {&#10;  color: #28a745;&#10;}&#10;&#10;.btn-home {&#10;  background: #6c757d;&#10;  color: white;&#10;}&#10;&#10;.btn-home:hover {&#10;  background: #5a6268;&#10;}&#10;&#10;.product-description h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 10px;&#10;  color: #212529;&#10;}&#10;&#10;.product-description p {&#10;  color: #6c757d;&#10;  line-height: 1.6;&#10;}&#10;&#10;/* 操作按钮 */&#10;.action-buttons {&#10;  display: flex;&#10;  gap: 15px;&#10;  flex-wrap: wrap;&#10;}&#10;&#10;.btn {&#10;  padding: 12px 30px;&#10;  border: none;&#10;  border-radius: 6px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s ease;&#10;}&#10;&#10;.btn-primary {&#10;  background: #007bff;&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover {&#10;  background: #0056b3;&#10;}&#10;&#10;.btn-secondary {&#10;  background: #6c757d;&#10;  color: white;&#10;}&#10;&#10;.btn-secondary:hover {&#10;  background: #545b62;&#10;}&#10;&#10;.btn-secondary.is-favorite {&#10;  background: #dc3545;&#10;}&#10;&#10;.btn-secondary.is-favorite:hover {&#10;  background: #c82333;&#10;}&#10;&#10;.btn-success {&#10;  background: #28a745;&#10;  color: white;&#10;}&#10;&#10;.btn-success:hover {&#10;  background: #218838;&#10;}&#10;&#10;/* 加载状态 */&#10;.loading-container {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  height: 400px;&#10;}&#10;&#10;.loading-spinner {&#10;  width: 40px;&#10;  height: 40px;&#10;  border: 4px solid #f3f3f3;&#10;  border-top: 4px solid #007bff;&#10;  border-radius: 50%;&#10;  animation: spin 1s linear infinite;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;@keyframes spin {&#10;  0% { transform: rotate(0deg); }&#10;  100% { transform: rotate(360deg); }&#10;}&#10;&#10;/* 响应式设计 */&#10;@media (max-width: 768px) {&#10;  .product-header {&#10;    flex-direction: column;&#10;    gap: 20px;&#10;  }&#10;&#10;  .media-carousel-container {&#10;    max-width: 100%;&#10;  }&#10;&#10;  .product-info {&#10;    min-width: auto;&#10;  }&#10;&#10;  .action-buttons {&#10;    flex-direction: column;&#10;  }&#10;&#10;  .nav-button {&#10;    width: 40px;&#10;    height: 40px;&#10;    font-size: 20px;&#10;  }&#10;&#10;  .nav-button-left {&#10;    left: 10px;&#10;  }&#10;&#10;  .nav-button-right {&#10;    right: 10px;&#10;  }&#10;}&#10;&#10;.low-stock {&#10;  color: #ff4444;&#10;  font-weight: bold;&#10;}&#10;&lt;/style&gt;&#10;" />
              <option name="updatedContent" value="&lt;template&gt;&#10;  &lt;div v-if=&quot;product&quot; class=&quot;product-detail-container&quot;&gt;&#10;    &lt;div class=&quot;product-header&quot;&gt;&#10;      &lt;div class=&quot;media-carousel-container&quot;&gt;&#10;        &lt;!-- 主展示区域 --&gt;&#10;        &lt;div class=&quot;main-media-display&quot;&gt;&#10;          &lt;div v-if=&quot;product.media &amp;&amp; product.media.length &gt; 0&quot; class=&quot;carousel-wrapper&quot;&gt;&#10;            &lt;!-- 左右切换按钮 --&gt;&#10;            &lt;button&#10;              v-if=&quot;product.media.length &gt; 1&quot;&#10;              @click=&quot;previousMedia&quot;&#10;              class=&quot;nav-button nav-button-left&quot;&#10;              :disabled=&quot;currentMediaIndex === 0&quot;&gt;&#10;              &amp;#8249;&#10;            &lt;/button&gt;&#10;            &lt;button&#10;              v-if=&quot;product.media.length &gt; 1&quot;&#10;              @click=&quot;nextMedia&quot;&#10;              class=&quot;nav-button nav-button-right&quot;&#10;              :disabled=&quot;currentMediaIndex === product.media.length - 1&quot;&gt;&#10;              &amp;#8250;&#10;            &lt;/button&gt;&#10;&#10;            &lt;!-- 当前媒体展示 --&gt;&#10;            &lt;div class=&quot;current-media&quot;&gt;&#10;              &lt;img&#10;                v-if=&quot;currentMedia &amp;&amp; currentMedia.mediaType === 1&quot;&#10;                :src=&quot;currentMedia.url&quot;&#10;                :alt=&quot;product.name&quot;&#10;                class=&quot;main-image&quot; /&gt;&#10;              &lt;video&#10;                v-if=&quot;currentMedia &amp;&amp; currentMedia.mediaType === 2&quot;&#10;                :src=&quot;currentMedia.url&quot;&#10;                controls&#10;                class=&quot;main-video&quot;&gt;&#10;                您的浏览器不支持视频播放&#10;              &lt;/video&gt;&#10;            &lt;/div&gt;&#10;&#10;            &lt;!-- 媒体计数器 --&gt;&#10;            &lt;div v-if=&quot;product.media.length &gt; 1&quot; class=&quot;media-counter&quot;&gt;&#10;              {{ currentMediaIndex + 1 }} / {{ product.media.length }}&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;&#10;          &lt;!-- 无媒体时的占位符 --&gt;&#10;          &lt;div v-else class=&quot;no-media-placeholder&quot;&gt;&#10;            &lt;div class=&quot;placeholder-icon&quot;&gt;&lt;/div&gt;&#10;            &lt;p&gt;暂无图片&lt;/p&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- 缩略图导航 --&gt;&#10;        &lt;div v-if=&quot;product.media &amp;&amp; product.media.length &gt; 1&quot; class=&quot;thumbnail-nav&quot;&gt;&#10;          &lt;div class=&quot;thumbnail-list&quot;&gt;&#10;            &lt;div&#10;              v-for=&quot;(media, index) in product.media&quot;&#10;              :key=&quot;media.id&quot;&#10;              @click=&quot;selectMedia(index)&quot;&#10;              :class=&quot;['thumbnail-item', { active: index === currentMediaIndex }]&quot;&gt;&#10;              &lt;img&#10;                v-if=&quot;media.mediaType === 1&quot;&#10;                :src=&quot;media.url&quot;&#10;                :alt=&quot;`缩略图 ${index + 1}`&quot;&#10;                class=&quot;thumbnail-image&quot; /&gt;&#10;              &lt;div v-if=&quot;media.mediaType === 2&quot; class=&quot;thumbnail-video&quot;&gt;&#10;                &lt;video :src=&quot;media.url&quot; class=&quot;thumbnail-video-preview&quot;&gt;&lt;/video&gt;&#10;                &lt;div class=&quot;video-play-icon&quot;&gt;▶&lt;/div&gt;&#10;              &lt;/div&gt;&#10;            &lt;/div&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      &lt;!-- 商品信息 --&gt;&#10;      &lt;div class=&quot;product-info&quot;&gt;&#10;        &lt;h1 class=&quot;product-title&quot;&gt;{{ product.name }}&lt;/h1&gt;&#10;        &lt;div class=&quot;product-price&quot;&gt;¥{{ product.price }}&lt;/div&gt;&#10;        &lt;div class=&quot;product-meta&quot;&gt;&#10;          &lt;div class=&quot;meta-item&quot; v-if=&quot;product.category&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;分类：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ getCategoryLabel(product.category) }}&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;成色：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ product.conditionLevel }}/10&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&lt;span class=&quot;meta-label&quot;&gt;库存：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot; :class=&quot;{ 'low-stock': product.stock &lt; 5 }&quot;&gt;&#10;              剩余{{ product.stock }}件&#10;            &lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;位置：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value&quot;&gt;{{ product.location || '未设置' }}&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div class=&quot;meta-item&quot;&gt;&#10;            &lt;span class=&quot;meta-label&quot;&gt;状态：&lt;/span&gt;&#10;            &lt;span class=&quot;meta-value status-available&quot;&gt;在售&lt;/span&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;        &lt;div class=&quot;product-description&quot;&gt;&#10;          &lt;h3&gt;商品描述&lt;/h3&gt;&#10;          &lt;p&gt;{{ product.description || '暂无描述' }}&lt;/p&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;!-- 操作按钮 --&gt;&#10;        &lt;div class=&quot;action-buttons&quot;&gt;&#10;          &lt;button class=&quot;btn btn-home&quot; @click=&quot;goHome&quot;&gt; 返回主页&lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-primary btn-chat&quot;&#10;            @click=&quot;contactSeller&quot;&#10;            v-if=&quot;!isOwnProduct&quot;&gt;&#10;             联系卖家&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-warning btn-report&quot;&#10;            @click=&quot;openReportModal&quot;&#10;            v-if=&quot;!isOwnProduct&quot;&gt;&#10;             举报&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            class=&quot;btn btn-secondary btn-favorite&quot;&#10;            @click=&quot;toggleFavorite&quot;&#10;            :class=&quot;{ 'is-favorite': isFavorite }&quot;&gt;&#10;            {{ isFavorite ? '❤️ 已收藏' : ' 收藏' }}&#10;          &lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-success btn-cart&quot; @click=&quot;addToCart&quot; v-if=&quot;!isOwnProduct&quot;&gt;&#10;             加入购物车&#10;          &lt;/button&gt;&#10;          &lt;button class=&quot;btn btn-primary btn-buy&quot; @click=&quot;buyNow&quot; v-if=&quot;!isOwnProduct&quot;&gt;&#10;             立即购买&#10;          &lt;/button&gt;&#10;          &lt;button&#10;            v-if=&quot;authStore.user?.role === 'ROLE_ADMIN'&quot;&#10;            class=&quot;btn btn-danger btn-delete&quot;&#10;            @click=&quot;deleteProduct&quot;&gt;&#10;            ️ 删除商品&#10;          &lt;/button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/div&gt;&#10;&#10;    &lt;!-- 相似商品推荐 --&gt;&#10;    &lt;RecommendationSection&#10;      v-if=&quot;similarProducts.length &gt; 0&quot;&#10;      title=&quot; 看了又看&quot;&#10;      subtitle=&quot;其他用户也浏览过这些商品&quot;&#10;      :products=&quot;similarProducts&quot;&#10;    /&gt;&#10;&#10;    &lt;ReportModal&#10;      v-if=&quot;showReportModal&quot;&#10;      :product-id=&quot;product.id&quot;&#10;      @close=&quot;showReportModal = false&quot;&#10;    /&gt;&#10;  &lt;/div&gt;&#10;  &lt;div v-else class=&quot;loading-container&quot;&gt;&#10;    &lt;div class=&quot;loading-spinner&quot;&gt;&lt;/div&gt;&#10;    &lt;p&gt;加载中...&lt;/p&gt;&#10;  &lt;/div&gt;&#10;&lt;/template&gt;&#10;&#10;&lt;script setup&gt;&#10;import { ref, computed, onMounted, onUnmounted } from 'vue';&#10;import { useRoute, useRouter } from 'vue-router';&#10;import { getCategoryLabel } from '@/utils/categoryData';&#10;import { useAuthStore } from '@/store/auth';&#10;import productService from '@/api/productService';&#10;import axios from 'axios';&#10;import { toast } from '@/services/toast';&#10;import RecommendationSection from '@/components/RecommendationSection.vue';&#10;&#10;import ReportModal from '@/components/ReportModal.vue';&#10;&#10;const route = useRoute();&#10;const router = useRouter();&#10;const authStore = useAuthStore();&#10;const product = ref(null);&#10;const currentMediaIndex = ref(0);&#10;const similarProducts = ref([]);&#10;const isFavorite = ref(false);&#10;const showReportModal = ref(false);&#10;&#10;const openReportModal = () =&gt; {&#10;  showReportModal.value = true;&#10;};&#10;&#10;// Check if current user owns this product&#10;const isOwnProduct = computed(() =&gt; {&#10;  if (!authStore.user || !product.value) return false;&#10;  return authStore.user.id === product.value.userId;&#10;});&#10;&#10;const currentMedia = computed(() =&gt; {&#10;  if (!product.value?.media || product.value.media.length === 0) return null;&#10;  return product.value.media[currentMediaIndex.value];&#10;});&#10;&#10;// 切换到下一个媒体&#10;const nextMedia = () =&gt; {&#10;  if (product.value?.media &amp;&amp; currentMediaIndex.value &lt; product.value.media.length - 1) {&#10;    currentMediaIndex.value++;&#10;  }&#10;};&#10;&#10;// 切换到上一个媒体&#10;const previousMedia = () =&gt; {&#10;  if (currentMediaIndex.value &gt; 0) {&#10;    currentMediaIndex.value--;&#10;  }&#10;};&#10;&#10;// 选择特定媒体&#10;const selectMedia = (index) =&gt; {&#10;  currentMediaIndex.value = index;&#10;};&#10;&#10;// 键盘导航支持&#10;const handleKeydown = (event) =&gt; {&#10;  if (event.key === 'ArrowLeft') {&#10;    previousMedia();&#10;  } else if (event.key === 'ArrowRight') {&#10;    nextMedia();&#10;  }&#10;};&#10;&#10;const fetchProduct = async () =&gt; {&#10;  try {&#10;    const response = await productService.getProductById(route.params.id);&#10;    product.value = response.data;&#10;    currentMediaIndex.value = 0; // 重置媒体索引&#10;&#10;    // 检查是否已收藏&#10;    await checkFavoriteStatus();&#10;  } catch (error) {&#10;    console.error('获取商品详情失败:', error);&#10;  }&#10;};&#10;&#10;// 检查收藏状态&#10;const checkFavoriteStatus = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/favorites/check/${route.params.id}`);&#10;    isFavorite.value = response.data.isFavorite;&#10;  } catch (error) {&#10;    console.error('检查收藏状态失败:', error);&#10;  }&#10;};&#10;&#10;// 联系卖家&#10;const contactSeller = () =&gt; {&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能联系自己', 'warning');&#10;    return;&#10;  }&#10;&#10;  // 触发全局事件来打开聊天气泡&#10;  window.dispatchEvent(new CustomEvent('open-chat', {&#10;    detail: {&#10;      username: product.value.username,&#10;      displayName: product.value.displayName || product.value.username,&#10;      userId: product.value.userId,&#10;      avatarUrl: product.value.avatarUrl || null&#10;    }&#10;  }));&#10;};&#10;&#10;// 切换收藏状态&#10;const toggleFavorite = async () =&gt; {&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能收藏自己的商品', 'warning');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    if (isFavorite.value) {&#10;      // 取消收藏&#10;      await axios.delete(`/api/favorites/remove/${route.params.id}`);&#10;      isFavorite.value = false;&#10;      toast('已取消收藏', 'info');&#10;    } else {&#10;      // 添加收藏&#10;      await axios.post(`/api/favorites/add/${route.params.id}`);&#10;      isFavorite.value = true;&#10;      toast('收藏成功', 'success');&#10;    }&#10;  } catch (error) {&#10;    console.error('收藏操作失败:', error);&#10;    toast('操作失败，请重试', 'error');&#10;  }&#10;&#10;};&#10;&#10;// 加入购物车&#10;const addToCart = async () =&gt; {&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能将自己的商品加入购物车', 'warning');&#10;    return;&#10;  }&#10;&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.post('/api/cart/add', {&#10;      productId: route.params.id,&#10;      quantity: 1&#10;    });&#10;    toast('已加入购物车', 'success');&#10;  } catch (error) {&#10;    console.error('加入购物车失败:', error);&#10;    toast('加入购物车失败，请重试', 'error');&#10;  }&#10;};&#10;&#10;// 立即购买&#10;const buyNow = async () =&gt; {&#10;  // 检查是否是自己的商品&#10;  if (isOwnProduct.value) {&#10;    toast('不能购买自己的商品', 'warning');&#10;    return;&#10;  }&#10;&#10;  if (!authStore.isLoggedIn) {&#10;    toast('请先登录', 'warning');&#10;    router.push('/login');&#10;    return;&#10;  }&#10;&#10;  // 检查库存&#10;  if (!product.value || product.value.stock &lt; 1) {&#10;    toast('商品库存不足', 'warning');&#10;    return;&#10;  }&#10;&#10;  try {&#10;    // 检查是否有未完成的订单&#10;    const checkResponse = await axios.get('/api/orders/check-pending');&#10;    if (checkResponse.data.hasPendingOrder) {&#10;      const orderId = checkResponse.data.orderId;&#10;      if (confirm('您有未完成的订单，是否前往支付？')) {&#10;        router.push(`/payment/${orderId}`);&#10;      }&#10;      return;&#10;    }&#10;&#10;    // 创建订单（直接购买单个商品）&#10;    const response = await axios.post('/api/orders/buy-now', {&#10;      productId: route.params.id,&#10;      quantity: 1&#10;    });&#10;&#10;    const order = response.data;&#10;    toast('订单创建成功', 'success');&#10;&#10;    // 跳转到支付页面（使用路径参数）&#10;    router.push(`/payment/${order.id}`);&#10;  } catch (error) {&#10;    console.error('创建订单失败:', error);&#10;    if (error.response?.data?.message) {&#10;      toast(error.response.data.message, 'error');&#10;    } else {&#10;      toast('创建订单失败，请重试', 'error');&#10;    }&#10;  }&#10;};&#10;&#10;// 删除商品&#10;const deleteProduct = async () =&gt; {&#10;  if (!confirm('确定要删除这个商品吗？此操作不可恢复。')) {&#10;    return;&#10;  }&#10;&#10;  try {&#10;    await axios.delete(`/api/products/${route.params.id}`);&#10;    toast('商品删除成功', 'success');&#10;    router.push({ name: 'home' }); // 删除后返回主页&#10;  } catch (error) {&#10;    console.error('删除商品失败:', error);&#10;    toast('删除商品失败，请重试', 'error');&#10;  }&#10;};&#10;&#10;// 返回主页&#10;const goHome = () =&gt; {&#10;  router.push({ name: 'home' });&#10;};&#10;&#10;// Track product view for recommendation system&#10;const trackProductView = async () =&gt; {&#10;  try {&#10;    // Send view tracking request (non-blocking, don't wait for response)&#10;    axios.post('/api/history/view', {&#10;      productId: route.params.id&#10;    }).catch(err =&gt; {&#10;      // Silent fail - tracking shouldn't affect user experience&#10;      console.debug('View tracking failed:', err);&#10;    });&#10;  } catch (error) {&#10;    // Silent fail&#10;  }&#10;};&#10;&#10;// Fetch similar products based on collaborative filtering&#10;const fetchSimilarProducts = async () =&gt; {&#10;  try {&#10;    const response = await axios.get(`/api/recommendations/products/${route.params.id}/similar`, {&#10;      params: { limit: 8 }&#10;    });&#10;    similarProducts.value = response.data;&#10;  } catch (error) {&#10;    console.debug('Failed to fetch similar products:', error);&#10;    // Silent fail - recommendations are optional&#10;  }&#10;};&#10;&#10;onMounted(() =&gt; {&#10;  fetchProduct();&#10;  // Track product view for recommendation system&#10;  trackProductView();&#10;  // Fetch similar products&#10;  fetchSimilarProducts();&#10;  // 添加键盘事件监听&#10;  window.addEventListener('keydown', handleKeydown);&#10;});&#10;&#10;&#10;// 清理事件监听器&#10;onUnmounted(() =&gt; {&#10;  window.removeEventListener('keydown', handleKeydown);&#10;});&#10;&lt;/script&gt;&#10;&#10;&lt;style scoped&gt;&#10;.product-detail-container {&#10;  max-width: 1200px;&#10;  margin: 0 auto;&#10;  padding: 20px;&#10;  background: #fff;&#10;}&#10;&#10;.product-header {&#10;  display: flex;&#10;  gap: 40px;&#10;  margin-bottom: 40px;&#10;}&#10;&#10;/* 媒体轮播容器 */&#10;.media-carousel-container {&#10;  flex: 1;&#10;  max-width: 600px;&#10;}&#10;&#10;.main-media-display {&#10;  position: relative;&#10;  background: #f8f9fa;&#10;  border-radius: 8px;&#10;  overflow: hidden;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;.carousel-wrapper {&#10;  position: relative;&#10;  width: 100%;&#10;  height: 400px;&#10;}&#10;&#10;.current-media {&#10;  width: 100%;&#10;  height: 100%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;.main-image,&#10;.main-video {&#10;  max-width: 100%;&#10;  max-height: 100%;&#10;  object-fit: contain;&#10;}&#10;&#10;/* 导航按钮 */&#10;.nav-button {&#10;  position: absolute;&#10;  top: 50%;&#10;  transform: translateY(-50%);&#10;  background: rgba(0, 0, 0, 0.6);&#10;  color: white;&#10;  border: none;&#10;  width: 50px;&#10;  height: 50px;&#10;  border-radius: 50%;&#10;  font-size: 24px;&#10;  cursor: pointer;&#10;  z-index: 2;&#10;  transition: all 0.3s ease;&#10;}&#10;&#10;.nav-button:hover:not(:disabled) {&#10;  background: rgba(0, 0, 0, 0.8);&#10;  transform: translateY(-50%) scale(1.1);&#10;}&#10;&#10;.nav-button:disabled {&#10;  opacity: 0.3;&#10;  cursor: not-allowed;&#10;}&#10;&#10;.nav-button-left {&#10;  left: 15px;&#10;}&#10;&#10;.nav-button-right {&#10;  right: 15px;&#10;}&#10;&#10;/* 媒体计数器 */&#10;.media-counter {&#10;  position: absolute;&#10;  bottom: 15px;&#10;  right: 15px;&#10;  background: rgba(0, 0, 0, 0.7);&#10;  color: white;&#10;  padding: 5px 12px;&#10;  border-radius: 15px;&#10;  font-size: 14px;&#10;}&#10;&#10;/* 无媒体占位符 */&#10;.no-media-placeholder {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  height: 400px;&#10;  color: #6c757d;&#10;}&#10;&#10;.placeholder-icon {&#10;  font-size: 48px;&#10;  margin-bottom: 10px;&#10;  opacity: 0.5;&#10;}&#10;&#10;/* 缩略图导航 */&#10;.thumbnail-nav {&#10;  overflow-x: auto;&#10;  padding: 10px 0;&#10;}&#10;&#10;.thumbnail-list {&#10;  display: flex;&#10;  gap: 10px;&#10;  min-width: min-content;&#10;}&#10;&#10;.thumbnail-item {&#10;  width: 80px;&#10;  height: 80px;&#10;  border: 2px solid transparent;&#10;  border-radius: 6px;&#10;  overflow: hidden;&#10;  cursor: pointer;&#10;  transition: all 0.3s ease;&#10;  position: relative;&#10;}&#10;&#10;.thumbnail-item:hover {&#10;  border-color: #007bff;&#10;  transform: scale(1.05);&#10;}&#10;&#10;.thumbnail-item.active {&#10;  border-color: #007bff;&#10;  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);&#10;}&#10;&#10;.thumbnail-image,&#10;.thumbnail-video-preview {&#10;  width: 100%;&#10;  height: 100%;&#10;  object-fit: cover;&#10;}&#10;&#10;.thumbnail-video {&#10;  position: relative;&#10;  width: 100%;&#10;  height: 100%;&#10;}&#10;&#10;.video-play-icon {&#10;  position: absolute;&#10;  top: 50%;&#10;  left: 50%;&#10;  transform: translate(-50%, -50%);&#10;  color: white;&#10;  font-size: 16px;&#10;  background: rgba(0, 0, 0, 0.6);&#10;  width: 24px;&#10;  height: 24px;&#10;  border-radius: 50%;&#10;  display: flex;&#10;  align-items: center;&#10;  justify-content: center;&#10;}&#10;&#10;/* 商品信息部分 */&#10;.product-info {&#10;  flex: 1;&#10;  min-width: 400px;&#10;}&#10;&#10;.product-title {&#10;  font-size: 28px;&#10;  font-weight: 600;&#10;  color: #212529;&#10;  margin-bottom: 15px;&#10;  line-height: 1.3;&#10;}&#10;&#10;.product-price {&#10;  font-size: 32px;&#10;  font-weight: bold;&#10;  color: #e74c3c;&#10;  margin-bottom: 20px;&#10;}&#10;&#10;.product-meta {&#10;  margin-bottom: 25px;&#10;}&#10;&#10;.meta-item {&#10;  display: flex;&#10;  margin-bottom: 8px;&#10;  flex-wrap: wrap;&#10;}&#10;&#10;.meta-label {&#10;  font-weight: 500;&#10;  color: #6c757d;&#10;  min-width: 60px;&#10;}&#10;.meta-value {&#10;  color: #212529;&#10;}&#10;&#10;.status-available {&#10;  color: #28a745;&#10;}&#10;&#10;.btn-home {&#10;  background: #6c757d;&#10;  color: white;&#10;}&#10;&#10;.btn-home:hover {&#10;  background: #5a6268;&#10;}&#10;&#10;.product-description h3 {&#10;  font-size: 18px;&#10;  margin-bottom: 10px;&#10;  color: #212529;&#10;}&#10;&#10;.product-description p {&#10;  color: #6c757d;&#10;  line-height: 1.6;&#10;}&#10;&#10;/* 操作按钮 */&#10;.action-buttons {&#10;  display: flex;&#10;  gap: 15px;&#10;  flex-wrap: wrap;&#10;}&#10;&#10;.btn {&#10;  padding: 12px 30px;&#10;  border: none;&#10;  border-radius: 6px;&#10;  font-size: 16px;&#10;  font-weight: 500;&#10;  cursor: pointer;&#10;  transition: all 0.3s ease;&#10;}&#10;&#10;.btn-primary {&#10;  background: #007bff;&#10;  color: white;&#10;}&#10;&#10;.btn-primary:hover {&#10;  background: #0056b3;&#10;}&#10;&#10;.btn-secondary {&#10;  background: #6c757d;&#10;  color: white;&#10;}&#10;&#10;.btn-secondary:hover {&#10;  background: #545b62;&#10;}&#10;&#10;.btn-secondary.is-favorite {&#10;  background: #dc3545;&#10;}&#10;&#10;.btn-secondary.is-favorite:hover {&#10;  background: #c82333;&#10;}&#10;&#10;.btn-success {&#10;  background: #28a745;&#10;  color: white;&#10;}&#10;&#10;.btn-success:hover {&#10;  background: #218838;&#10;}&#10;&#10;/* 加载状态 */&#10;.loading-container {&#10;  display: flex;&#10;  flex-direction: column;&#10;  align-items: center;&#10;  justify-content: center;&#10;  height: 400px;&#10;}&#10;&#10;.loading-spinner {&#10;  width: 40px;&#10;  height: 40px;&#10;  border: 4px solid #f3f3f3;&#10;  border-top: 4px solid #007bff;&#10;  border-radius: 50%;&#10;  animation: spin 1s linear infinite;&#10;  margin-bottom: 15px;&#10;}&#10;&#10;@keyframes spin {&#10;  0% { transform: rotate(0deg); }&#10;  100% { transform: rotate(360deg); }&#10;}&#10;&#10;/* 响应式设计 */&#10;@media (max-width: 768px) {&#10;  .product-header {&#10;    flex-direction: column;&#10;    gap: 20px;&#10;  }&#10;&#10;  .media-carousel-container {&#10;    max-width: 100%;&#10;  }&#10;&#10;  .product-info {&#10;    min-width: auto;&#10;  }&#10;&#10;  .action-buttons {&#10;    flex-direction: column;&#10;  }&#10;&#10;  .nav-button {&#10;    width: 40px;&#10;    height: 40px;&#10;    font-size: 20px;&#10;  }&#10;&#10;  .nav-button-left {&#10;    left: 10px;&#10;  }&#10;&#10;  .nav-button-right {&#10;    right: 10px;&#10;  }&#10;}&#10;&#10;.low-stock {&#10;  color: #ff4444;&#10;  font-weight: bold;&#10;}&#10;&lt;/style&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/init.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/init.sql" />
              <option name="originalContent" value="-- =================================================================&#10;-- RebookTrade - Complete Database Initialization Script&#10;-- Version: 2.0&#10;-- Last Updated: 2025-10-21&#10;-- =================================================================&#10;-- This script handles:&#10;-- 1. Database creation with UTF-8mb4 character set.&#10;-- 2. Dropping and recreating all tables for a clean slate.&#10;-- 3. Seeding essential data (roles, admin user).&#10;-- 4. Seeding realistic test data for users and products (books).&#10;-- =================================================================&#10;&#10;-- Set session variables for character encoding&#10;SET NAMES utf8mb4;&#10;SET CHARACTER SET utf8mb4;&#10;&#10;-- Create the database if it doesn't exist, ensuring correct character set&#10;CREATE DATABASE IF NOT EXISTS trade CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;&#10;USE trade;&#10;&#10;-- Disable foreign key checks to allow clean drop&#10;SET FOREIGN_KEY_CHECKS = 0;&#10;&#10;-- Drop tables in reverse order of dependency to avoid foreign key errors&#10;DROP TABLE IF EXISTS `shopping_cart`;&#10;DROP TABLE IF EXISTS `user_favorites`;&#10;DROP TABLE IF EXISTS `pms_product_media`;&#10;DROP TABLE IF EXISTS `pms_report`;&#10;DROP TABLE IF EXISTS `pms_product`;&#10;DROP TABLE IF EXISTS `chat_message`;&#10;DROP TABLE IF EXISTS `user_roles`;&#10;DROP TABLE IF EXISTS `roles`;&#10;DROP TABLE IF EXISTS `users`;&#10;&#10;-- Re-enable foreign key checks&#10;SET FOREIGN_KEY_CHECKS = 1;&#10;&#10;-- =================================================================&#10;-- Table Structure Definitions&#10;-- =================================================================&#10;&#10;-- Table `users`&#10;CREATE TABLE `users` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'User unique ID',&#10;    `username` VARCHAR(50) NOT NULL COMMENT 'Username, unique',&#10;    `display_name` VARCHAR(100) NULL COMMENT 'Display name for the user',&#10;    `password_hash` VARCHAR(255) NOT NULL COMMENT 'BCrypt hashed password',&#10;    `payment_password_hash` VARCHAR(255) NULL COMMENT 'BCrypt hashed payment password (6 digits)',&#10;    `email` VARCHAR(100) NOT NULL COMMENT 'User email, unique',&#10;    `avatar_url` VARCHAR(255) NULL COMMENT 'User avatar URL',&#10;    `balance` DECIMAL(10, 2) NOT NULL DEFAULT 0.00 COMMENT 'User balance',&#10;    `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE INDEX `uk_username` (`username`),&#10;    UNIQUE INDEX `uk_email` (`email`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Users table';&#10;&#10;-- Table `roles`&#10;CREATE TABLE `roles` (&#10;    `id` INT NOT NULL AUTO_INCREMENT COMMENT 'Role unique ID',&#10;    `name` VARCHAR(50) NOT NULL COMMENT 'Role name, unique',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE INDEX `uk_rolename` (`name`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Roles table';&#10;&#10;-- Table `user_roles`&#10;CREATE TABLE `user_roles` (&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `role_id` INT NOT NULL COMMENT 'Role ID',&#10;    PRIMARY KEY (`user_id`, `role_id`),&#10;    INDEX `fk_user_roles_role_id_idx` (`role_id`),&#10;    CONSTRAINT `fk_user_roles_user_id` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_user_roles_role_id` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='User-role association table';&#10;&#10;-- Table `chat_message`&#10;CREATE TABLE `chat_message` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Message unique ID',&#10;    `sender_id` BIGINT NULL COMMENT 'Sender user ID (NULL for system messages)',&#10;    `recipient_id` BIGINT NOT NULL COMMENT 'Recipient user ID',&#10;    `content` TEXT NOT NULL COMMENT 'Message content',&#10;    `timestamp` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Message sent time',&#10;    `is_read` BOOLEAN NOT NULL DEFAULT FALSE COMMENT 'Is the message read',&#10;    `is_system_message` BOOLEAN NOT NULL DEFAULT FALSE COMMENT 'Is it a system message',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_sender_recipient` (`sender_id`, `recipient_id`),&#10;    INDEX `idx_recipient_read` (`recipient_id`, `is_read`),&#10;    CONSTRAINT `fk_chat_message_sender` FOREIGN KEY (`sender_id`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_chat_message_recipient` FOREIGN KEY (`recipient_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Chat messages table';&#10;&#10;-- Table `pms_product`&#10;CREATE TABLE `pms_product` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Product ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'Seller user ID',&#10;    `name` VARCHAR(255) NOT NULL COMMENT 'Product name',&#10;    `description` TEXT NULL COMMENT 'Product description',&#10;    `price` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT 'Price',&#10;    `stock` INT NOT NULL DEFAULT 1 COMMENT 'Stock (default 1 for used items)',&#10;    `condition_level` INT NOT NULL DEFAULT 9 COMMENT 'Condition (1-10)',&#10;    `location` VARCHAR(255) NULL COMMENT 'Location',&#10;    `category` VARCHAR(100) NULL DEFAULT 'other' COMMENT 'Product category',&#10;    `status` TINYINT NOT NULL DEFAULT 1 COMMENT 'Status: 1=For Sale, 2=Sold, 0=Delisted',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_status` (`status`),&#10;    INDEX `idx_price` (`price`),&#10;    INDEX `idx_category` (`category`),&#10;    CONSTRAINT `fk_product_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Products table';&#10;&#10;-- Table `pms_product_media`&#10;CREATE TABLE `pms_product_media` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Media ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `url` VARCHAR(1024) NOT NULL COMMENT 'Media URL',&#10;    `media_type` TINYINT NOT NULL COMMENT 'Media type: 1=Image, 2=Video',&#10;    `sort_order` INT NULL DEFAULT 0 COMMENT 'Sort order',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_media_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Product media table';&#10;&#10;-- Table `pms_report`&#10;CREATE TABLE `pms_report` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Report ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Reported Product ID',&#10;    `reporter_id` BIGINT NOT NULL COMMENT 'Reporter User ID',&#10;    `reason` VARCHAR(255) NOT NULL COMMENT 'Reason for reporting',&#10;    `description` TEXT NULL COMMENT 'Detailed description of the report',&#10;    `status` ENUM('PENDING', 'APPROVED', 'REJECTED') NOT NULL DEFAULT 'PENDING' COMMENT 'Report status',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    INDEX `idx_reporter_id` (`reporter_id`),&#10;    CONSTRAINT `fk_report_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_report_reporter` FOREIGN KEY (`reporter_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Product reports table';&#10;&#10;-- Table `user_favorites`&#10;CREATE TABLE `user_favorites` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Favorite ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE KEY `uk_user_product` (`user_id`, `product_id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_favorite_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_favorite_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='User favorites table';&#10;&#10;-- Table `shopping_cart`&#10;CREATE TABLE `shopping_cart` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Cart ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `quantity` INT NOT NULL DEFAULT 1 COMMENT 'Quantity',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Update time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE KEY `uk_user_product` (`user_id`, `product_id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_cart_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_cart_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Shopping cart table';&#10;&#10;-- 订单表&#10;CREATE TABLE `orders` (&#10;                          `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '订单ID',&#10;                          `user_id` BIGINT NOT NULL COMMENT '用户ID',&#10;                          `total_amount` DECIMAL(10, 2) NOT NULL COMMENT '总金额',&#10;                          `status` VARCHAR(20) NOT NULL COMMENT '订单状态 (PENDING, PAID, SHIPPED, DELIVERED, CANCELED, EXPIRED)',&#10;                          `payment_method` VARCHAR(50) NULL COMMENT '支付方式 (alipay, wechat, bank, balance)',&#10;                          `expire_time` TIMESTAMP NULL COMMENT '订单过期时间（15分钟后）',&#10;                          `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',&#10;                          `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',&#10;                          PRIMARY KEY (`id`),&#10;                          FOREIGN KEY (`user_id`) REFERENCES `users`(`id`),&#10;                          INDEX `idx_status_expire` (`status`, `expire_time`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- 订单项表&#10;CREATE TABLE `order_items` (&#10;                               `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '订单项ID',&#10;                               `order_id` BIGINT NOT NULL COMMENT '订单ID',&#10;                               `product_id` BIGINT NOT NULL COMMENT '商品ID',&#10;                               `quantity` INT NOT NULL COMMENT '数量',&#10;                               `price` DECIMAL(10, 2) NOT NULL COMMENT '单价',&#10;                               `from_cart` BOOLEAN NOT NULL DEFAULT FALSE COMMENT '是否来自购物车',&#10;                               PRIMARY KEY (`id`),&#10;                               FOREIGN KEY (`order_id`) REFERENCES `orders`(`id`),&#10;                               FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- 交易表 (用于模拟支付)&#10;CREATE TABLE `transactions` (&#10;                                `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '交易ID',&#10;                                `order_id` BIGINT NOT NULL COMMENT '订单ID',&#10;                                `amount` DECIMAL(10, 2) NOT NULL COMMENT '交易金额',&#10;                                `payment_method` VARCHAR(50) NULL COMMENT '支付方式 (alipay, wechat, bank, balance)',&#10;                                `transaction_type` VARCHAR(20) NOT NULL COMMENT '交易类型 (PAYMENT, REFUND)',&#10;                                `status` VARCHAR(20) NOT NULL COMMENT '交易状态 (SUCCESS, FAILED)',&#10;                                `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',&#10;                                PRIMARY KEY (`id`),&#10;                                FOREIGN KEY (`order_id`) REFERENCES `orders`(`id`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- =================================================================&#10;-- Seeding Essential Data&#10;-- =================================================================&#10;&#10;-- Insert base roles&#10;INSERT INTO `roles` (`id`, `name`) VALUES (1, 'ROLE_USER'), (2, 'ROLE_ADMIN')&#10;ON DUPLICATE KEY UPDATE name=VALUES(name);&#10;&#10;-- Create a default admin account (username: admin, password: admin123)&#10;-- BCrypt hash for 'admin123'&#10;INSERT INTO `users` (`id`, `username`, `display_name`, `password_hash`, `email`, `avatar_url`)&#10;VALUES (1, 'admin', '系统管理员', '$2a$12$9l1r7OVMYW3xsv/JQchZKutlvkIJgopmbNC3jEA3hUkNbN/ivzMn2', 'admin@rebook.trade', 'https://i.pravatar.cc/150?u=admin')&#10;ON DUPLICATE KEY UPDATE username=VALUES(username), display_name=VALUES(display_name), password_hash=VALUES(password_hash);&#10;&#10;-- Assign roles to admin user&#10;INSERT INTO `user_roles` (`user_id`, `role_id`) VALUES (1, 1), (1, 2)&#10;ON DUPLICATE KEY UPDATE user_id=VALUES(user_id);&#10;&#10;-- =================================================================&#10;-- End of Script&#10;-- =================================================================&#10;SELECT 'Database structure and essential data seeded successfully.' AS status;&#10;ALTER TABLE chat_message CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;" />
              <option name="updatedContent" value="-- =================================================================&#10;-- RebookTrade - Complete Database Initialization Script&#10;-- Version: 2.0&#10;-- Last Updated: 2025-10-21&#10;-- =================================================================&#10;-- This script handles:&#10;-- 1. Database creation with UTF-8mb4 character set.&#10;-- 2. Dropping and recreating all tables for a clean slate.&#10;-- 3. Seeding essential data (roles, admin user).&#10;-- 4. Seeding realistic test data for users and products (books).&#10;-- =================================================================&#10;&#10;-- Set session variables for character encoding&#10;SET NAMES utf8mb4;&#10;SET CHARACTER SET utf8mb4;&#10;&#10;-- Create the database if it doesn't exist, ensuring correct character set&#10;CREATE DATABASE IF NOT EXISTS trade CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;&#10;USE trade;&#10;&#10;-- Disable foreign key checks to allow clean drop&#10;SET FOREIGN_KEY_CHECKS = 0;&#10;&#10;-- Drop tables in reverse order of dependency to avoid foreign key errors&#10;DROP TABLE IF EXISTS `bargain_help`;&#10;DROP TABLE IF EXISTS `bargain_activity`;&#10;DROP TABLE IF EXISTS `shopping_cart`;&#10;DROP TABLE IF EXISTS `user_favorites`;&#10;DROP TABLE IF EXISTS `pms_product_media`;&#10;DROP TABLE IF EXISTS `pms_report`;&#10;DROP TABLE IF EXISTS `pms_product`;&#10;DROP TABLE IF EXISTS `chat_message`;&#10;DROP TABLE IF EXISTS `user_roles`;&#10;DROP TABLE IF EXISTS `roles`;&#10;DROP TABLE IF EXISTS `users`;&#10;&#10;-- Re-enable foreign key checks&#10;SET FOREIGN_KEY_CHECKS = 1;&#10;&#10;-- =================================================================&#10;-- Table Structure Definitions&#10;-- =================================================================&#10;&#10;-- Table `users`&#10;CREATE TABLE `users` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'User unique ID',&#10;    `username` VARCHAR(50) NOT NULL COMMENT 'Username, unique',&#10;    `display_name` VARCHAR(100) NULL COMMENT 'Display name for the user',&#10;    `password_hash` VARCHAR(255) NOT NULL COMMENT 'BCrypt hashed password',&#10;    `payment_password_hash` VARCHAR(255) NULL COMMENT 'BCrypt hashed payment password (6 digits)',&#10;    `email` VARCHAR(100) NOT NULL COMMENT 'User email, unique',&#10;    `avatar_url` VARCHAR(255) NULL COMMENT 'User avatar URL',&#10;    `balance` DECIMAL(10, 2) NOT NULL DEFAULT 0.00 COMMENT 'User balance',&#10;    `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE INDEX `uk_username` (`username`),&#10;    UNIQUE INDEX `uk_email` (`email`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Users table';&#10;&#10;-- Table `roles`&#10;CREATE TABLE `roles` (&#10;    `id` INT NOT NULL AUTO_INCREMENT COMMENT 'Role unique ID',&#10;    `name` VARCHAR(50) NOT NULL COMMENT 'Role name, unique',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE INDEX `uk_rolename` (`name`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Roles table';&#10;&#10;-- Table `user_roles`&#10;CREATE TABLE `user_roles` (&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `role_id` INT NOT NULL COMMENT 'Role ID',&#10;    PRIMARY KEY (`user_id`, `role_id`),&#10;    INDEX `fk_user_roles_role_id_idx` (`role_id`),&#10;    CONSTRAINT `fk_user_roles_user_id` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_user_roles_role_id` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='User-role association table';&#10;&#10;-- Table `chat_message`&#10;CREATE TABLE `chat_message` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Message unique ID',&#10;    `sender_id` BIGINT NULL COMMENT 'Sender user ID (NULL for system messages)',&#10;    `recipient_id` BIGINT NOT NULL COMMENT 'Recipient user ID',&#10;    `content` TEXT NOT NULL COMMENT 'Message content',&#10;    `timestamp` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Message sent time',&#10;    `is_read` BOOLEAN NOT NULL DEFAULT FALSE COMMENT 'Is the message read',&#10;    `is_system_message` BOOLEAN NOT NULL DEFAULT FALSE COMMENT 'Is it a system message',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_sender_recipient` (`sender_id`, `recipient_id`),&#10;    INDEX `idx_recipient_read` (`recipient_id`, `is_read`),&#10;    CONSTRAINT `fk_chat_message_sender` FOREIGN KEY (`sender_id`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_chat_message_recipient` FOREIGN KEY (`recipient_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Chat messages table';&#10;&#10;-- Table `pms_product`&#10;CREATE TABLE `pms_product` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Product ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'Seller user ID',&#10;    `name` VARCHAR(255) NOT NULL COMMENT 'Product name',&#10;    `description` TEXT NULL COMMENT 'Product description',&#10;    `price` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT 'Price',&#10;    `stock` INT NOT NULL DEFAULT 1 COMMENT 'Stock (default 1 for used items)',&#10;    `condition_level` INT NOT NULL DEFAULT 9 COMMENT 'Condition (1-10)',&#10;    `location` VARCHAR(255) NULL COMMENT 'Location',&#10;    `category` VARCHAR(100) NULL DEFAULT 'other' COMMENT 'Product category',&#10;    `status` TINYINT NOT NULL DEFAULT 1 COMMENT 'Status: 1=For Sale, 2=Sold, 0=Delisted',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_status` (`status`),&#10;    INDEX `idx_price` (`price`),&#10;    INDEX `idx_category` (`category`),&#10;    CONSTRAINT `fk_product_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Products table';&#10;&#10;-- Table `pms_product_media`&#10;CREATE TABLE `pms_product_media` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Media ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `url` VARCHAR(1024) NOT NULL COMMENT 'Media URL',&#10;    `media_type` TINYINT NOT NULL COMMENT 'Media type: 1=Image, 2=Video',&#10;    `sort_order` INT NULL DEFAULT 0 COMMENT 'Sort order',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_media_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Product media table';&#10;&#10;-- Table `pms_report`&#10;CREATE TABLE `pms_report` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Report ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Reported Product ID',&#10;    `reporter_id` BIGINT NOT NULL COMMENT 'Reporter User ID',&#10;    `reason` VARCHAR(255) NOT NULL COMMENT 'Reason for reporting',&#10;    `description` TEXT NULL COMMENT 'Detailed description of the report',&#10;    `status` ENUM('PENDING', 'APPROVED', 'REJECTED') NOT NULL DEFAULT 'PENDING' COMMENT 'Report status',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Last update time',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    INDEX `idx_reporter_id` (`reporter_id`),&#10;    CONSTRAINT `fk_report_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_report_reporter` FOREIGN KEY (`reporter_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Product reports table';&#10;&#10;-- Table `user_favorites`&#10;CREATE TABLE `user_favorites` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Favorite ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE KEY `uk_user_product` (`user_id`, `product_id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_favorite_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_favorite_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='User favorites table';&#10;&#10;-- Table `shopping_cart`&#10;CREATE TABLE `shopping_cart` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'Cart ID',&#10;    `user_id` BIGINT NOT NULL COMMENT 'User ID',&#10;    `product_id` BIGINT NOT NULL COMMENT 'Product ID',&#10;    `quantity` INT NOT NULL DEFAULT 1 COMMENT 'Quantity',&#10;    `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'Creation time',&#10;    `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Update time',&#10;    PRIMARY KEY (`id`),&#10;    UNIQUE KEY `uk_user_product` (`user_id`, `product_id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    CONSTRAINT `fk_cart_user` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`) ON DELETE CASCADE ON UPDATE CASCADE,&#10;    CONSTRAINT `fk_cart_product` FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`) ON DELETE CASCADE ON UPDATE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Shopping cart table';&#10;&#10;-- 订单表&#10;CREATE TABLE `orders` (&#10;                          `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '订单ID',&#10;                          `user_id` BIGINT NOT NULL COMMENT '用户ID',&#10;                          `total_amount` DECIMAL(10, 2) NOT NULL COMMENT '总金额',&#10;                          `status` VARCHAR(20) NOT NULL COMMENT '订单状态 (PENDING, PAID, SHIPPED, DELIVERED, CANCELED, EXPIRED)',&#10;                          `payment_method` VARCHAR(50) NULL COMMENT '支付方式 (alipay, wechat, bank, balance)',&#10;                          `expire_time` TIMESTAMP NULL COMMENT '订单过期时间（15分钟后）',&#10;                          `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',&#10;                          `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',&#10;                          PRIMARY KEY (`id`),&#10;                          FOREIGN KEY (`user_id`) REFERENCES `users`(`id`),&#10;                          INDEX `idx_status_expire` (`status`, `expire_time`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- 订单项表&#10;CREATE TABLE `order_items` (&#10;                               `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '订单项ID',&#10;                               `order_id` BIGINT NOT NULL COMMENT '订单ID',&#10;                               `product_id` BIGINT NOT NULL COMMENT '商品ID',&#10;                               `quantity` INT NOT NULL COMMENT '数量',&#10;                               `price` DECIMAL(10, 2) NOT NULL COMMENT '单价',&#10;                               `from_cart` BOOLEAN NOT NULL DEFAULT FALSE COMMENT '是否来自购物车',&#10;                               PRIMARY KEY (`id`),&#10;                               FOREIGN KEY (`order_id`) REFERENCES `orders`(`id`),&#10;                               FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- 交易表 (用于模拟支付)&#10;CREATE TABLE `transactions` (&#10;                                `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '交易ID',&#10;                                `order_id` BIGINT NOT NULL COMMENT '订单ID',&#10;                                `amount` DECIMAL(10, 2) NOT NULL COMMENT '交易金额',&#10;                                `payment_method` VARCHAR(50) NULL COMMENT '支付方式 (alipay, wechat, bank, balance)',&#10;                                `transaction_type` VARCHAR(20) NOT NULL COMMENT '交易类型 (PAYMENT, REFUND)',&#10;                                `status` VARCHAR(20) NOT NULL COMMENT '交易状态 (SUCCESS, FAILED)',&#10;                                `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',&#10;                                PRIMARY KEY (`id`),&#10;                                FOREIGN KEY (`order_id`) REFERENCES `orders`(`id`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;&#10;&#10;-- 砍价活动表&#10;CREATE TABLE `bargain_activity` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '砍价活动ID',&#10;    `user_id` BIGINT NOT NULL COMMENT '发起用户ID',&#10;    `product_id` BIGINT NOT NULL COMMENT '商品ID',&#10;    `original_price` DECIMAL(10, 2) NOT NULL COMMENT '原价',&#10;    `target_price` DECIMAL(10, 2) NOT NULL COMMENT '目标价格（最低价）',&#10;    `current_price` DECIMAL(10, 2) NOT NULL COMMENT '当前价格',&#10;    `status` VARCHAR(20) NOT NULL DEFAULT 'ACTIVE' COMMENT '状态：ACTIVE-进行中, SUCCESS-成功, EXPIRED-已过期',&#10;    `expire_time` TIMESTAMP NOT NULL COMMENT '过期时间',&#10;    `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',&#10;    `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_user_id` (`user_id`),&#10;    INDEX `idx_product_id` (`product_id`),&#10;    INDEX `idx_status` (`status`),&#10;    FOREIGN KEY (`user_id`) REFERENCES `users`(`id`),&#10;    FOREIGN KEY (`product_id`) REFERENCES `pms_product`(`id`)&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='砍价活动表';&#10;&#10;-- 砍价助力记录表&#10;CREATE TABLE `bargain_help` (&#10;    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '助力记录ID',&#10;    `bargain_id` BIGINT NOT NULL COMMENT '砍价活动ID',&#10;    `helper_id` BIGINT NULL COMMENT '助力用户ID（可为空，支持游客助力）',&#10;    `helper_name` VARCHAR(100) NULL COMMENT '助力用户昵称（游客时使用）',&#10;    `cut_amount` DECIMAL(10, 2) NOT NULL COMMENT '砍掉的金额',&#10;    `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '助力时间',&#10;    PRIMARY KEY (`id`),&#10;    INDEX `idx_bargain_id` (`bargain_id`),&#10;    INDEX `idx_helper_id` (`helper_id`),&#10;    FOREIGN KEY (`bargain_id`) REFERENCES `bargain_activity`(`id`) ON DELETE CASCADE&#10;) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='砍价助力记录表';&#10;&#10;-- =================================================================&#10;-- Seeding Essential Data&#10;-- =================================================================&#10;&#10;-- Insert base roles&#10;INSERT INTO `roles` (`id`, `name`) VALUES (1, 'ROLE_USER'), (2, 'ROLE_ADMIN')&#10;ON DUPLICATE KEY UPDATE name=VALUES(name);&#10;&#10;-- Create a default admin account (username: admin, password: admin123)&#10;-- BCrypt hash for 'admin123'&#10;INSERT INTO `users` (`id`, `username`, `display_name`, `password_hash`, `email`, `avatar_url`)&#10;VALUES (1, 'admin', '系统管理员', '$2a$12$9l1r7OVMYW3xsv/JQchZKutlvkIJgopmbNC3jEA3hUkNbN/ivzMn2', 'admin@rebook.trade', 'https://i.pravatar.cc/150?u=admin')&#10;ON DUPLICATE KEY UPDATE username=VALUES(username), display_name=VALUES(display_name), password_hash=VALUES(password_hash);&#10;&#10;-- Assign roles to admin user&#10;INSERT INTO `user_roles` (`user_id`, `role_id`) VALUES (1, 1), (1, 2)&#10;ON DUPLICATE KEY UPDATE user_id=VALUES(user_id);&#10;&#10;-- =================================================================&#10;-- End of Script&#10;-- =================================================================&#10;SELECT 'Database structure and essential data seeded successfully.' AS status;&#10;ALTER TABLE chat_message CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/scripts/try-lombok-upgrades.sh">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/scripts/try-lombok-upgrades.sh" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="#!/usr/bin/env bash&#10;set -euo pipefail&#10;&#10;# Script to try multiple Lombok versions using Docker (JDK 23) to find one compatible with the project.&#10;# Usage: ./scripts/try-lombok-upgrades.sh&#10;&#10;POM=&quot;pom.xml&quot;&#10;BACKUP=&quot;${POM}.bak&quot;&#10;cp &quot;$POM&quot; &quot;$BACKUP&quot;&#10;&#10;VERSIONS=(&#10;  &quot;1.18.36&quot;&#10;  &quot;1.18.38&quot;&#10;  &quot;1.18.40&quot;&#10;  &quot;1.18.42&quot;&#10;  &quot;1.18.44&quot;&#10;  &quot;1.18.46&quot;&#10;  &quot;1.18.48&quot;&#10;  &quot;1.18.50&quot;&#10;  &quot;1.18.52&quot;&#10;)&#10;&#10;DOCKER_IMAGE=&quot;maven:3.9.11-jdk-23&quot;&#10;&#10;echo &quot;Using Docker image: $DOCKER_IMAGE&quot;&#10;&#10;tmpdir=$(mktemp -d)&#10;cleanup(){ rm -rf &quot;$tmpdir&quot;; }&#10;trap cleanup EXIT&#10;&#10;success=&quot;&quot;&#10;for v in &quot;${VERSIONS[@]}&quot;; do&#10;  echo&#10;  echo &quot;=============================================&quot;&#10;  echo &quot;Trying lombok version: $v&quot;&#10;  echo &quot;Updating $POM...&quot;&#10;&#10;  # Update the property in the pom (safe perl replacement)&#10;  perl -0777 -pe &quot;s|(&lt;lombok.version&gt;).*?(&lt;/lombok.version&gt;)|\1$v\2|s&quot; &quot;$BACKUP&quot; &gt; &quot;$tmpdir/pom.tmp&quot;&#10;  mv &quot;$tmpdir/pom.tmp&quot; &quot;$POM&quot;&#10;&#10;  echo &quot;Running Maven build inside Docker (JDK 23)...&quot;&#10;  # Run Maven inside Docker so javac=23 is used (avoids host javac mismatch)&#10;  if docker run --rm -v &quot;$PWD&quot;:/workspace -w /workspace $DOCKER_IMAGE mvn -U -DskipTests package &gt; &quot;build-lombok-$v.log&quot; 2&gt;&amp;1; then&#10;    echo &quot;Build succeeded with lombok $v&quot;&#10;    success=&quot;$v&quot;&#10;    break&#10;  else&#10;    echo &quot;Build failed with lombok $v (log: build-lombok-$v.log)&quot;&#10;  fi&#10;done&#10;&#10;if [ -n &quot;$success&quot; ]; then&#10;  echo &quot;SUCCESS: Project builds with lombok $success&quot;&#10;  echo &quot;pom.xml has been updated to use that version.&quot;&#10;  exit 0&#10;else&#10;  echo &quot;No tested Lombok version produced a successful build. Restoring original pom.xml&quot;&#10;  mv &quot;$BACKUP&quot; &quot;$POM&quot;&#10;  exit 1&#10;fi" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/AdminController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/AdminController.java" />
              <option name="originalContent" value="package lut.cn.c2cplatform.controller;&#10;&#10;import lut.cn.c2cplatform.entity.User;&#10;import lut.cn.c2cplatform.mapper.UserMapper;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/admin&quot;)&#10;public class AdminController {&#10;    @Autowired&#10;    private UserMapper userMapper;&#10;&#10;    @GetMapping(&quot;/users&quot;)&#10;    @PreAuthorize(&quot;hasRole('ADMIN')&quot;)&#10;    public ResponseEntity&lt;List&lt;User&gt;&gt; getAllUsers() {&#10;        return ResponseEntity.ok(userMapper.selectAll());&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.controller;&#10;&#10;import lut.cn.c2cplatform.entity.User;&#10;import lut.cn.c2cplatform.mapper.UserMapper;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/admin&quot;)&#10;public class AdminController {&#10;    @Autowired&#10;    private UserMapper userMapper;&#10;&#10;    @GetMapping(&quot;/users&quot;)&#10;    @PreAuthorize(&quot;hasRole('ADMIN')&quot;)&#10;    public ResponseEntity&lt;List&lt;User&gt;&gt; getAllUsers() {&#10;        // 返回包含角色信息的用户&#10;        return ResponseEntity.ok(userMapper.selectAllWithRoles());&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/BargainController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/BargainController.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.controller;&#10;&#10;import lut.cn.c2cplatform.entity.BargainActivity;&#10;import lut.cn.c2cplatform.entity.BargainHelp;&#10;import lut.cn.c2cplatform.entity.User;&#10;import lut.cn.c2cplatform.mapper.UserMapper;&#10;import lut.cn.c2cplatform.service.BargainService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.core.Authentication;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.HashMap;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/bargain&quot;)&#10;public class BargainController {&#10;&#10;    @Autowired&#10;    private BargainService bargainService;&#10;&#10;    @Autowired&#10;    private UserMapper userMapper;&#10;&#10;    /**&#10;     * 发起砍价&#10;     */&#10;    @PostMapping(&quot;/start&quot;)&#10;    public ResponseEntity&lt;?&gt; startBargain(@RequestBody Map&lt;String, Long&gt; request, Authentication authentication) {&#10;        try {&#10;            String username = authentication.getName();&#10;            User user = userMapper.selectByUsername(username);&#10;            &#10;            Long productId = request.get(&quot;productId&quot;);&#10;            if (productId == null) {&#10;                return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, &quot;商品ID不能为空&quot;));&#10;            }&#10;&#10;            BargainActivity bargainActivity = bargainService.startBargain(user.getId(), productId);&#10;            return ResponseEntity.ok(bargainActivity);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, e.getMessage()));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * 帮助砍价&#10;     */&#10;    @PostMapping(&quot;/help/{bargainId}&quot;)&#10;    public ResponseEntity&lt;?&gt; helpBargain(@PathVariable Long bargainId, Authentication authentication) {&#10;        try {&#10;            Long helperId = null;&#10;            String helperName = &quot;游客&quot;;&#10;            &#10;            if (authentication != null) {&#10;                String username = authentication.getName();&#10;                User user = userMapper.selectByUsername(username);&#10;                helperId = user.getId();&#10;                helperName = user.getDisplayName() != null ? user.getDisplayName() : user.getUsername();&#10;            }&#10;&#10;            BargainHelp bargainHelp = bargainService.helpBargain(bargainId, helperId, helperName);&#10;            BargainActivity updatedActivity = bargainService.getBargainActivity(bargainId);&#10;            &#10;            Map&lt;String, Object&gt; result = new HashMap&lt;&gt;();&#10;            result.put(&quot;help&quot;, bargainHelp);&#10;            result.put(&quot;activity&quot;, updatedActivity);&#10;            &#10;            return ResponseEntity.ok(result);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, e.getMessage()));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * 获取砍价活动详情&#10;     */&#10;    @GetMapping(&quot;/{bargainId}&quot;)&#10;    public ResponseEntity&lt;?&gt; getBargainActivity(@PathVariable Long bargainId) {&#10;        try {&#10;            BargainActivity bargainActivity = bargainService.getBargainActivity(bargainId);&#10;            if (bargainActivity == null) {&#10;                return ResponseEntity.notFound().build();&#10;            }&#10;            &#10;            List&lt;BargainHelp&gt; helpList = bargainService.getBargainHelpList(bargainId);&#10;            &#10;            Map&lt;String, Object&gt; result = new HashMap&lt;&gt;();&#10;            result.put(&quot;activity&quot;, bargainActivity);&#10;            result.put(&quot;helpList&quot;, helpList);&#10;            &#10;            return ResponseEntity.ok(result);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, e.getMessage()));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * 获取用户的砍价活动列表&#10;     */&#10;    @GetMapping(&quot;/my-bargains&quot;)&#10;    public ResponseEntity&lt;?&gt; getMyBargains(Authentication authentication) {&#10;        try {&#10;            String username = authentication.getName();&#10;            User user = userMapper.selectByUsername(username);&#10;            &#10;            List&lt;BargainActivity&gt; bargainActivities = bargainService.getUserBargainActivities(user.getId());&#10;            return ResponseEntity.ok(bargainActivities);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, e.getMessage()));&#10;        }&#10;    }&#10;&#10;    /**&#10;     * 检查用户是否可以为商品发起砍价&#10;     */&#10;    @GetMapping(&quot;/check/{productId}&quot;)&#10;    public ResponseEntity&lt;?&gt; checkCanStart(@PathVariable Long productId, Authentication authentication) {&#10;        try {&#10;            if (authentication == null) {&#10;                return ResponseEntity.ok(Map.of(&quot;canStart&quot;, true));&#10;            }&#10;            &#10;            String username = authentication.getName();&#10;            User user = userMapper.selectByUsername(username);&#10;            &#10;            BargainActivity existingBargain = bargainService.getBargainActivity(productId);&#10;            boolean canStart = existingBargain == null;&#10;            &#10;            Map&lt;String, Object&gt; result = new HashMap&lt;&gt;();&#10;            result.put(&quot;canStart&quot;, canStart);&#10;            if (!canStart) {&#10;                result.put(&quot;existingBargain&quot;, existingBargain);&#10;            }&#10;            &#10;            return ResponseEntity.ok(result);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.badRequest().body(Map.of(&quot;message&quot;, e.getMessage()));&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/OrderController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/controller/OrderController.java" />
              <option name="originalContent" value="package lut.cn.c2cplatform.controller;&#10;&#10;import lut.cn.c2cplatform.dto.BuyNowRequest;&#10;import lut.cn.c2cplatform.dto.PaymentRequest;&#10;import lut.cn.c2cplatform.entity.Order;&#10;import lut.cn.c2cplatform.entity.User;&#10;import lut.cn.c2cplatform.mapper.UserMapper;&#10;import lut.cn.c2cplatform.service.OrderService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.core.Authentication;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/orders&quot;)&#10;public class OrderController {&#10;&#10;    @Autowired&#10;    private OrderService orderService;&#10;&#10;    @Autowired&#10;    private UserMapper userMapper;&#10;&#10;    @PostMapping&#10;    public ResponseEntity&lt;Order&gt; createOrder(Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.createOrderFromCart(user.getId().intValue());&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/buy-now&quot;)&#10;    public ResponseEntity&lt;Order&gt; buyNow(&#10;            @RequestBody BuyNowRequest request,&#10;            Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.createOrderForProduct(&#10;                user.getId().intValue(),&#10;                request.getProductId(),&#10;                request.getQuantity()&#10;        );&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;Order&gt;&gt; getUserOrders(Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        List&lt;Order&gt; orders = orderService.getUserOrders(user.getId().intValue());&#10;        return ResponseEntity.ok(orders);&#10;    }&#10;&#10;    @GetMapping(&quot;/{orderId}&quot;)&#10;    public ResponseEntity&lt;Order&gt; getOrderById(@PathVariable Integer orderId) {&#10;        Order order = orderService.getOrderById(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/pay&quot;)&#10;    public ResponseEntity&lt;Order&gt; payOrder(&#10;            @PathVariable Integer orderId,&#10;            @RequestBody PaymentRequest paymentRequest,&#10;            Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.payOrder(orderId, user.getId().intValue(), paymentRequest);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/confirm&quot;)&#10;    public ResponseEntity&lt;Order&gt; confirmOrder(@PathVariable Integer orderId) {&#10;        Order order = orderService.confirmOrder(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/cancel&quot;)&#10;    public ResponseEntity&lt;Order&gt; cancelOrder(@PathVariable Integer orderId) {&#10;        Order order = orderService.cancelOrder(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.controller;&#10;&#10;import lut.cn.c2cplatform.dto.BuyNowRequest;&#10;import lut.cn.c2cplatform.dto.PaymentRequest;&#10;import lut.cn.c2cplatform.entity.Order;&#10;import lut.cn.c2cplatform.entity.User;&#10;import lut.cn.c2cplatform.mapper.UserMapper;&#10;import lut.cn.c2cplatform.service.OrderService;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.core.Authentication;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/orders&quot;)&#10;public class OrderController {&#10;&#10;    @Autowired&#10;    private OrderService orderService;&#10;&#10;    @Autowired&#10;    private UserMapper userMapper;&#10;&#10;    @PostMapping&#10;    public ResponseEntity&lt;Order&gt; createOrder(Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.createOrderFromCart(user.getId().intValue());&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/buy-now&quot;)&#10;    public ResponseEntity&lt;Order&gt; buyNow(&#10;            @RequestBody BuyNowRequest request,&#10;            Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.createOrderForProduct(&#10;                user.getId().intValue(),&#10;                request.getProductId(),&#10;                request.getQuantity()&#10;        );&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;Order&gt;&gt; getUserOrders(Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        List&lt;Order&gt; orders = orderService.getUserOrders(user.getId().intValue());&#10;        return ResponseEntity.ok(orders);&#10;    }&#10;&#10;    @GetMapping(&quot;/{orderId}&quot;)&#10;    public ResponseEntity&lt;Order&gt; getOrderById(@PathVariable Integer orderId) {&#10;        Order order = orderService.getOrderById(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/pay&quot;)&#10;    public ResponseEntity&lt;Order&gt; payOrder(&#10;            @PathVariable Integer orderId,&#10;            @RequestBody PaymentRequest paymentRequest,&#10;            Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        Order order = orderService.payOrder(orderId, user.getId().intValue(), paymentRequest);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/confirm&quot;)&#10;    public ResponseEntity&lt;Order&gt; confirmOrder(@PathVariable Integer orderId) {&#10;        Order order = orderService.confirmOrder(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    @PostMapping(&quot;/{orderId}/cancel&quot;)&#10;    public ResponseEntity&lt;Order&gt; cancelOrder(@PathVariable Integer orderId) {&#10;        Order order = orderService.cancelOrder(orderId);&#10;        return ResponseEntity.ok(order);&#10;    }&#10;&#10;    /**&#10;     * 检查用户是否有未完成的订单（PENDING状态）&#10;     */&#10;    @GetMapping(&quot;/check-pending&quot;)&#10;    public ResponseEntity&lt;?&gt; checkPendingOrders(Authentication authentication) {&#10;        String username = authentication.getName();&#10;        User user = userMapper.selectByUsername(username);&#10;        List&lt;Order&gt; orders = orderService.getUserOrders(user.getId().intValue());&#10;        &#10;        // 检查是否有待支付的订单&#10;        boolean hasPendingOrder = orders.stream()&#10;                .anyMatch(order -&gt; &quot;PENDING&quot;.equals(order.getStatus()));&#10;        &#10;        java.util.Map&lt;String, Object&gt; response = new java.util.HashMap&lt;&gt;();&#10;        response.put(&quot;hasPendingOrder&quot;, hasPendingOrder);&#10;        &#10;        if (hasPendingOrder) {&#10;            Order pendingOrder = orders.stream()&#10;                    .filter(order -&gt; &quot;PENDING&quot;.equals(order.getStatus()))&#10;                    .findFirst()&#10;                    .orElse(null);&#10;            response.put(&quot;orderId&quot;, pendingOrder != null ? pendingOrder.getId() : null);&#10;        }&#10;        &#10;        return ResponseEntity.ok(response);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/entity/BargainActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/entity/BargainActivity.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.entity;&#10;&#10;import lombok.Data;&#10;import java.math.BigDecimal;&#10;import java.util.Date;&#10;&#10;@Data&#10;public class BargainActivity {&#10;    private Long id;&#10;    private Long userId;&#10;    private Long productId;&#10;    private BigDecimal originalPrice;&#10;    private BigDecimal targetPrice;&#10;    private BigDecimal currentPrice;&#10;    private String status; // ACTIVE, SUCCESS, EXPIRED&#10;    private Date expireTime;&#10;    private Date createdAt;&#10;    private Date updatedAt;&#10;    &#10;    // 关联数据&#10;    private String username;&#10;    private String displayName;&#10;    private String productName;&#10;    private String productImage;&#10;    private Integer helpCount; // 助力人数&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/entity/BargainHelp.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/entity/BargainHelp.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.entity;&#10;&#10;import lombok.Data;&#10;import java.math.BigDecimal;&#10;import java.util.Date;&#10;&#10;@Data&#10;public class BargainHelp {&#10;    private Long id;&#10;    private Long bargainId;&#10;    private Long helperId;&#10;    private String helperName;&#10;    private BigDecimal cutAmount;&#10;    private Date createdAt;&#10;    &#10;    // 关联数据&#10;    private String helperAvatar;&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/BargainActivityMapper.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/BargainActivityMapper.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.mapper;&#10;&#10;import lut.cn.c2cplatform.entity.BargainActivity;&#10;import org.apache.ibatis.annotations.Mapper;&#10;import org.apache.ibatis.annotations.Param;&#10;&#10;import java.util.List;&#10;&#10;@Mapper&#10;public interface BargainActivityMapper {&#10;    void insert(BargainActivity bargainActivity);&#10;    BargainActivity selectById(Long id);&#10;    List&lt;BargainActivity&gt; selectByUserId(@Param(&quot;userId&quot;) Long userId);&#10;    List&lt;BargainActivity&gt; selectByProductId(@Param(&quot;productId&quot;) Long productId);&#10;    void update(BargainActivity bargainActivity);&#10;    void updateStatus(@Param(&quot;id&quot;) Long id, @Param(&quot;status&quot;) String status);&#10;    List&lt;BargainActivity&gt; selectExpiredActivities();&#10;    &#10;    // 检查用户是否已经为该商品发起过砍价&#10;    BargainActivity selectActiveByUserAndProduct(@Param(&quot;userId&quot;) Long userId, @Param(&quot;productId&quot;) Long productId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/BargainHelpMapper.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/BargainHelpMapper.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.mapper;&#10;&#10;import lut.cn.c2cplatform.entity.BargainHelp;&#10;import org.apache.ibatis.annotations.Mapper;&#10;import org.apache.ibatis.annotations.Param;&#10;&#10;import java.util.List;&#10;&#10;@Mapper&#10;public interface BargainHelpMapper {&#10;    void insert(BargainHelp bargainHelp);&#10;    List&lt;BargainHelp&gt; selectByBargainId(@Param(&quot;bargainId&quot;) Long bargainId);&#10;    &#10;    // 检查某个用户是否已经帮助过某个砍价活动&#10;    BargainHelp selectByBargainIdAndHelperId(@Param(&quot;bargainId&quot;) Long bargainId, @Param(&quot;helperId&quot;) Long helperId);&#10;    &#10;    // 统计某个砍价活动的助力人数&#10;    Integer countByBargainId(@Param(&quot;bargainId&quot;) Long bargainId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/UserMapper.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/mapper/UserMapper.java" />
              <option name="originalContent" value="package lut.cn.c2cplatform.mapper;&#10;&#10;import lut.cn.c2cplatform.entity.User;&#10;import org.apache.ibatis.annotations.Mapper;&#10;import org.apache.ibatis.annotations.Param;&#10;import java.util.List;&#10;&#10;@Mapper&#10;public interface UserMapper {&#10;    User selectById(@Param(&quot;id&quot;) Long id);&#10;    User selectByUsername(@Param(&quot;username&quot;) String username);&#10;    // 加载包含角色的用户&#10;    User selectByUsernameWithRoles(@Param(&quot;username&quot;) String username);&#10;    List&lt;User&gt; selectAll();&#10;    int insert(User user);&#10;    int update(User user);&#10;    int deleteById(@Param(&quot;id&quot;) Long id);&#10;}&#10;" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.mapper;&#10;&#10;import lut.cn.c2cplatform.entity.User;&#10;import org.apache.ibatis.annotations.Mapper;&#10;import org.apache.ibatis.annotations.Param;&#10;import java.util.List;&#10;&#10;@Mapper&#10;public interface UserMapper {&#10;    User selectById(@Param(&quot;id&quot;) Long id);&#10;    User selectByUsername(@Param(&quot;username&quot;) String username);&#10;    // 加载包含角色的用户&#10;    User selectByUsernameWithRoles(@Param(&quot;username&quot;) String username);&#10;    // 加载所有用户（包含角色）&#10;    List&lt;User&gt; selectAllWithRoles();&#10;    List&lt;User&gt; selectAll();&#10;    int insert(User user);&#10;    int update(User user);&#10;    int deleteById(@Param(&quot;id&quot;) Long id);&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/service/BargainService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/lut/cn/c2cplatform/service/BargainService.java" />
              <option name="updatedContent" value="package lut.cn.c2cplatform.service;&#10;&#10;import lut.cn.c2cplatform.entity.BargainActivity;&#10;import lut.cn.c2cplatform.entity.BargainHelp;&#10;import lut.cn.c2cplatform.entity.Product;&#10;import lut.cn.c2cplatform.mapper.BargainActivityMapper;&#10;import lut.cn.c2cplatform.mapper.BargainHelpMapper;&#10;import lut.cn.c2cplatform.mapper.ProductMapper;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.math.BigDecimal;&#10;import java.math.RoundingMode;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.Random;&#10;&#10;@Service&#10;public class BargainService {&#10;&#10;    @Autowired&#10;    private BargainActivityMapper bargainActivityMapper;&#10;&#10;    @Autowired&#10;    private BargainHelpMapper bargainHelpMapper;&#10;&#10;    @Autowired&#10;    private ProductMapper productMapper;&#10;&#10;    private static final Random random = new Random();&#10;&#10;    /**&#10;     * 发起砍价活动&#10;     */&#10;    @Transactional&#10;    public BargainActivity startBargain(Long userId, Long productId) {&#10;        // 检查商品是否存在&#10;        Product product = productMapper.selectById(productId);&#10;        if (product == null) {&#10;            throw new RuntimeException(&quot;商品不存在&quot;);&#10;        }&#10;&#10;        // 检查用户是否已经为该商品发起过砍价&#10;        BargainActivity existingBargain = bargainActivityMapper.selectActiveByUserAndProduct(userId, productId);&#10;        if (existingBargain != null) {&#10;            throw new RuntimeException(&quot;您已经为该商品发起过砍价，不能重复发起&quot;);&#10;        }&#10;&#10;        // 创建砍价活动&#10;        BargainActivity bargainActivity = new BargainActivity();&#10;        bargainActivity.setUserId(userId);&#10;        bargainActivity.setProductId(productId);&#10;        bargainActivity.setOriginalPrice(product.getPrice());&#10;        &#10;        // 目标价格为原价的60%-80%（随机）&#10;        BigDecimal targetRatio = BigDecimal.valueOf(0.6 + random.nextDouble() * 0.2);&#10;        BigDecimal targetPrice = product.getPrice().multiply(targetRatio).setScale(2, RoundingMode.HALF_UP);&#10;        bargainActivity.setTargetPrice(targetPrice);&#10;        &#10;        bargainActivity.setCurrentPrice(product.getPrice());&#10;        bargainActivity.setStatus(&quot;ACTIVE&quot;);&#10;        &#10;        // 过期时间为24小时后&#10;        Date expireTime = new Date(System.currentTimeMillis() + 24 * 60 * 60 * 1000);&#10;        bargainActivity.setExpireTime(expireTime);&#10;        &#10;        bargainActivity.setCreatedAt(new Date());&#10;        bargainActivity.setUpdatedAt(new Date());&#10;&#10;        bargainActivityMapper.insert(bargainActivity);&#10;        &#10;        return bargainActivityMapper.selectById(bargainActivity.getId());&#10;    }&#10;&#10;    /**&#10;     * 帮助砍价&#10;     */&#10;    @Transactional&#10;    public BargainHelp helpBargain(Long bargainId, Long helperId, String helperName) {&#10;        // 检查砍价活动是否存在&#10;        BargainActivity bargainActivity = bargainActivityMapper.selectById(bargainId);&#10;        if (bargainActivity == null) {&#10;            throw new RuntimeException(&quot;砍价活动不存在&quot;);&#10;        }&#10;&#10;        // 检查砍价活动是否已过期&#10;        if (bargainActivity.getExpireTime().before(new Date())) {&#10;            bargainActivityMapper.updateStatus(bargainId, &quot;EXPIRED&quot;);&#10;            throw new RuntimeException(&quot;砍价活动已过期&quot;);&#10;        }&#10;&#10;        // 检查砍价活动状态&#10;        if (!&quot;ACTIVE&quot;.equals(bargainActivity.getStatus())) {&#10;            throw new RuntimeException(&quot;砍价活动已结束&quot;);&#10;        }&#10;&#10;        // 检查是否已经帮助过（如果有helperId）&#10;        if (helperId != null) {&#10;            BargainHelp existingHelp = bargainHelpMapper.selectByBargainIdAndHelperId(bargainId, helperId);&#10;            if (existingHelp != null) {&#10;                throw new RuntimeException(&quot;您已经帮助过该砍价活动&quot;);&#10;            }&#10;        }&#10;&#10;        // 计算砍价金额&#10;        BigDecimal remainingAmount = bargainActivity.getCurrentPrice().subtract(bargainActivity.getTargetPrice());&#10;        BigDecimal cutAmount;&#10;        &#10;        if (remainingAmount.compareTo(BigDecimal.ZERO) &lt;= 0) {&#10;            throw new RuntimeException(&quot;砍价活动已完成&quot;);&#10;        }&#10;&#10;        // 随机砍价金额：剩余金额的5%-20%&#10;        double ratio = 0.05 + random.nextDouble() * 0.15;&#10;        cutAmount = remainingAmount.multiply(BigDecimal.valueOf(ratio)).setScale(2, RoundingMode.HALF_UP);&#10;        &#10;        // 确保至少砍0.01元&#10;        if (cutAmount.compareTo(new BigDecimal(&quot;0.01&quot;)) &lt; 0) {&#10;            cutAmount = new BigDecimal(&quot;0.01&quot;);&#10;        }&#10;        &#10;        // 确保不超过剩余金额&#10;        if (cutAmount.compareTo(remainingAmount) &gt; 0) {&#10;            cutAmount = remainingAmount;&#10;        }&#10;&#10;        // 创建助力记录&#10;        BargainHelp bargainHelp = new BargainHelp();&#10;        bargainHelp.setBargainId(bargainId);&#10;        bargainHelp.setHelperId(helperId);&#10;        bargainHelp.setHelperName(helperName);&#10;        bargainHelp.setCutAmount(cutAmount);&#10;        bargainHelp.setCreatedAt(new Date());&#10;&#10;        bargainHelpMapper.insert(bargainHelp);&#10;&#10;        // 更新当前价格&#10;        BigDecimal newPrice = bargainActivity.getCurrentPrice().subtract(cutAmount);&#10;        bargainActivity.setCurrentPrice(newPrice);&#10;        &#10;        // 检查是否达到目标价格&#10;        if (newPrice.compareTo(bargainActivity.getTargetPrice()) &lt;= 0) {&#10;            bargainActivity.setCurrentPrice(bargainActivity.getTargetPrice());&#10;            bargainActivity.setStatus(&quot;SUCCESS&quot;);&#10;        }&#10;        &#10;        bargainActivity.setUpdatedAt(new Date());&#10;        bargainActivityMapper.update(bargainActivity);&#10;&#10;        return bargainHelp;&#10;    }&#10;&#10;    /**&#10;     * 获取砍价活动详情&#10;     */&#10;    public BargainActivity getBargainActivity(Long bargainId) {&#10;        return bargainActivityMapper.selectById(bargainId);&#10;    }&#10;&#10;    /**&#10;     * 获取用户的砍价活动列表&#10;     */&#10;    public List&lt;BargainActivity&gt; getUserBargainActivities(Long userId) {&#10;        return bargainActivityMapper.selectByUserId(userId);&#10;    }&#10;&#10;    /**&#10;     * 获取砍价活动的助力记录&#10;     */&#10;    public List&lt;BargainHelp&gt; getBargainHelpList(Long bargainId) {&#10;        return bargainHelpMapper.selectByBargainId(bargainId);&#10;    }&#10;&#10;    /**&#10;     * 定时任务：关闭过期的砍价活动&#10;     */&#10;    @Transactional&#10;    public void closeExpiredBargains() {&#10;        List&lt;BargainActivity&gt; expiredActivities = bargainActivityMapper.selectExpiredActivities();&#10;        for (BargainActivity activity : expiredActivities) {&#10;            bargainActivityMapper.updateStatus(activity.getId(), &quot;EXPIRED&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/mapper/BargainActivityMapper.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/mapper/BargainActivityMapper.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&#10;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&#10;&lt;mapper namespace=&quot;lut.cn.c2cplatform.mapper.BargainActivityMapper&quot;&gt;&#10;    &#10;    &lt;resultMap id=&quot;BargainActivityResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.BargainActivity&quot;&gt;&#10;        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;&#10;        &lt;result property=&quot;userId&quot; column=&quot;user_id&quot;/&gt;&#10;        &lt;result property=&quot;productId&quot; column=&quot;product_id&quot;/&gt;&#10;        &lt;result property=&quot;originalPrice&quot; column=&quot;original_price&quot;/&gt;&#10;        &lt;result property=&quot;targetPrice&quot; column=&quot;target_price&quot;/&gt;&#10;        &lt;result property=&quot;currentPrice&quot; column=&quot;current_price&quot;/&gt;&#10;        &lt;result property=&quot;status&quot; column=&quot;status&quot;/&gt;&#10;        &lt;result property=&quot;expireTime&quot; column=&quot;expire_time&quot;/&gt;&#10;        &lt;result property=&quot;createdAt&quot; column=&quot;created_at&quot;/&gt;&#10;        &lt;result property=&quot;updatedAt&quot; column=&quot;updated_at&quot;/&gt;&#10;        &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;&#10;        &lt;result property=&quot;displayName&quot; column=&quot;display_name&quot;/&gt;&#10;        &lt;result property=&quot;productName&quot; column=&quot;product_name&quot;/&gt;&#10;        &lt;result property=&quot;productImage&quot; column=&quot;product_image&quot;/&gt;&#10;        &lt;result property=&quot;helpCount&quot; column=&quot;help_count&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;insert id=&quot;insert&quot; parameterType=&quot;lut.cn.c2cplatform.entity.BargainActivity&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;&#10;        INSERT INTO bargain_activity (user_id, product_id, original_price, target_price, current_price, status, expire_time, created_at, updated_at)&#10;        VALUES (#{userId}, #{productId}, #{originalPrice}, #{targetPrice}, #{currentPrice}, #{status}, #{expireTime}, #{createdAt}, #{updatedAt})&#10;    &lt;/insert&gt;&#10;&#10;    &lt;select id=&quot;selectById&quot; resultMap=&quot;BargainActivityResultMap&quot;&gt;&#10;        SELECT ba.*, &#10;               u.username, &#10;               u.display_name,&#10;               p.name as product_name,&#10;               (SELECT url FROM pms_product_media WHERE product_id = ba.product_id AND media_type = 1 LIMIT 1) as product_image,&#10;               (SELECT COUNT(*) FROM bargain_help WHERE bargain_id = ba.id) as help_count&#10;        FROM bargain_activity ba&#10;        LEFT JOIN users u ON ba.user_id = u.id&#10;        LEFT JOIN pms_product p ON ba.product_id = p.id&#10;        WHERE ba.id = #{id}&#10;    &lt;/select&gt;&#10;&#10;    &lt;select id=&quot;selectByUserId&quot; resultMap=&quot;BargainActivityResultMap&quot;&gt;&#10;        SELECT ba.*, &#10;               u.username, &#10;               u.display_name,&#10;               p.name as product_name,&#10;               (SELECT url FROM pms_product_media WHERE product_id = ba.product_id AND media_type = 1 LIMIT 1) as product_image,&#10;               (SELECT COUNT(*) FROM bargain_help WHERE bargain_id = ba.id) as help_count&#10;        FROM bargain_activity ba&#10;        LEFT JOIN users u ON ba.user_id = u.id&#10;        LEFT JOIN pms_product p ON ba.product_id = p.id&#10;        WHERE ba.user_id = #{userId}&#10;        ORDER BY ba.created_at DESC&#10;    &lt;/select&gt;&#10;&#10;    &lt;select id=&quot;selectByProductId&quot; resultMap=&quot;BargainActivityResultMap&quot;&gt;&#10;        SELECT ba.*, &#10;               u.username, &#10;               u.display_name,&#10;               p.name as product_name,&#10;               (SELECT url FROM pms_product_media WHERE product_id = ba.product_id AND media_type = 1 LIMIT 1) as product_image,&#10;               (SELECT COUNT(*) FROM bargain_help WHERE bargain_id = ba.id) as help_count&#10;        FROM bargain_activity ba&#10;        LEFT JOIN users u ON ba.user_id = u.id&#10;        LEFT JOIN pms_product p ON ba.product_id = p.id&#10;        WHERE ba.product_id = #{productId}&#10;        ORDER BY ba.created_at DESC&#10;    &lt;/select&gt;&#10;&#10;    &lt;update id=&quot;update&quot; parameterType=&quot;lut.cn.c2cplatform.entity.BargainActivity&quot;&gt;&#10;        UPDATE bargain_activity&#10;        SET current_price = #{currentPrice},&#10;            status = #{status},&#10;            updated_at = #{updatedAt}&#10;        WHERE id = #{id}&#10;    &lt;/update&gt;&#10;&#10;    &lt;update id=&quot;updateStatus&quot;&gt;&#10;        UPDATE bargain_activity&#10;        SET status = #{status},&#10;            updated_at = NOW()&#10;        WHERE id = #{id}&#10;    &lt;/update&gt;&#10;&#10;    &lt;select id=&quot;selectExpiredActivities&quot; resultMap=&quot;BargainActivityResultMap&quot;&gt;&#10;        SELECT * FROM bargain_activity&#10;        WHERE status = 'ACTIVE'&#10;        AND expire_time &amp;lt; NOW()&#10;    &lt;/select&gt;&#10;&#10;    &lt;select id=&quot;selectActiveByUserAndProduct&quot; resultMap=&quot;BargainActivityResultMap&quot;&gt;&#10;        SELECT ba.*, &#10;               u.username, &#10;               u.display_name,&#10;               p.name as product_name,&#10;               (SELECT url FROM pms_product_media WHERE product_id = ba.product_id AND media_type = 1 LIMIT 1) as product_image,&#10;               (SELECT COUNT(*) FROM bargain_help WHERE bargain_id = ba.id) as help_count&#10;        FROM bargain_activity ba&#10;        LEFT JOIN users u ON ba.user_id = u.id&#10;        LEFT JOIN pms_product p ON ba.product_id = p.id&#10;        WHERE ba.user_id = #{userId}&#10;        AND ba.product_id = #{productId}&#10;        AND ba.status = 'ACTIVE'&#10;        LIMIT 1&#10;    &lt;/select&gt;&#10;&#10;&lt;/mapper&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/mapper/BargainHelpMapper.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/mapper/BargainHelpMapper.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&#10;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&#10;&lt;mapper namespace=&quot;lut.cn.c2cplatform.mapper.BargainHelpMapper&quot;&gt;&#10;    &#10;    &lt;resultMap id=&quot;BargainHelpResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.BargainHelp&quot;&gt;&#10;        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;&#10;        &lt;result property=&quot;bargainId&quot; column=&quot;bargain_id&quot;/&gt;&#10;        &lt;result property=&quot;helperId&quot; column=&quot;helper_id&quot;/&gt;&#10;        &lt;result property=&quot;helperName&quot; column=&quot;helper_name&quot;/&gt;&#10;        &lt;result property=&quot;cutAmount&quot; column=&quot;cut_amount&quot;/&gt;&#10;        &lt;result property=&quot;createdAt&quot; column=&quot;created_at&quot;/&gt;&#10;        &lt;result property=&quot;helperAvatar&quot; column=&quot;helper_avatar&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;insert id=&quot;insert&quot; parameterType=&quot;lut.cn.c2cplatform.entity.BargainHelp&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;&#10;        INSERT INTO bargain_help (bargain_id, helper_id, helper_name, cut_amount, created_at)&#10;        VALUES (#{bargainId}, #{helperId}, #{helperName}, #{cutAmount}, #{createdAt})&#10;    &lt;/insert&gt;&#10;&#10;    &lt;select id=&quot;selectByBargainId&quot; resultMap=&quot;BargainHelpResultMap&quot;&gt;&#10;        SELECT bh.*,&#10;               u.avatar_url as helper_avatar&#10;        FROM bargain_help bh&#10;        LEFT JOIN users u ON bh.helper_id = u.id&#10;        WHERE bh.bargain_id = #{bargainId}&#10;        ORDER BY bh.created_at DESC&#10;    &lt;/select&gt;&#10;&#10;    &lt;select id=&quot;selectByBargainIdAndHelperId&quot; resultMap=&quot;BargainHelpResultMap&quot;&gt;&#10;        SELECT * FROM bargain_help&#10;        WHERE bargain_id = #{bargainId}&#10;        AND helper_id = #{helperId}&#10;        LIMIT 1&#10;    &lt;/select&gt;&#10;&#10;    &lt;select id=&quot;countByBargainId&quot; resultType=&quot;java.lang.Integer&quot;&gt;&#10;        SELECT COUNT(*) FROM bargain_help&#10;        WHERE bargain_id = #{bargainId}&#10;    &lt;/select&gt;&#10;&#10;&lt;/mapper&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/resources/mapper/UserMapper.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/resources/mapper/UserMapper.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&#10;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&#10;&lt;mapper namespace=&quot;lut.cn.c2cplatform.mapper.UserMapper&quot;&gt;&#10;    &lt;resultMap id=&quot;UserResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.User&quot;&gt;&#10;        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;&#10;        &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;&#10;        &lt;result property=&quot;password&quot; column=&quot;password&quot;/&gt;&#10;        &lt;result property=&quot;email&quot; column=&quot;email&quot;/&gt;&#10;        &lt;result property=&quot;createdAt&quot; column=&quot;created_at&quot;/&gt;&#10;        &lt;result property=&quot;updatedAt&quot; column=&quot;updated_at&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;!-- ResultMap with roles collection --&gt;&#10;    &lt;resultMap id=&quot;UserWithRolesResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.User&quot; extends=&quot;UserResultMap&quot;&gt;&#10;        &lt;collection property=&quot;roles&quot; ofType=&quot;lut.cn.c2cplatform.entity.Role&quot; column=&quot;id&quot; select=&quot;selectRolesByUserId&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;select id=&quot;selectById&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE id = #{id}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectByUsername&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE username = #{username}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectByUsernameWithRoles&quot; resultMap=&quot;UserWithRolesResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE username = #{username}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectAll&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users&#10;    &lt;/select&gt;&#10;    &lt;insert id=&quot;insert&quot; parameterType=&quot;lut.cn.c2cplatform.entity.User&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;&#10;        INSERT INTO users (username, password, email, created_at, updated_at)&#10;        VALUES (#{username}, #{password}, #{email}, #{createdAt}, #{updatedAt})&#10;    &lt;/insert&gt;&#10;    &lt;update id=&quot;update&quot; parameterType=&quot;lut.cn.c2cplatform.entity.User&quot;&gt;&#10;        UPDATE users SET username=#{username}, password=#{password}, email=#{email}, updated_at=#{updatedAt} WHERE id=#{id}&#10;    &lt;/update&gt;&#10;    &lt;delete id=&quot;deleteById&quot; parameterType=&quot;long&quot;&gt;&#10;        DELETE FROM users WHERE id=#{id}&#10;    &lt;/delete&gt;&#10;&#10;    &lt;!-- helper select to load roles for user --&gt;&#10;    &lt;select id=&quot;selectRolesByUserId&quot; resultType=&quot;lut.cn.c2cplatform.entity.Role&quot;&gt;&#10;        SELECT r.id, r.name&#10;        FROM roles r&#10;        INNER JOIN user_roles ur ON ur.role_id = r.id&#10;        WHERE ur.user_id = #{value}&#10;    &lt;/select&gt;&#10;&lt;/mapper&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&#10;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&#10;&lt;mapper namespace=&quot;lut.cn.c2cplatform.mapper.UserMapper&quot;&gt;&#10;    &lt;resultMap id=&quot;UserResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.User&quot;&gt;&#10;        &lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;&#10;        &lt;result property=&quot;username&quot; column=&quot;username&quot;/&gt;&#10;        &lt;result property=&quot;password&quot; column=&quot;password&quot;/&gt;&#10;        &lt;result property=&quot;email&quot; column=&quot;email&quot;/&gt;&#10;        &lt;result property=&quot;createdAt&quot; column=&quot;created_at&quot;/&gt;&#10;        &lt;result property=&quot;updatedAt&quot; column=&quot;updated_at&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;!-- ResultMap with roles collection --&gt;&#10;    &lt;resultMap id=&quot;UserWithRolesResultMap&quot; type=&quot;lut.cn.c2cplatform.entity.User&quot; extends=&quot;UserResultMap&quot;&gt;&#10;        &lt;collection property=&quot;roles&quot; ofType=&quot;lut.cn.c2cplatform.entity.Role&quot; column=&quot;id&quot; select=&quot;selectRolesByUserId&quot;/&gt;&#10;    &lt;/resultMap&gt;&#10;&#10;    &lt;select id=&quot;selectById&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE id = #{id}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectByUsername&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE username = #{username}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectByUsernameWithRoles&quot; resultMap=&quot;UserWithRolesResultMap&quot;&gt;&#10;        SELECT * FROM users WHERE username = #{username}&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectAll&quot; resultMap=&quot;UserResultMap&quot;&gt;&#10;        SELECT * FROM users&#10;    &lt;/select&gt;&#10;    &lt;select id=&quot;selectAllWithRoles&quot; resultMap=&quot;UserWithRolesResultMap&quot;&gt;&#10;        SELECT * FROM users&#10;    &lt;/select&gt;&#10;    &lt;insert id=&quot;insert&quot; parameterType=&quot;lut.cn.c2cplatform.entity.User&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;&#10;        INSERT INTO users (username, password, email, created_at, updated_at)&#10;        VALUES (#{username}, #{password}, #{email}, #{createdAt}, #{updatedAt})&#10;    &lt;/insert&gt;&#10;    &lt;update id=&quot;update&quot; parameterType=&quot;lut.cn.c2cplatform.entity.User&quot;&gt;&#10;        UPDATE users SET username=#{username}, password=#{password}, email=#{email}, updated_at=#{updatedAt} WHERE id=#{id}&#10;    &lt;/update&gt;&#10;    &lt;delete id=&quot;deleteById&quot; parameterType=&quot;long&quot;&gt;&#10;        DELETE FROM users WHERE id=#{id}&#10;    &lt;/delete&gt;&#10;&#10;    &lt;!-- helper select to load roles for user --&gt;&#10;    &lt;select id=&quot;selectRolesByUserId&quot; resultType=&quot;lut.cn.c2cplatform.entity.Role&quot;&gt;&#10;        SELECT r.id, r.name&#10;        FROM roles r&#10;        INNER JOIN user_roles ur ON ur.role_id = r.id&#10;        WHERE ur.user_id = #{value}&#10;    &lt;/select&gt;&#10;&lt;/mapper&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/test-data.sql">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/test-data.sql" />
              <option name="originalContent" value="&#10;-- The password hash is: $2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9&#10;INSERT INTO `users` (`id`, `username`, `display_name`, `password_hash`, `email`, `avatar_url`) VALUES&#10;                                                                                                   (2, 'bookworm_li', '爱书的李华', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'lihua@example.com', 'https://i.pravatar.cc/150?u=lihua'),&#10;                                                                                                   (3, 'tech_reader_zhang', '技术宅张伟', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhangwei@example.com', 'https://i.pravatar.cc/150?u=zhangwei'),&#10;                                                                                                   (4, 'history_fan_wang', '历史迷王芳', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'wangfang@example.com', 'https://i.pravatar.cc/150?u=wangfang'),&#10;                                                                                                   (5, 'sci_fi_chen', '科幻迷陈杰', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'chenjie@example.com', 'https://i.pravatar.cc/150?u=chenjie'),&#10;                                                                                                   (6, 'art_lover_liu', '文艺青年刘洋', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'liuyang@example.com', 'https://i.pravatar.cc/150?u=liuyang'),&#10;                                                                                                   (7, 'econ_master_zhao', '经管达人赵静', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhaojing@example.com', 'https://i.pravatar.cc/150?u=zhaojing'),&#10;                                                                                                   (8, 'code_ninja_sun', '编程忍者孙强', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'sunqiang@example.com', 'https://i.pravatar.cc/150?u=sunqiang'),&#10;                                                                                                   (9, 'lit_geek_zhou', '文学极客周敏', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhoumin@example.com', 'https://i.pravatar.cc/150?u=zhoumin'),&#10;                                                                                                   (10, 'design_guru_wu', '设计大师吴磊', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'wulei@example.com', 'https://i.pravatar.cc/150?u=wulei'),&#10;                                                                                                   (11, 'travel_bug_zheng', '旅行者郑丽', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhengli@example.com', 'https://i.pravatar.cc/150?u=zhengli');&#10;&#10;-- Assign ROLE_USER to all test users&#10;INSERT INTO `user_roles` (`user_id`, `role_id`) VALUES&#10;                                                    (2, 1), (3, 1), (4, 1), (5, 1), (6, 1), (7, 1), (8, 1), (9, 1), (10, 1), (11, 1);&#10;-- Note: Video URLs are placeholders for demonstration purposes.&#10;SET @last_product_id = 0;&#10;&#10;-- Product 1&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'深入理解计算机系统（原书第3版）','计算机系统经典教材，被誉为程序员的百科全书，讲解计算机底层工作原理。',85.00,32,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m7.ddimg.cn/25/22/25289437-1_l_1533628187.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 2&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'算法导论（原书第3版）','MIT经典教材，全面讲解算法设计与分析，适合计算机专业学生与工程师。',96.00,28,8,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/1/22/23235342-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 3&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'代码整洁之道','软件工程经典著作，讲解如何写出可维护、清晰的代码。几乎全新。',39.00,44,10,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/33/25/20785032-1_l_1.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 4&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'三体（全集）','刘慈欣科幻巨作，开创中国科幻新时代，全套三册。',55.00,35,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m9.ddimg.cn/31/3/23575429-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 5&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'Java核心技术 卷I（原书第12版）','Java领域权威参考书，涵盖核心语法与面向对象编程。',110.00,22,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/8/23/29363092-1_l_1647501378.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 6&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'Python编程：从入门到实践（第2版）','Python入门经典，包含丰富项目案例，适合初学者。',45.00,25,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m0.ddimg.cn/9/2/28512190-1_l_1572242509.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 7&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'设计模式：可复用面向对象软件的基础','面向对象设计的经典之作，讲解23种设计模式。',30.00,15,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m4.ddimg.cn/53/26/9215204-1_l.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 8&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'人类简史：从动物到上帝','尤瓦尔·赫拉利作品，讲述人类从智人到现代文明的发展历程。',42.00,17,9,'武汉',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m1.ddimg.cn/1/33/23434211-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 9&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'设计师要懂心理学','从心理学角度解读用户体验与设计原则，几乎全新。',25.00,19,10,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m3.ddimg.cn/33/3/23257033-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 10&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'Effective Java（中文版 第3版）','深入讲解90条高效Java编程经验，Java开发者必读。',50.00,27,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m7.ddimg.cn/29/3/27871537-1_l_1559717371.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book vide&#10;&#10;-- Product 11&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'经济学原理（第8版）','曼昆经典教材，系统讲解微观与宏观经济学基础。',79.00,34,9,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/89/9/29227218-1_l_1678775072.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 12&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'自控力','斯坦福大学经典心理学课程，讲述如何战胜拖延与冲动。',33.50,29,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/54/13/23203492-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 13&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'原则（Ray Dalio）','桥水基金创始人瑞·达利欧总结的成功法则，职场与人生指南。',72.00,25,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/28/3/25249090-1_l_1546315997.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 14&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'艺术的故事','恩斯特·贡布里希经典艺术史读物，图文并茂，通俗易懂。',88.00,16,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/4/13/25227371-1_l_1533629127.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 15&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (11,'未来简史','赫拉利畅销作品，探讨人类未来的技术与伦理。',49.00,40,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/91/16/23960849-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 16&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'小王子（纪念版）','经典法语童话，富含哲理与想象力，收藏级版本。',25.00,23,10,'西安',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/29/12/23568025-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 17&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'活着（余华）','当代文学经典，讲述平凡人生的坚韧与悲怆。',32.00,20,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/10/2/23856440-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 18&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'时间简史','霍金经典科普著作，探索宇宙的起源与命运。',48.00,26,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/8/10/23836707-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 19&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'程序员修炼之道','软件开发的哲学与实践指南。',59.00,33,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/65/33/23306850-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 20&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'深入理解Java虚拟机（第3版）','JVM底层机制详解，适合中高级Java工程师。',76.00,42,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/62/2/29358907-1_l_1647496503.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 21&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'乌合之众：大众心理研究','揭示群体行为与社会心理机制的经典之作。',29.00,24,8,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/65/9/23368358-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 22&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'计算机网络（第8版）','谢希仁编著，讲解网络体系结构与协议。',55.00,18,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/13/8/25335354-1_l_1533629051.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 23&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'机器学习（周志华）','系统介绍机器学习基本原理与算法。',82.00,30,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/59/2/24026558-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 24&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'计算机程序的构造和解释（SICP）','MIT计算机科学入门经典教材。',69.00,20,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/18/23496302-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 25&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'思考，快与慢','诺贝尔经济学奖得主丹尼尔·卡尼曼力作，探讨思维系统与决策偏差。',45.00,15,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/8/6/23287102-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1);&#10;-- Product 26&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'暗时间','刘慈欣科幻短篇集，探索科技与人性。',38.00,22,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/12/9/23376488-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 27&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'黑客与画家','Paul Graham作品，讲述技术、创业与思维方式。',41.00,19,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/11/8/23456533-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 28&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'浪潮之巅','吴军著作，讲述IT行业发展与科技趋势。',50.00,28,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/14/5/23294567-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 29&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'程序员的数学','软件工程与计算机数学基础入门教材，适合初中高级程序员。',36.00,31,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/9/12/23309865-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 30&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'Python深度学习','Francois Chollet作品，讲解Keras与深度学习实战。',92.00,27,10,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/5/8/23458322-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 31&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'人月神话','软件工程经典，讲述项目管理与团队协作的经验教训。',44.00,25,9,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/6/7/23458912-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 32&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'编程珠玑','Jon Bentley经典编程书籍，包含算法与性能优化技巧。',65.00,18,10,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/7/6/23298765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 33&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'深入浅出Node.js','Node.js编程实战书籍，适合后端开发者快速入门。',39.00,30,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/6/11/23498765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 34&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'深入浅出React','React框架权威指南，前端开发者必读。',48.00,26,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/9/10/23212345-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 35&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'深入浅出Vue.js','Vue.js前端实战教程，项目驱动教学。',52.00,28,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/5/9/23312345-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 36&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'计算机组成原理（王道版）','王道教材，详细讲解计算机硬件与汇编原理。',68.00,24,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/8/23367890-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 37&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'代码大全（第2版）','Steve McConnell著作，软件工程经典，讲解高质量代码实践。',55.00,33,10,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/8/7/23456789-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 38&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'黑客攻防技术宝典','网络安全经典教材，讲解攻击与防御方法。',62.00,19,9,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/9/6/23245678-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 39&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'深度学习（Ian Goodfellow）','深度学习领域权威教材，覆盖神经网络、卷积与生成模型。',98.00,21,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/3/23423456-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 40&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'深入理解Linux内核','Linux内核源码解析，操作系统与内核开发必读。',85.00,29,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/7/4/23398765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video-- TODO: replace with real book video" />
              <option name="updatedContent" value="&#10;-- The password hash is: $2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9&#10;INSERT INTO `users` (`id`, `username`, `display_name`, `password_hash`, `email`, `avatar_url`) VALUES&#10;                                                                                                   (2, 'bookworm_li', '爱书的李华', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'lihua@example.com', 'https://i.pravatar.cc/150?u=lihua'),&#10;                                                                                                   (3, 'tech_reader_zhang', '技术宅张伟', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhangwei@example.com', 'https://i.pravatar.cc/150?u=zhangwei'),&#10;                                                                                                   (4, 'history_fan_wang', '历史迷王芳', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'wangfang@example.com', 'https://i.pravatar.cc/150?u=wangfang'),&#10;                                                                                                   (5, 'sci_fi_chen', '科幻迷陈杰', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'chenjie@example.com', 'https://i.pravatar.cc/150?u=chenjie'),&#10;                                                                                                   (6, 'art_lover_liu', '文艺青年刘洋', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'liuyang@example.com', 'https://i.pravatar.cc/150?u=liuyang'),&#10;                                                                                                   (7, 'econ_master_zhao', '经管达人赵静', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhaojing@example.com', 'https://i.pravatar.cc/150?u=zhaojing'),&#10;                                                                                                   (8, 'code_ninja_sun', '编程忍者孙强', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'sunqiang@example.com', 'https://i.pravatar.cc/150?u=sunqiang'),&#10;                                                                                                   (9, 'lit_geek_zhou', '文学极客周敏', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhoumin@example.com', 'https://i.pravatar.cc/150?u=zhoumin'),&#10;                                                                                                   (10, 'design_guru_wu', '设计大师吴磊', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'wulei@example.com', 'https://i.pravatar.cc/150?u=wulei'),&#10;                                                                                                   (11, 'travel_bug_zheng', '旅行者郑丽', '$2a$10$e.FR524f25fG8sJ9.o.E8.U2a5.a5n..TjE2O/5g5p9', 'zhengli@example.com', 'https://i.pravatar.cc/150?u=zhengli');&#10;&#10;-- Assign ROLE_USER to all test users&#10;INSERT INTO `user_roles` (`user_id`, `role_id`) VALUES&#10;                                                    (2, 1), (3, 1), (4, 1), (5, 1), (6, 1), (7, 1), (8, 1), (9, 1), (10, 1), (11, 1);&#10;-- Note: Video URLs are placeholders for demonstration purposes.&#10;SET @last_product_id = 0;&#10;&#10;-- Product 1&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'深入理解计算机系统（原书第3版）','计算机系统经典教材，被誉为程序员的百科全书，讲解计算机底层工作原理。',85.00,32,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m7.ddimg.cn/25/22/25289437-1_l_1533628187.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 2&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'算法导论（原书第3版）','MIT经典教材，全面讲解算法设计与分析，适合计算机专业学生与工程师。',96.00,28,8,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/1/22/23235342-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 3&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'代码整洁之道','软件工程经典著作，讲解如何写出可维护、清晰的代码。几乎全新。',39.00,44,10,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/33/25/20785032-1_l_1.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 4&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'三体（全集）','刘慈欣科幻巨作，开创中国科幻新时代，全套三册。',55.00,35,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m9.ddimg.cn/31/3/23575429-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 5&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'Java核心技术 卷I（原书第12版）','Java领域权威参考书，涵盖核心语法与面向对象编程。',110.00,22,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m2.ddimg.cn/8/23/29363092-1_l_1647501378.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 6&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'Python编程：从入门到实践（第2版）','Python入门经典，包含丰富项目案例，适合初学者。',45.00,25,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m0.ddimg.cn/9/2/28512190-1_l_1572242509.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 7&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'设计模式：可复用面向对象软件的基础','面向对象设计的经典之作，讲解23种设计模式。',30.00,15,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m4.ddimg.cn/53/26/9215204-1_l.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 8&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'人类简史：从动物到上帝','尤瓦尔·赫拉利作品，讲述人类从智人到现代文明的发展历程。',42.00,17,9,'武汉',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m1.ddimg.cn/1/33/23434211-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 9&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'设计师要懂心理学','从心理学角度解读用户体验与设计原则，几乎全新。',25.00,19,10,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m3.ddimg.cn/33/3/23257033-1_l_2.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/WeAreGoingOnBullrun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 10&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'Effective Java（中文版 第3版）','深入讲解90条高效Java编程经验，Java开发者必读。',50.00,27,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                                                                  (@last_product_id,'https://img3m7.ddimg.cn/29/3/27871537-1_l_1559717371.jpg',1,0),&#10;                                                                                  (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book vide&#10;&#10;-- Product 11&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'经济学原理（第8版）','曼昆经典教材，系统讲解微观与宏观经济学基础。',79.00,34,9,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media`(`product_id`,`url`,`media_type`,`sort_order`) VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/89/9/29227218-1_l_1678775072.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 12&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'自控力','斯坦福大学经典心理学课程，讲述如何战胜拖延与冲动。',33.50,29,9,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/54/13/23203492-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 13&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'原则（Ray Dalio）','桥水基金创始人瑞·达利欧总结的成功法则，职场与人生指南。',72.00,25,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/28/3/25249090-1_l_1546315997.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 14&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'艺术的故事','恩斯特·贡布里希经典艺术史读物，图文并茂，通俗易懂。',88.00,16,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/4/13/25227371-1_l_1533629127.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 15&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (11,'未来简史','赫拉利畅销作品，探讨人类未来的技术与伦理。',49.00,40,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/91/16/23960849-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 16&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'小王子（纪念版）','经典法语童话，富含哲理与想象力，收藏级版本。',25.00,23,10,'西安',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/29/12/23568025-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 17&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'活着（余华）','当代文学经典，讲述平凡人生的坚韧与悲怆。',32.00,20,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/10/2/23856440-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 18&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'时间简史','霍金经典科普著作，探索宇宙的起源与命运。',48.00,26,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/8/10/23836707-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 19&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'程序员修炼之道','软件开发的哲学与实践指南。',59.00,33,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/65/33/23306850-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 20&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'深入理解Java虚拟机（第3版）','JVM底层机制详解，适合中高级Java工程师。',76.00,42,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/62/2/29358907-1_l_1647496503.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 21&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'乌合之众：大众心理研究','揭示群体行为与社会心理机制的经典之作。',29.00,24,8,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/65/9/23368358-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 22&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'计算机网络（第8版）','谢希仁编著，讲解网络体系结构与协议。',55.00,18,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/13/8/25335354-1_l_1533629051.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 23&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'机器学习（周志华）','系统介绍机器学习基本原理与算法。',82.00,30,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m8.ddimg.cn/59/2/24026558-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 24&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'计算机程序的构造和解释（SICP）','MIT计算机科学入门经典教材。',69.00,20,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/18/23496302-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 25&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (10,'思考，快与慢','诺贝尔经济学奖得主丹尼尔·卡尼曼力作，探讨思维系统与决策偏差。',45.00,15,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/8/6/23287102-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1);&#10;-- Product 26&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'暗时间','刘慈欣科幻短篇集，探索科技与人性。',38.00,22,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/12/9/23376488-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 27&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'黑客与画家','Paul Graham作品，讲述技术、创业与思维方式。',41.00,19,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/11/8/23456533-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 28&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'浪潮之巅','吴军著作，讲述IT行业发展与科技趋势。',50.00,28,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/14/5/23294567-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 29&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'程序员的数学','软件工程与计算机数学基础入门教材，适合初中高级程序员。',36.00,31,8,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m7.ddimg.cn/9/12/23309865-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 30&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'Python深度学习','Francois Chollet作品，讲解Keras与深度学习实战。',92.00,27,10,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/5/8/23458322-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 31&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'人月神话','软件工程经典，讲述项目管理与团队协作的经验教训。',44.00,25,9,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/6/7/23458912-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 32&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'编程珠玑','Jon Bentley经典编程书籍，包含算法与性能优化技巧。',65.00,18,10,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/7/6/23298765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 33&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (2,'深入浅出Node.js','Node.js编程实战书籍，适合后端开发者快速入门。',39.00,30,8,'南京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/6/11/23498765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 34&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (3,'深入浅出React','React框架权威指南，前端开发者必读。',48.00,26,9,'上海',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m4.ddimg.cn/9/10/23212345-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 35&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (4,'深入浅出Vue.js','Vue.js前端实战教程，项目驱动教学。',52.00,28,9,'杭州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m0.ddimg.cn/5/9/23312345-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 36&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (5,'计算机组成原理（王道版）','王道教材，详细讲解计算机硬件与汇编原理。',68.00,24,9,'成都',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/8/23367890-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 37&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (6,'代码大全（第2版）','Steve McConnell著作，软件工程经典，讲解高质量代码实践。',55.00,33,10,'北京',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m1.ddimg.cn/8/7/23456789-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 38&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (7,'黑客攻防技术宝典','网络安全经典教材，讲解攻击与防御方法。',62.00,19,9,'苏州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m9.ddimg.cn/9/6/23245678-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 39&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (8,'深度学习（Ian Goodfellow）','深度学习领域权威教材，覆盖神经网络、卷积与生成模型。',98.00,21,10,'深圳',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m2.ddimg.cn/7/3/23423456-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4',2,1); -- TODO: replace with real book video&#10;&#10;&#10;-- Product 40&#10;INSERT INTO `pms_product`&#10;(`user_id`,`name`,`description`,`price`,`stock`,`condition_level`,`location`,`status`)&#10;VALUES&#10;    (9,'深入理解Linux内核','Linux内核源码解析，操作系统与内核开发必读。',85.00,29,9,'广州',1);&#10;SET @last_product_id=LAST_INSERT_ID();&#10;INSERT INTO `pms_product_media` VALUES&#10;                                    (@last_product_id,'https://img3m5.ddimg.cn/7/4/23398765-1_l_2.jpg',1,0),&#10;                                    (@last_product_id,'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',2,1); -- TODO: replace with real book video-- TODO: replace with real book video" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/toolchains-sample.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/toolchains-sample.xml" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;!-- Copy this file to ~/.m2/toolchains.xml and edit the &lt;jdkHome&gt; path so Maven can use JDK 17 for builds --&gt;&#10;&lt;toolchains&gt;&#10;  &lt;toolchain&gt;&#10;    &lt;type&gt;jdk&lt;/type&gt;&#10;    &lt;provides&gt;&#10;      &lt;version&gt;17&lt;/version&gt;&#10;      &lt;!-- Vendor optional: omit or set to your JDK vendor (temurin, corretto, oracle, etc.) --&gt;&#10;    &lt;/provides&gt;&#10;    &lt;configuration&gt;&#10;      &lt;!-- Update jdkHome to your local JDK 17 installation path --&gt;&#10;      &lt;jdkHome&gt;/Library/Java/JavaVirtualMachines/temurin-17.jdk/Contents/Home&lt;/jdkHome&gt;&#10;    &lt;/configuration&gt;&#10;  &lt;/toolchain&gt;&#10;&lt;/toolchains&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>